/*!
 * ads-manager v1.2.10 development
 * Updated : 2023-03-20
 */
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
var adserve;
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/@dailymotion/vast-client/dist/vast-client.min.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@dailymotion/vast-client/dist/vast-client.min.js ***!
  \***********************************************************************/
/***/ (function(__unused_webpack_module, exports) {

eval("!function(e,t){ true?t(exports):0}(this,(function(e){\"use strict\";function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function r(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?t(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e){return i=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},i(e)}function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function a(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,\"prototype\",{writable:!1}),e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&c(e,t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function d(e,t){if(t&&(\"object\"==typeof t||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(e)}function p(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=u(e);if(t){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return d(this,r)}}function h(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||function(e,t){if(!e)return;if(\"string\"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adId:e.adId||null,sequence:e.sequence||null,apiFramework:e.apiFramework||null,universalAdIds:[],creativeExtensions:[]}}var m=[\"ADCATEGORIES\",\"ADCOUNT\",\"ADPLAYHEAD\",\"ADSERVINGID\",\"ADTYPE\",\"APIFRAMEWORKS\",\"APPBUNDLE\",\"ASSETURI\",\"BLOCKEDADCATEGORIES\",\"BREAKMAXADLENGTH\",\"BREAKMAXADS\",\"BREAKMAXDURATION\",\"BREAKMINADLENGTH\",\"BREAKMINDURATION\",\"BREAKPOSITION\",\"CLICKPOS\",\"CLICKTYPE\",\"CLIENTUA\",\"CONTENTID\",\"CONTENTPLAYHEAD\",\"CONTENTURI\",\"DEVICEIP\",\"DEVICEUA\",\"DOMAIN\",\"EXTENSIONS\",\"GDPRCONSENT\",\"IFA\",\"IFATYPE\",\"INVENTORYSTATE\",\"LATLONG\",\"LIMITADTRACKING\",\"MEDIAMIME\",\"MEDIAPLAYHEAD\",\"OMIDPARTNER\",\"PAGEURL\",\"PLACEMENTTYPE\",\"PLAYERCAPABILITIES\",\"PLAYERSIZE\",\"PLAYERSTATE\",\"PODSEQUENCE\",\"REGULATIONS\",\"SERVERSIDE\",\"SERVERUA\",\"TRANSACTIONID\",\"UNIVERSALADID\",\"VASTVERSIONS\",\"VERIFICATIONVENDORS\"];function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[],n=A(e);for(var a in!t.ERRORCODE||r.isCustomCode||/^[0-9]{3}$/.test(t.ERRORCODE)||(t.ERRORCODE=900),t.CACHEBUSTING=E(Math.round(1e8*Math.random())),t.TIMESTAMP=(new Date).toISOString(),t.RANDOM=t.random=t.CACHEBUSTING,t)t[a]=b(t[a]);for(var o in n){var s=n[o];\"string\"==typeof s&&i.push(y(s,t))}return i}function y(e,t){var r=(e=T(e,t)).match(/[^[\\]]+(?=])/g);if(!r)return e;var i=r.filter((function(e){return m.indexOf(e)>-1}));return 0===i.length?e:T(e,i=i.reduce((function(e,t){return e[t]=-1,e}),{}))}function T(e,t){var r=e;for(var i in t){var n=t[i];r=r.replace(new RegExp(\"(?:\\\\[|%%)(\".concat(i,\")(?:\\\\]|%%)\"),\"g\"),n)}return r}function A(e){return Array.isArray(e)?e.map((function(e){return e&&e.hasOwnProperty(\"url\")?e.url:e})):e}function k(e,t){for(var r=0;r<t.length;r++)if(R(t[r],e))return!0;return!1}function R(e,t){if(e&&t){var r=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);return r.length===i.length&&(e.id===t.id&&e.url===t.url)}return!1}function b(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16))}))}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return e.toString().padStart(t,\"0\")}var N={track:function(e,t,r){g(e,t,r).forEach((function(e){\"undefined\"!=typeof window&&null!==window&&((new Image).src=e)}))},resolveURLTemplates:g,extractURLsFromTemplates:A,containsTemplateObject:k,isTemplateObjectEqual:R,encodeURIComponentRFC3986:b,replaceUrlMacros:y,isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},flatten:function e(t){return t.reduce((function(t,r){return t.concat(Array.isArray(r)?e(r):r)}),[])},joinArrayOfUniqueTemplateObjs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Array.isArray(e)?e:[],i=Array.isArray(t)?t:[],n=r.concat(i);return n.reduce((function(e,t){return k(t,e)||e.push(t),e}),[])},isValidTimeValue:function(e){return Number.isFinite(e)&&e>=-2},addLeadingZeros:E};function L(e){return-1!==[\"true\",\"TRUE\",\"True\",\"1\"].indexOf(e)}var w={childByName:function(e,t){var r=e.childNodes;for(var i in r){var n=r[i];if(n.nodeName===t)return n}},childrenByName:function(e,t){var r=[],i=e.childNodes;for(var n in i){var a=i[n];a.nodeName===t&&r.push(a)}return r},resolveVastAdTagURI:function(e,t){if(!t)return e;if(0===e.indexOf(\"//\")){var r=location.protocol;return\"\".concat(r).concat(e)}if(-1===e.indexOf(\"://\")){var i=t.slice(0,t.lastIndexOf(\"/\"));return\"\".concat(i,\"/\").concat(e)}return e},parseBoolean:L,parseNodeText:function(e){return e&&(e.textContent||e.text||\"\").trim()},copyNodeAttribute:function(e,t,r){var i=t.getAttribute(e);i&&r.setAttribute(e,i)},parseAttributes:function(e){for(var t=e.attributes,r={},i=0;i<t.length;i++)r[t[i].nodeName]=t[i].nodeValue;return r},parseDuration:function(e){if(null==e)return-1;if(N.isNumeric(e))return parseInt(e);var t=e.split(\":\");if(3!==t.length)return-1;var r=t[2].split(\".\"),i=parseInt(r[0]);2===r.length&&(i+=parseFloat(\"0.\".concat(r[1])));var n=parseInt(60*t[1]),a=parseInt(60*t[0]*60);return isNaN(a)||isNaN(n)||isNaN(i)||n>3600||i>60?-1:a+n+i},splitVAST:function(e){var t=[],r=null;return e.forEach((function(i,n){if(i.sequence&&(i.sequence=parseInt(i.sequence,10)),i.sequence>1){var a=e[n-1];if(a&&a.sequence===i.sequence-1)return void(r&&r.push(i));delete i.sequence}r=[i],t.push(r)})),t},assignAttributes:function(e,t){if(e)for(var r in e){var i=e[r];if(i.nodeName&&i.nodeValue&&t.hasOwnProperty(i.nodeName)){var n=i.nodeValue;\"boolean\"==typeof t[i.nodeName]&&(n=L(n)),t[i.nodeName]=n}}},mergeWrapperAdData:function(e,t){e.errorURLTemplates=t.errorURLTemplates.concat(e.errorURLTemplates),e.impressionURLTemplates=t.impressionURLTemplates.concat(e.impressionURLTemplates),e.extensions=t.extensions.concat(e.extensions),t.viewableImpression.length>0&&(e.viewableImpression=[].concat(h(e.viewableImpression),h(t.viewableImpression))),e.followAdditionalWrappers=t.followAdditionalWrappers,e.allowMultipleAds=t.allowMultipleAds,e.fallbackOnNoAd=t.fallbackOnNoAd;var r=(t.creatives||[]).filter((function(e){return e&&\"companion\"===e.type})),i=r.reduce((function(e,t){return(t.variations||[]).forEach((function(t){(t.companionClickTrackingURLTemplates||[]).forEach((function(t){N.containsTemplateObject(t,e)||e.push(t)}))})),e}),[]);e.creatives=r.concat(e.creatives);var n=t.videoClickTrackingURLTemplates&&t.videoClickTrackingURLTemplates.length,a=t.videoCustomClickURLTemplates&&t.videoCustomClickURLTemplates.length;e.creatives.forEach((function(e){if(t.trackingEvents&&t.trackingEvents[e.type])for(var r in t.trackingEvents[e.type]){var o=t.trackingEvents[e.type][r];Array.isArray(e.trackingEvents[r])||(e.trackingEvents[r]=[]),e.trackingEvents[r]=e.trackingEvents[r].concat(o)}\"linear\"===e.type&&(n&&(e.videoClickTrackingURLTemplates=e.videoClickTrackingURLTemplates.concat(t.videoClickTrackingURLTemplates)),a&&(e.videoCustomClickURLTemplates=e.videoCustomClickURLTemplates.concat(t.videoCustomClickURLTemplates)),!t.videoClickThroughURLTemplate||null!==e.videoClickThroughURLTemplate&&void 0!==e.videoClickThroughURLTemplate||(e.videoClickThroughURLTemplate=t.videoClickThroughURLTemplate)),\"companion\"===e.type&&i.length&&(e.variations||[]).forEach((function(e){e.companionClickTrackingURLTemplates=N.joinArrayOfUniqueTemplateObjs(e.companionClickTrackingURLTemplates,i)}))})),t.adVerifications&&(e.adVerifications=e.adVerifications.concat(t.adVerifications)),t.blockedAdCategories&&(e.blockedAdCategories=e.blockedAdCategories.concat(t.blockedAdCategories))}};function U(e,t){var r=function(){var e=f(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),t=e.id,r=e.adId,i=e.sequence,n=e.apiFramework;return{id:t,adId:r,sequence:i,apiFramework:n,type:\"companion\",required:null,variations:[]}}(t);return r.required=e.getAttribute(\"required\")||null,r.variations=w.childrenByName(e,\"Companion\").map((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adType:\"companionAd\",width:e.width||0,height:e.height||0,assetWidth:e.assetWidth||null,assetHeight:e.assetHeight||null,expandedWidth:e.expandedWidth||null,expandedHeight:e.expandedHeight||null,apiFramework:e.apiFramework||null,adSlotID:e.adSlotID||null,pxratio:e.pxratio||\"1\",renderingMode:e.renderingMode||\"default\",staticResources:[],htmlResources:[],iframeResources:[],adParameters:null,xmlEncoded:null,altText:null,companionClickThroughURLTemplate:null,companionClickTrackingURLTemplates:[],trackingEvents:{}}}(w.parseAttributes(e));t.htmlResources=w.childrenByName(e,\"HTMLResource\").reduce((function(e,t){var r=w.parseNodeText(t);return r?e.concat(r):e}),[]),t.iframeResources=w.childrenByName(e,\"IFrameResource\").reduce((function(e,t){var r=w.parseNodeText(t);return r?e.concat(r):e}),[]),t.staticResources=w.childrenByName(e,\"StaticResource\").reduce((function(e,t){var r=w.parseNodeText(t);return r?e.concat({url:r,creativeType:t.getAttribute(\"creativeType\")||null}):e}),[]),t.altText=w.parseNodeText(w.childByName(e,\"AltText\"))||null;var r=w.childByName(e,\"TrackingEvents\");r&&w.childrenByName(r,\"Tracking\").forEach((function(e){var r=e.getAttribute(\"event\"),i=w.parseNodeText(e);r&&i&&(Array.isArray(t.trackingEvents[r])||(t.trackingEvents[r]=[]),t.trackingEvents[r].push(i))})),t.companionClickTrackingURLTemplates=w.childrenByName(e,\"CompanionClickTracking\").map((function(e){return{id:e.getAttribute(\"id\")||null,url:w.parseNodeText(e)}})),t.companionClickThroughURLTemplate=w.parseNodeText(w.childByName(e,\"CompanionClickThrough\"))||null;var i=w.childByName(e,\"AdParameters\");return i&&(t.adParameters=w.parseNodeText(i),t.xmlEncoded=i.getAttribute(\"xmlEncoded\")||null),t})),r}function C(e){return\"linear\"===e.type}function I(e,t){var r,i=function(){var e=f(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),t=e.id,r=e.adId,i=e.sequence,n=e.apiFramework;return{id:t,adId:r,sequence:i,apiFramework:n,type:\"linear\",duration:0,skipDelay:null,mediaFiles:[],mezzanine:null,interactiveCreativeFile:null,closedCaptionFiles:[],videoClickThroughURLTemplate:null,videoClickTrackingURLTemplates:[],videoCustomClickURLTemplates:[],adParameters:null,icons:[],trackingEvents:{}}}(t);i.duration=w.parseDuration(w.parseNodeText(w.childByName(e,\"Duration\")));var n=e.getAttribute(\"skipoffset\");if(null==n)i.skipDelay=null;else if(\"%\"===n.charAt(n.length-1)&&-1!==i.duration){var a=parseInt(n,10);i.skipDelay=i.duration*(a/100)}else i.skipDelay=w.parseDuration(n);var o=w.childByName(e,\"VideoClicks\");if(o){var s=w.childByName(o,\"ClickThrough\");i.videoClickThroughURLTemplate=s?{id:s.getAttribute(\"id\")||null,url:w.parseNodeText(s)}:null,w.childrenByName(o,\"ClickTracking\").forEach((function(e){i.videoClickTrackingURLTemplates.push({id:e.getAttribute(\"id\")||null,url:w.parseNodeText(e)})})),w.childrenByName(o,\"CustomClick\").forEach((function(e){i.videoCustomClickURLTemplates.push({id:e.getAttribute(\"id\")||null,url:w.parseNodeText(e)})}))}var l=w.childByName(e,\"AdParameters\");l&&(i.adParameters=w.parseNodeText(l)),w.childrenByName(e,\"TrackingEvents\").forEach((function(e){w.childrenByName(e,\"Tracking\").forEach((function(e){var t=e.getAttribute(\"event\"),n=w.parseNodeText(e);if(t&&n){if(\"progress\"===t){if(!(r=e.getAttribute(\"offset\")))return;t=\"%\"===r.charAt(r.length-1)?\"progress-\".concat(r):\"progress-\".concat(Math.round(w.parseDuration(r)))}Array.isArray(i.trackingEvents[t])||(i.trackingEvents[t]=[]),i.trackingEvents[t].push(n)}}))})),w.childrenByName(e,\"MediaFiles\").forEach((function(e){w.childrenByName(e,\"MediaFile\").forEach((function(e){i.mediaFiles.push(function(e){var t={id:null,fileURL:null,fileSize:0,deliveryType:\"progressive\",mimeType:null,mediaType:null,codec:null,bitrate:0,minBitrate:0,maxBitrate:0,width:0,height:0,apiFramework:null,scalable:null,maintainAspectRatio:null};t.id=e.getAttribute(\"id\"),t.fileURL=w.parseNodeText(e),t.deliveryType=e.getAttribute(\"delivery\"),t.codec=e.getAttribute(\"codec\"),t.mimeType=e.getAttribute(\"type\"),t.mediaType=e.getAttribute(\"mediaType\")||\"2D\",t.apiFramework=e.getAttribute(\"apiFramework\"),t.fileSize=parseInt(e.getAttribute(\"fileSize\")||0),t.bitrate=parseInt(e.getAttribute(\"bitrate\")||0),t.minBitrate=parseInt(e.getAttribute(\"minBitrate\")||0),t.maxBitrate=parseInt(e.getAttribute(\"maxBitrate\")||0),t.width=parseInt(e.getAttribute(\"width\")||0),t.height=parseInt(e.getAttribute(\"height\")||0);var r=e.getAttribute(\"scalable\");r&&\"string\"==typeof r&&(t.scalable=w.parseBoolean(r));var i=e.getAttribute(\"maintainAspectRatio\");i&&\"string\"==typeof i&&(t.maintainAspectRatio=w.parseBoolean(i));return t}(e))}));var t=w.childByName(e,\"InteractiveCreativeFile\");t&&(i.interactiveCreativeFile=function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,apiFramework:e.apiFramework||null,variableDuration:w.parseBoolean(e.variableDuration),fileURL:null}}(w.parseAttributes(e));return t.fileURL=w.parseNodeText(e),t}(t));var r=w.childByName(e,\"ClosedCaptionFiles\");r&&w.childrenByName(r,\"ClosedCaptionFile\").forEach((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,language:e.language||null,fileURL:null}}(w.parseAttributes(e));t.fileURL=w.parseNodeText(e),i.closedCaptionFiles.push(t)}));var n,a,o,s=w.childByName(e,\"Mezzanine\"),l=(n=s,a={},o=!1,[\"delivery\",\"type\",\"width\",\"height\"].forEach((function(e){n&&n.getAttribute(e)?a[e]=n.getAttribute(e):o=!0})),o?null:a);if(l){var u={id:null,fileURL:null,delivery:null,codec:null,type:null,width:0,height:0,fileSize:0,mediaType:\"2D\"};u.id=s.getAttribute(\"id\"),u.fileURL=w.parseNodeText(s),u.delivery=l.delivery,u.codec=s.getAttribute(\"codec\"),u.type=l.type,u.width=parseInt(l.width,10),u.height=parseInt(l.height,10),u.fileSize=parseInt(s.getAttribute(\"fileSize\"),10),u.mediaType=s.getAttribute(\"mediaType\")||\"2D\",i.mezzanine=u}}));var u=w.childByName(e,\"Icons\");return u&&w.childrenByName(u,\"Icon\").forEach((function(e){i.icons.push(function(e){var t={program:null,height:0,width:0,xPosition:0,yPosition:0,apiFramework:null,offset:null,duration:0,type:null,staticResource:null,htmlResource:null,iframeResource:null,pxratio:\"1\",iconClickThroughURLTemplate:null,iconClickTrackingURLTemplates:[],iconViewTrackingURLTemplate:null};t.program=e.getAttribute(\"program\"),t.height=parseInt(e.getAttribute(\"height\")||0),t.width=parseInt(e.getAttribute(\"width\")||0),t.xPosition=function(e){if(-1!==[\"left\",\"right\"].indexOf(e))return e;return parseInt(e||0)}(e.getAttribute(\"xPosition\")),t.yPosition=function(e){if(-1!==[\"top\",\"bottom\"].indexOf(e))return e;return parseInt(e||0)}(e.getAttribute(\"yPosition\")),t.apiFramework=e.getAttribute(\"apiFramework\"),t.pxratio=e.getAttribute(\"pxratio\")||\"1\",t.offset=w.parseDuration(e.getAttribute(\"offset\")),t.duration=w.parseDuration(e.getAttribute(\"duration\")),w.childrenByName(e,\"HTMLResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||\"text/html\",t.htmlResource=w.parseNodeText(e)})),w.childrenByName(e,\"IFrameResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||0,t.iframeResource=w.parseNodeText(e)})),w.childrenByName(e,\"StaticResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||0,t.staticResource=w.parseNodeText(e)}));var r=w.childByName(e,\"IconClicks\");r&&(t.iconClickThroughURLTemplate=w.parseNodeText(w.childByName(r,\"IconClickThrough\")),w.childrenByName(r,\"IconClickTracking\").forEach((function(e){t.iconClickTrackingURLTemplates.push({id:e.getAttribute(\"id\")||null,url:w.parseNodeText(e)})})));return t.iconViewTrackingURLTemplate=w.parseNodeText(w.childByName(e,\"IconViewTracking\")),t}(e))})),i}function x(e,t){var r=function(){var e=f(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),t=e.id,r=e.adId,i=e.sequence,n=e.apiFramework;return{id:t,adId:r,sequence:i,apiFramework:n,type:\"nonlinear\",variations:[],trackingEvents:{}}}(t);return w.childrenByName(e,\"TrackingEvents\").forEach((function(e){var t,i;w.childrenByName(e,\"Tracking\").forEach((function(e){t=e.getAttribute(\"event\"),i=w.parseNodeText(e),t&&i&&(Array.isArray(r.trackingEvents[t])||(r.trackingEvents[t]=[]),r.trackingEvents[t].push(i))}))})),w.childrenByName(e,\"NonLinear\").forEach((function(e){var t={id:null,width:0,height:0,expandedWidth:0,expandedHeight:0,scalable:!0,maintainAspectRatio:!0,minSuggestedDuration:0,apiFramework:\"static\",adType:\"nonLinearAd\",type:null,staticResource:null,htmlResource:null,iframeResource:null,nonlinearClickThroughURLTemplate:null,nonlinearClickTrackingURLTemplates:[],adParameters:null};t.id=e.getAttribute(\"id\")||null,t.width=e.getAttribute(\"width\"),t.height=e.getAttribute(\"height\"),t.expandedWidth=e.getAttribute(\"expandedWidth\"),t.expandedHeight=e.getAttribute(\"expandedHeight\"),t.scalable=w.parseBoolean(e.getAttribute(\"scalable\")),t.maintainAspectRatio=w.parseBoolean(e.getAttribute(\"maintainAspectRatio\")),t.minSuggestedDuration=w.parseDuration(e.getAttribute(\"minSuggestedDuration\")),t.apiFramework=e.getAttribute(\"apiFramework\"),w.childrenByName(e,\"HTMLResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||\"text/html\",t.htmlResource=w.parseNodeText(e)})),w.childrenByName(e,\"IFrameResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||0,t.iframeResource=w.parseNodeText(e)})),w.childrenByName(e,\"StaticResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||0,t.staticResource=w.parseNodeText(e)}));var i=w.childByName(e,\"AdParameters\");i&&(t.adParameters=w.parseNodeText(i)),t.nonlinearClickThroughURLTemplate=w.parseNodeText(w.childByName(e,\"NonLinearClickThrough\")),w.childrenByName(e,\"NonLinearClickTracking\").forEach((function(e){t.nonlinearClickTrackingURLTemplates.push({id:e.getAttribute(\"id\")||null,url:w.parseNodeText(e)})})),r.variations.push(t)})),r}function S(e){var t=[];return e.forEach((function(e){var r=O(e);r&&t.push(r)})),t}function O(e){if(\"#comment\"===e.nodeName)return null;var t,r={name:null,value:null,attributes:{},children:[]},i=e.attributes,n=e.childNodes;if(r.name=e.nodeName,e.attributes)for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];o.nodeName&&o.nodeValue&&(r.attributes[o.nodeName]=o.nodeValue)}for(var s in n)if(n.hasOwnProperty(s)){var l=O(n[s]);l&&r.children.push(l)}if(0===r.children.length||1===r.children.length&&[\"#cdata-section\",\"#text\"].indexOf(r.children[0].name)>=0){var u=w.parseNodeText(e);\"\"!==u&&(r.value=u),r.children=[]}return null===(t=r).value&&0===Object.keys(t.attributes).length&&0===t.children.length?null:r}function D(e){var t=[];return e.forEach((function(e){var r,i={id:e.getAttribute(\"id\")||null,adId:V(e),sequence:e.getAttribute(\"sequence\")||null,apiFramework:e.getAttribute(\"apiFramework\")||null},n=[];w.childrenByName(e,\"UniversalAdId\").forEach((function(e){var t={idRegistry:e.getAttribute(\"idRegistry\")||\"unknown\",value:w.parseNodeText(e)};n.push(t)}));var a=w.childByName(e,\"CreativeExtensions\");for(var o in a&&(r=S(w.childrenByName(a,\"CreativeExtension\"))),e.childNodes){var s=e.childNodes[o],l=void 0;switch(s.nodeName){case\"Linear\":l=I(s,i);break;case\"NonLinearAds\":l=x(s,i);break;case\"CompanionAds\":l=U(s,i)}l&&(n&&(l.universalAdIds=n),r&&(l.creativeExtensions=r),t.push(l))}})),t}function V(e){return e.getAttribute(\"AdID\")||e.getAttribute(\"adID\")||e.getAttribute(\"adId\")||null}var P={Wrapper:{subElements:[\"VASTAdTagURI\",\"Impression\"]},BlockedAdCategories:{attributes:[\"authority\"]},InLine:{subElements:[\"AdSystem\",\"AdTitle\",\"Impression\",\"AdServingId\",\"Creatives\"]},Category:{attributes:[\"authority\"]},Pricing:{attributes:[\"model\",\"currency\"]},Verification:{oneOfinLineResources:[\"JavaScriptResource\",\"ExecutableResource\"],attributes:[\"vendor\"]},UniversalAdId:{attributes:[\"idRegistry\"]},JavaScriptResource:{attributes:[\"apiFramework\",\"browserOptional\"]},ExecutableResource:{attributes:[\"apiFramework\",\"type\"]},Tracking:{attributes:[\"event\"]},Creatives:{subElements:[\"Creative\"]},Creative:{subElements:[\"UniversalAdId\"]},Linear:{subElements:[\"MediaFiles\",\"Duration\"]},MediaFiles:{subElements:[\"MediaFile\"]},MediaFile:{attributes:[\"delivery\",\"type\",\"width\",\"height\"]},Mezzanine:{attributes:[\"delivery\",\"type\",\"width\",\"height\"]},NonLinear:{oneOfinLineResources:[\"StaticResource\",\"IFrameResource\",\"HTMLResource\"],attributes:[\"width\",\"height\"]},Companion:{oneOfinLineResources:[\"StaticResource\",\"IFrameResource\",\"HTMLResource\"],attributes:[\"width\",\"height\"]},StaticResource:{attributes:[\"creativeType\"]},Icons:{subElements:[\"Icon\"]},Icon:{oneOfinLineResources:[\"StaticResource\",\"IFrameResource\",\"HTMLResource\"]}};function B(e,t){if(P[e.nodeName]&&P[e.nodeName].attributes){var r=P[e.nodeName].attributes.filter((function(t){return!e.getAttribute(t)}));r.length>0&&j({name:e.nodeName,parentName:e.parentNode.nodeName,attributes:r},t)}}function F(e,t,r){var i=P[e.nodeName],n=!r&&\"Wrapper\"!==e.nodeName;if(i&&!n){if(i.subElements){var a=i.subElements.filter((function(t){return!w.childByName(e,t)}));a.length>0&&j({name:e.nodeName,parentName:e.parentNode.nodeName,subElements:a},t)}if(r&&i.oneOfinLineResources)i.oneOfinLineResources.some((function(t){return w.childByName(e,t)}))||j({name:e.nodeName,parentName:e.parentNode.nodeName,oneOfResources:i.oneOfinLineResources},t)}}function M(e){return e.children&&0!==e.children.length}function j(e,t){var r=e.name,i=e.parentName,n=e.attributes,a=e.subElements,o=e.oneOfResources,s=\"Element '\".concat(r,\"'\");t(\"VAST-warning\",{message:s+=n?\" missing required attribute(s) '\".concat(n.join(\", \"),\"' \"):a?\" missing required sub element(s) '\".concat(a.join(\", \"),\"' \"):o?\" must provide one of the following '\".concat(o.join(\", \"),\"' \"):\" is empty\",parentElement:i,specVersion:4.1})}var W={verifyRequiredValues:function e(t,r,i){if(t&&t.nodeName)if(\"InLine\"===t.nodeName&&(i=!0),B(t,r),M(t)){F(t,r,i);for(var n=0;n<t.children.length;n++)e(t.children[n],r,i)}else 0===w.parseNodeText(t).length&&j({name:t.nodeName,parentName:t.parentNode.nodeName},r)},hasSubElements:M,emitMissingValueWarning:j,verifyRequiredAttributes:B,verifyRequiredSubElements:F};function q(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.allowMultipleAds,n=r.followAdditionalWrappers,a=e.childNodes;for(var o in a){var s=a[o];if(-1!==[\"Wrapper\",\"InLine\"].indexOf(s.nodeName)&&(\"Wrapper\"!==s.nodeName||!1!==n)){if(w.copyNodeAttribute(\"id\",e,s),w.copyNodeAttribute(\"sequence\",e,s),w.copyNodeAttribute(\"adType\",e,s),\"Wrapper\"===s.nodeName)return{ad:G(s,t),type:\"WRAPPER\"};if(\"InLine\"===s.nodeName)return{ad:H(s,t,{allowMultipleAds:i}),type:\"INLINE\"}}}}function H(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.allowMultipleAds;return!1===i&&e.getAttribute(\"sequence\")?null:_(e,t)}function _(e,t){var r=[];t&&W.verifyRequiredValues(e,t);var i=e.childNodes,n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,sequence:e.sequence||null,adType:e.adType||null,adServingId:null,categories:[],expires:null,viewableImpression:[],system:null,title:null,description:null,advertiser:null,pricing:null,survey:null,errorURLTemplates:[],impressionURLTemplates:[],creatives:[],extensions:[],adVerifications:[],blockedAdCategories:[],followAdditionalWrappers:!0,allowMultipleAds:!1,fallbackOnNoAd:null}}(w.parseAttributes(e));for(var a in i){var o=i[a];switch(o.nodeName){case\"Error\":n.errorURLTemplates.push(w.parseNodeText(o));break;case\"Impression\":n.impressionURLTemplates.push({id:o.getAttribute(\"id\")||null,url:w.parseNodeText(o)});break;case\"Creatives\":n.creatives=D(w.childrenByName(o,\"Creative\"));break;case\"Extensions\":var s=w.childrenByName(o,\"Extension\");n.extensions=S(s),n.adVerifications.length||(r=Y(s));break;case\"AdVerifications\":n.adVerifications=z(w.childrenByName(o,\"Verification\"));break;case\"AdSystem\":n.system={value:w.parseNodeText(o),version:o.getAttribute(\"version\")||null};break;case\"AdTitle\":n.title=w.parseNodeText(o);break;case\"AdServingId\":n.adServingId=w.parseNodeText(o);break;case\"Category\":n.categories.push({authority:o.getAttribute(\"authority\")||null,value:w.parseNodeText(o)});break;case\"Expires\":n.expires=parseInt(w.parseNodeText(o),10);break;case\"ViewableImpression\":n.viewableImpression.push(X(o));break;case\"Description\":n.description=w.parseNodeText(o);break;case\"Advertiser\":n.advertiser={id:o.getAttribute(\"id\")||null,value:w.parseNodeText(o)};break;case\"Pricing\":n.pricing={value:w.parseNodeText(o),model:o.getAttribute(\"model\")||null,currency:o.getAttribute(\"currency\")||null};break;case\"Survey\":n.survey=w.parseNodeText(o);break;case\"BlockedAdCategories\":n.blockedAdCategories.push({authority:o.getAttribute(\"authority\")||null,value:w.parseNodeText(o)})}}return r.length&&(n.adVerifications=n.adVerifications.concat(r)),n}function G(e,t){var r=_(e,t),i=e.getAttribute(\"followAdditionalWrappers\"),n=e.getAttribute(\"allowMultipleAds\"),a=e.getAttribute(\"fallbackOnNoAd\");r.followAdditionalWrappers=!i||w.parseBoolean(i),r.allowMultipleAds=!!n&&w.parseBoolean(n),r.fallbackOnNoAd=a?w.parseBoolean(a):null;var o=w.childByName(e,\"VASTAdTagURI\");if(o?r.nextWrapperURL=w.parseNodeText(o):(o=w.childByName(e,\"VASTAdTagURL\"))&&(r.nextWrapperURL=w.parseNodeText(w.childByName(o,\"URL\"))),r.creatives.forEach((function(e){if(-1!==[\"linear\",\"nonlinear\"].indexOf(e.type)){if(e.trackingEvents){r.trackingEvents||(r.trackingEvents={}),r.trackingEvents[e.type]||(r.trackingEvents[e.type]={});var t=function(t){var i=e.trackingEvents[t];Array.isArray(r.trackingEvents[e.type][t])||(r.trackingEvents[e.type][t]=[]),i.forEach((function(i){r.trackingEvents[e.type][t].push(i)}))};for(var i in e.trackingEvents)t(i)}e.videoClickTrackingURLTemplates&&(Array.isArray(r.videoClickTrackingURLTemplates)||(r.videoClickTrackingURLTemplates=[]),e.videoClickTrackingURLTemplates.forEach((function(e){r.videoClickTrackingURLTemplates.push(e)}))),e.videoClickThroughURLTemplate&&(r.videoClickThroughURLTemplate=e.videoClickThroughURLTemplate),e.videoCustomClickURLTemplates&&(Array.isArray(r.videoCustomClickURLTemplates)||(r.videoCustomClickURLTemplates=[]),e.videoCustomClickURLTemplates.forEach((function(e){r.videoCustomClickURLTemplates.push(e)})))}})),r.nextWrapperURL)return r}function z(e){var t=[];return e.forEach((function(e){var r={resource:null,vendor:null,browserOptional:!1,apiFramework:null,type:null,parameters:null,trackingEvents:{}},i=e.childNodes;for(var n in w.assignAttributes(e.attributes,r),i){var a=i[n];switch(a.nodeName){case\"JavaScriptResource\":case\"ExecutableResource\":r.resource=w.parseNodeText(a),w.assignAttributes(a.attributes,r);break;case\"VerificationParameters\":r.parameters=w.parseNodeText(a)}}var o=w.childByName(e,\"TrackingEvents\");o&&w.childrenByName(o,\"Tracking\").forEach((function(e){var t=e.getAttribute(\"event\"),i=w.parseNodeText(e);t&&i&&(Array.isArray(r.trackingEvents[t])||(r.trackingEvents[t]=[]),r.trackingEvents[t].push(i))})),t.push(r)})),t}function Y(e){var t=null,r=[];return e.some((function(e){return t=w.childByName(e,\"AdVerifications\")})),t&&(r=z(w.childrenByName(t,\"Verification\"))),r}function X(e){var t={};t.id=e.getAttribute(\"id\")||null;var r=e.childNodes;for(var i in r){var n=r[i],a=n.nodeName,o=w.parseNodeText(n);if((\"Viewable\"===a||\"NotViewable\"===a||\"ViewUndetermined\"===a)&&o){var s=a.toLowerCase();Array.isArray(t[s])||(t[s]=[]),t[s].push(o)}}return t}var K=function(){function e(){n(this,e),this._handlers=[]}return o(e,[{key:\"on\",value:function(e,t){if(\"function\"!=typeof t)throw new TypeError(\"The handler argument must be of type Function. Received type \".concat(i(t)));if(!e)throw new TypeError(\"The event argument must be of type String. Received type \".concat(i(e)));return this._handlers.push({event:e,handler:t}),this}},{key:\"once\",value:function(e,t){return this.on(e,function(e,t,r){var i={fired:!1,wrapFn:void 0};function n(){i.fired||(e.off(t,i.wrapFn),i.fired=!0,r.bind(e).apply(void 0,arguments))}return i.wrapFn=n,n}(this,e,t))}},{key:\"off\",value:function(e,t){return this._handlers=this._handlers.filter((function(r){return r.event!==e||r.handler!==t})),this}},{key:\"emit\",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var n=!1;return this._handlers.forEach((function(t){\"*\"===t.event&&(n=!0,t.handler.apply(t,[e].concat(r))),t.event===e&&(n=!0,t.handler.apply(t,r))})),n}},{key:\"removeAllListeners\",value:function(e){return e?(this._handlers=this._handlers.filter((function(t){return t.event!==e})),this):(this._handlers=[],this)}},{key:\"listenerCount\",value:function(e){return this._handlers.filter((function(t){return t.event===e})).length}},{key:\"listeners\",value:function(e){return this._handlers.reduce((function(t,r){return r.event===e&&t.push(r.handler),t}),[])}},{key:\"eventNames\",value:function(){return this._handlers.map((function(e){return e.event}))}}]),e}();var Q={get:function(e,t,r){r(new Error(\"Please bundle the library for node to use the node urlHandler\"))}},Z=12e4;function J(){try{var e=new window.XMLHttpRequest;return\"withCredentials\"in e?e:null}catch(e){return null}}function $(e,t,r){var i=r?408:e.status,n=r?\"XHRURLHandler: Request timed out after \".concat(e.timeout,\" ms (\").concat(i,\")\"):\"XHRURLHandler: \".concat(e.statusText,\" (\").concat(i,\")\");t(new Error(n),null,{statusCode:i})}var ee={get:function(e,t,r){if(\"https:\"===window.location.protocol&&0===e.indexOf(\"http://\"))return r(new Error(\"XHRURLHandler: Cannot go from HTTPS to HTTP.\"));try{var i=J();i.open(\"GET\",e),i.timeout=t.timeout||Z,i.withCredentials=t.withCredentials||!1,i.overrideMimeType&&i.overrideMimeType(\"text/xml\"),i.onload=function(){return function(e,t){200===e.status?t(null,e.responseXML,{byteLength:e.response.length,statusCode:e.status}):$(e,t,!1)}(i,r)},i.onerror=function(){return $(i,r,!1)},i.onabort=function(){return $(i,r,!1)},i.ontimeout=function(){return $(i,r,!0)},i.send()}catch(e){r(new Error(\"XHRURLHandler: Unexpected error\"))}},supported:function(){return!!J()}};var te={get:function(e,t,r){return r||(\"function\"==typeof t&&(r=t),t={}),\"undefined\"==typeof window||null===window?Q.get(e,t,r):ee.supported()?ee.get(e,t,r):r(new Error(\"Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler\"))}};var re=0,ie=0,ne=function(e,t){!e||!t||e<=0||t<=0||(ie=(ie*re+8*e/t)/++re)},ae={ERRORCODE:900,extensions:[]},oe=function(e){l(r,e);var t=p(r);function r(){var e;return n(this,r),(e=t.call(this)).remainingAds=[],e.parentURLs=[],e.errorURLTemplates=[],e.rootErrorURLTemplates=[],e.maxWrapperDepth=null,e.URLTemplateFilters=[],e.fetchingOptions={},e.parsingOptions={},e}return o(r,[{key:\"addURLTemplateFilter\",value:function(e){\"function\"==typeof e&&this.URLTemplateFilters.push(e)}},{key:\"removeURLTemplateFilter\",value:function(){this.URLTemplateFilters.pop()}},{key:\"countURLTemplateFilters\",value:function(){return this.URLTemplateFilters.length}},{key:\"clearURLTemplateFilters\",value:function(){this.URLTemplateFilters=[]}},{key:\"trackVastError\",value:function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];this.emit(\"VAST-error\",Object.assign.apply(Object,[{},ae,t].concat(i))),N.track(e,t)}},{key:\"getErrorURLTemplates\",value:function(){return this.rootErrorURLTemplates.concat(this.errorURLTemplates)}},{key:\"getEstimatedBitrate\",value:function(){return ie}},{key:\"fetchVAST\",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(a,o){t.URLTemplateFilters.forEach((function(t){e=t(e)})),t.parentURLs.push(e);var s=Date.now();t.emit(\"VAST-resolving\",{url:e,previousUrl:i,wrapperDepth:r,maxWrapperDepth:t.maxWrapperDepth,timeout:t.fetchingOptions.timeout,wrapperAd:n}),t.urlHandler.get(e,t.fetchingOptions,(function(n,l){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=Math.round(Date.now()-s),d=Object.assign({url:e,previousUrl:i,wrapperDepth:r,error:n,duration:c},u);t.emit(\"VAST-resolved\",d),ne(u.byteLength,c),n?o(n):a(l)}))}))}},{key:\"initParsingStatus\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.errorURLTemplates=[],this.fetchingOptions={timeout:e.timeout||Z,withCredentials:e.withCredentials},this.maxWrapperDepth=e.wrapperLimit||10,this.parentURLs=[],this.parsingOptions={allowMultipleAds:e.allowMultipleAds},this.remainingAds=[],this.rootErrorURLTemplates=[],this.rootURL=\"\",this.urlHandler=e.urlHandler||e.urlhandler||te,this.vastVersion=null,ne(e.byteLength,e.requestDuration)}},{key:\"getRemainingAds\",value:function(e){var t=this;if(0===this.remainingAds.length)return Promise.reject(new Error(\"No more ads are available for the given VAST\"));var r=e?N.flatten(this.remainingAds):this.remainingAds.shift();return this.errorURLTemplates=[],this.parentURLs=[],this.resolveAds(r,{wrapperDepth:0,url:this.rootURL}).then((function(e){return t.buildVASTResponse(e)}))}},{key:\"getAndParseVAST\",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(r),this.URLTemplateFilters.forEach((function(t){e=t(e)})),this.rootURL=e,this.fetchVAST(e).then((function(i){return r.previousUrl=e,r.isRootVAST=!0,r.url=e,t.parse(i,r).then((function(e){return t.buildVASTResponse(e)}))}))}},{key:\"parseVAST\",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(r),r.isRootVAST=!0,this.parse(e,r).then((function(e){return t.buildVASTResponse(e)}))}},{key:\"buildVASTResponse\",value:function(e){var t,r={ads:(t={ads:e,errorURLTemplates:this.getErrorURLTemplates(),version:this.vastVersion}).ads||[],errorURLTemplates:t.errorURLTemplates||[],version:t.version||null};return this.completeWrapperResolving(r),r}},{key:\"parseVastXml\",value:function(e,t){var r=t.isRootVAST,i=void 0!==r&&r,n=t.url,a=void 0===n?null:n,o=t.wrapperDepth,s=void 0===o?0:o,l=t.allowMultipleAds,u=t.followAdditionalWrappers;if(!e||!e.documentElement||\"VAST\"!==e.documentElement.nodeName)throw this.emit(\"VAST-ad-parsed\",{type:\"ERROR\",url:a,wrapperDepth:s}),new Error(\"Invalid VAST XMLDocument\");var c=[],d=e.documentElement.childNodes,p=e.documentElement.getAttribute(\"version\");for(var h in i&&p&&(this.vastVersion=p),d){var v=d[h];if(\"Error\"===v.nodeName){var f=w.parseNodeText(v);i?this.rootErrorURLTemplates.push(f):this.errorURLTemplates.push(f)}else if(\"Ad\"===v.nodeName){if(this.vastVersion&&parseFloat(this.vastVersion)<3)l=!0;else if(!1===l&&c.length>1)break;var m=q(v,this.emit.bind(this),{allowMultipleAds:l,followAdditionalWrappers:u});m.ad?(c.push(m.ad),this.emit(\"VAST-ad-parsed\",{type:m.type,url:a,wrapperDepth:s,adIndex:c.length-1,vastVersion:p})):this.trackVastError(this.getErrorURLTemplates(),{ERRORCODE:101})}}return c}},{key:\"parse\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.url,i=void 0===r?null:r,n=t.resolveAll,a=void 0===n||n,o=t.wrapperSequence,s=void 0===o?null:o,l=t.previousUrl,u=void 0===l?null:l,c=t.wrapperDepth,d=void 0===c?0:c,p=t.isRootVAST,h=void 0!==p&&p,v=t.followAdditionalWrappers,f=t.allowMultipleAds,m=[];this.vastVersion&&parseFloat(this.vastVersion)<3&&h&&(f=!0);try{m=this.parseVastXml(e,{isRootVAST:h,url:i,wrapperDepth:d,allowMultipleAds:f,followAdditionalWrappers:v})}catch(e){return Promise.reject(e)}return 1===m.length&&null!=s&&(m[0].sequence=s),!1===a&&(this.remainingAds=w.splitVAST(m),m=this.remainingAds.shift()),this.resolveAds(m,{wrapperDepth:d,previousUrl:u,url:i})}},{key:\"resolveAds\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,i=r.wrapperDepth,n=r.previousUrl,a=r.url,o=[];return n=a,t.forEach((function(t){var r=e.resolveWrappers(t,i,n);o.push(r)})),Promise.all(o).then((function(t){var r=N.flatten(t);if(!r&&e.remainingAds.length>0){var o=e.remainingAds.shift();return e.resolveAds(o,{wrapperDepth:i,previousUrl:n,url:a})}return r}))}},{key:\"resolveWrappers\",value:function(e,t,r){var i=this;return new Promise((function(n){var a;if(t++,!e.nextWrapperURL)return delete e.nextWrapperURL,n(e);if(t>=i.maxWrapperDepth||-1!==i.parentURLs.indexOf(e.nextWrapperURL))return e.errorCode=302,delete e.nextWrapperURL,n(e);e.nextWrapperURL=w.resolveVastAdTagURI(e.nextWrapperURL,r),i.URLTemplateFilters.forEach((function(t){e.nextWrapperURL=t(e.nextWrapperURL)}));var o=null!==(a=i.parsingOptions.allowMultipleAds)&&void 0!==a?a:e.allowMultipleAds,s=e.sequence;i.fetchVAST(e.nextWrapperURL,t,r,e).then((function(a){return i.parse(a,{url:e.nextWrapperURL,previousUrl:r,wrapperSequence:s,wrapperDepth:t,followAdditionalWrappers:e.followAdditionalWrappers,allowMultipleAds:o}).then((function(t){if(delete e.nextWrapperURL,0===t.length)return e.creatives=[],n(e);t.forEach((function(t){t&&w.mergeWrapperAdData(t,e)})),n(t)}))})).catch((function(t){e.errorCode=301,e.errorMessage=t.message,n(e)}))}))}},{key:\"completeWrapperResolving\",value:function(e){if(0===e.ads.length)this.trackVastError(e.errorURLTemplates,{ERRORCODE:303});else for(var t=e.ads.length-1;t>=0;t--){var r=e.ads[t];(r.errorCode||0===r.creatives.length)&&(this.trackVastError(r.errorURLTemplates.concat(e.errorURLTemplates),{ERRORCODE:r.errorCode||303},{ERRORMESSAGE:r.errorMessage||\"\"},{extensions:r.extensions},{system:r.system}),e.ads.splice(t,1))}}}]),r}(K),se=null,le={data:{},length:0,getItem:function(e){return this.data[e]},setItem:function(e,t){this.data[e]=t,this.length=Object.keys(this.data).length},removeItem:function(e){delete this.data[e],this.length=Object.keys(this.data).length},clear:function(){this.data={},this.length=0}},ue=function(){function e(){n(this,e),this.storage=this.initStorage()}return o(e,[{key:\"initStorage\",value:function(){if(se)return se;try{se=\"undefined\"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){se=null}return se&&!this.isStorageDisabled(se)||(se=le).clear(),se}},{key:\"isStorageDisabled\",value:function(e){var t=\"__VASTStorage__\";try{if(e.setItem(t,t),e.getItem(t)!==t)return e.removeItem(t),!0}catch(e){return!0}return e.removeItem(t),!1}},{key:\"getItem\",value:function(e){return this.storage.getItem(e)}},{key:\"setItem\",value:function(e,t){return this.storage.setItem(e,t)}},{key:\"removeItem\",value:function(e){return this.storage.removeItem(e)}},{key:\"clear\",value:function(){return this.storage.clear()}}]),e}(),ce=function(){function e(t,r,i){n(this,e),this.cappingFreeLunch=t||0,this.cappingMinimumTimeInterval=r||0,this.defaultOptions={withCredentials:!1,timeout:0},this.vastParser=new oe,this.storage=i||new ue,void 0===this.lastSuccessfulAd&&(this.lastSuccessfulAd=0),void 0===this.totalCalls&&(this.totalCalls=0),void 0===this.totalCallsTimeout&&(this.totalCallsTimeout=0)}return o(e,[{key:\"getParser\",value:function(){return this.vastParser}},{key:\"lastSuccessfulAd\",get:function(){return this.storage.getItem(\"vast-client-last-successful-ad\")},set:function(e){this.storage.setItem(\"vast-client-last-successful-ad\",e)}},{key:\"totalCalls\",get:function(){return this.storage.getItem(\"vast-client-total-calls\")},set:function(e){this.storage.setItem(\"vast-client-total-calls\",e)}},{key:\"totalCallsTimeout\",get:function(){return this.storage.getItem(\"vast-client-total-calls-timeout\")},set:function(e){this.storage.setItem(\"vast-client-total-calls-timeout\",e)}},{key:\"hasRemainingAds\",value:function(){return this.vastParser.remainingAds.length>0}},{key:\"getNextAds\",value:function(e){return this.vastParser.getRemainingAds(e)}},{key:\"get\",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Date.now();return(r=Object.assign({},this.defaultOptions,r)).hasOwnProperty(\"resolveAll\")||(r.resolveAll=!1),this.totalCallsTimeout<i?(this.totalCalls=1,this.totalCallsTimeout=i+36e5):this.totalCalls++,new Promise((function(n,a){if(t.cappingFreeLunch>=t.totalCalls)return a(new Error(\"VAST call canceled – FreeLunch capping not reached yet \".concat(t.totalCalls,\"/\").concat(t.cappingFreeLunch)));var o=i-t.lastSuccessfulAd;if(o<0)t.lastSuccessfulAd=0;else if(o<t.cappingMinimumTimeInterval)return a(new Error(\"VAST call canceled – (\".concat(t.cappingMinimumTimeInterval,\")ms minimum interval reached\")));t.vastParser.getAndParseVAST(e,r).then((function(e){return n(e)})).catch((function(e){return a(e)}))}))}}]),e}(),de=function(e){l(a,e);var t=p(a);function a(e,r,i){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;for(var l in n(this,a),(o=t.call(this)).ad=r,o.creative=i,o.variation=s,o.muted=!1,o.impressed=!1,o.skippable=!1,o.trackingEvents={},o.lastPercentage=0,o._alreadyTriggeredQuartiles={},o.emitAlwaysEvents=[\"creativeView\",\"start\",\"firstQuartile\",\"midpoint\",\"thirdQuartile\",\"complete\",\"resume\",\"pause\",\"rewind\",\"skip\",\"closeLinear\",\"close\"],o.creative.trackingEvents){var u=o.creative.trackingEvents[l];o.trackingEvents[l]=u.slice(0)}return C(o.creative)?o._initLinearTracking():o._initVariationTracking(),e&&o.on(\"start\",(function(){e.lastSuccessfulAd=Date.now()})),o}return o(a,[{key:\"_initLinearTracking\",value:function(){this.linear=!0,this.skipDelay=this.creative.skipDelay,this.setDuration(this.creative.duration),this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates}},{key:\"_initVariationTracking\",value:function(){if(this.linear=!1,this.skipDelay=-1,this.variation){for(var e in this.variation.trackingEvents){var t=this.variation.trackingEvents[e];this.trackingEvents[e]?this.trackingEvents[e]=this.trackingEvents[e].concat(t.slice(0)):this.trackingEvents[e]=t.slice(0)}\"nonLinearAd\"===this.variation.adType?(this.clickThroughURLTemplate=this.variation.nonlinearClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.nonlinearClickTrackingURLTemplates,this.setDuration(this.variation.minSuggestedDuration)):function(e){return\"companionAd\"===e.adType}(this.variation)&&(this.clickThroughURLTemplate=this.variation.companionClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.companionClickTrackingURLTemplates)}}},{key:\"setDuration\",value:function(e){N.isValidTimeValue(e)&&(this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100})}},{key:\"setProgress\",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(N.isValidTimeValue(e)&&\"object\"===i(r)){var n=this.skipDelay||-1;if(-1===n||this.skippable||(n>e?this.emit(\"skip-countdown\",n-e):(this.skippable=!0,this.emit(\"skip-countdown\",0))),this.assetDuration>0){var a=Math.round(e/this.assetDuration*100),o=[];if(e>0){o.push(\"start\");for(var s=this.lastPercentage;s<a;s++)o.push(\"progress-\".concat(s+1,\"%\"));for(var l in o.push(\"progress-\".concat(Math.round(e))),this.quartiles)this.isQuartileReached(l,this.quartiles[l],e)&&(o.push(l),this._alreadyTriggeredQuartiles[l]=!0);this.lastPercentage=a}o.forEach((function(e){t.track(e,{macros:r,once:!0})})),e<this.progress&&this.track(\"rewind\",{macros:r})}this.progress=e}}},{key:\"isQuartileReached\",value:function(e,t,r){var i=!1;return t<=r&&!this._alreadyTriggeredQuartiles[e]&&(i=!0),i}},{key:\"setMuted\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};\"boolean\"==typeof e&&\"object\"===i(t)&&(this.muted!==e&&this.track(e?\"mute\":\"unmute\",{macros:t}),this.muted=e)}},{key:\"setPaused\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};\"boolean\"==typeof e&&\"object\"===i(t)&&(this.paused!==e&&this.track(e?\"pause\":\"resume\",{macros:t}),this.paused=e)}},{key:\"setFullscreen\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};\"boolean\"==typeof e&&\"object\"===i(t)&&(this.fullscreen!==e&&this.track(e?\"fullscreen\":\"exitFullscreen\",{macros:t}),this.fullscreen=e)}},{key:\"setExpand\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};\"boolean\"==typeof e&&\"object\"===i(t)&&(this.expanded!==e&&(this.track(e?\"expand\":\"collapse\",{macros:t}),this.track(e?\"playerExpand\":\"playerCollapse\",{macros:t})),this.expanded=e)}},{key:\"setSkipDelay\",value:function(e){N.isValidTimeValue(e)&&(this.skipDelay=e)}},{key:\"trackImpression\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&(this.impressed||(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates,e),this.track(\"creativeView\",{macros:e})))}},{key:\"error\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];\"object\"===i(e)&&\"boolean\"==typeof t&&this.trackURLs(this.ad.errorURLTemplates,e,{isCustomCode:t})}},{key:\"errorWithCode\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];\"string\"==typeof e&&\"boolean\"==typeof t&&(this.error({ERRORCODE:e},t),console.log(\"The method errorWithCode is deprecated, please use vast tracker error method instead\"))}},{key:\"complete\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&this.track(\"complete\",{macros:e})}},{key:\"notUsed\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&(this.track(\"notUsed\",{macros:e}),this.trackingEvents=[])}},{key:\"otherAdInteraction\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&this.track(\"otherAdInteraction\",{macros:e})}},{key:\"acceptInvitation\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&this.track(\"acceptInvitation\",{macros:e})}},{key:\"adExpand\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&this.track(\"adExpand\",{macros:e})}},{key:\"adCollapse\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&this.track(\"adCollapse\",{macros:e})}},{key:\"minimize\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&this.track(\"minimize\",{macros:e})}},{key:\"verificationNotExecuted\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(\"string\"==typeof e&&\"object\"===i(t)){if(!this.ad||!this.ad.adVerifications||!this.ad.adVerifications.length)throw new Error(\"No adVerifications provided\");if(!e)throw new Error(\"No vendor provided, unable to find associated verificationNotExecuted\");var r=this.ad.adVerifications.find((function(t){return t.vendor===e}));if(!r)throw new Error(\"No associated verification element found for vendor: \".concat(e));var n=r.trackingEvents;if(n&&n.verificationNotExecuted){var a=n.verificationNotExecuted;this.trackURLs(a,t),this.emit(\"verificationNotExecuted\",{trackingURLTemplates:a})}}}},{key:\"overlayViewDuration\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};\"string\"==typeof e&&\"object\"===i(t)&&(t.ADPLAYHEAD=e,this.track(\"overlayViewDuration\",{macros:t}))}},{key:\"close\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&this.track(this.linear?\"closeLinear\":\"close\",{macros:e})}},{key:\"skip\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&this.track(\"skip\",{macros:e})}},{key:\"load\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};\"object\"===i(e)&&this.track(\"loaded\",{macros:e})}},{key:\"click\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((null===e||\"string\"==typeof e)&&\"object\"===i(t)){this.clickTrackingURLTemplates&&this.clickTrackingURLTemplates.length&&this.trackURLs(this.clickTrackingURLTemplates,t);var n=this.clickThroughURLTemplate||e,a=r({},t);if(n){this.progress&&(a.ADPLAYHEAD=this.progressFormatted());var o=N.resolveURLTemplates([n],a)[0];this.emit(\"clickthrough\",o)}}}},{key:\"track\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.macros,n=void 0===r?{}:r,a=t.once,o=void 0!==a&&a;if(\"object\"===i(n)){\"closeLinear\"===e&&!this.trackingEvents[e]&&this.trackingEvents.close&&(e=\"close\");var s=this.trackingEvents[e],l=this.emitAlwaysEvents.indexOf(e)>-1;s?(this.emit(e,{trackingURLTemplates:s}),this.trackURLs(s,n)):l&&this.emit(e,null),o&&(delete this.trackingEvents[e],l&&this.emitAlwaysEvents.splice(this.emitAlwaysEvents.indexOf(e),1))}}},{key:\"trackURLs\",value:function(e){var t,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r({},n);this.linear&&(this.creative&&this.creative.mediaFiles&&this.creative.mediaFiles[0]&&this.creative.mediaFiles[0].fileURL&&(o.ASSETURI=this.creative.mediaFiles[0].fileURL),this.progress&&(o.ADPLAYHEAD=this.progressFormatted())),null!==(t=this.creative)&&void 0!==t&&null!==(i=t.universalAdIds)&&void 0!==i&&i.length&&(o.UNIVERSALADID=this.creative.universalAdIds.map((function(e){return e.idRegistry.concat(\" \",e.value)})).join(\",\")),this.ad&&(this.ad.sequence&&(o.PODSEQUENCE=this.ad.sequence),this.ad.adType&&(o.ADTYPE=this.ad.adType),this.ad.adServingId&&(o.ADSERVINGID=this.ad.adServingId),this.ad.categories&&this.ad.categories.length&&(o.ADCATEGORIES=this.ad.categories.map((function(e){return e.value})).join(\",\")),this.ad.blockedAdCategories&&this.ad.blockedAdCategories.length&&(o.BLOCKEDADCATEGORIES=this.ad.blockedAdCategories)),N.track(e,o,a)}},{key:\"convertToTimecode\",value:function(e){if(!N.isValidTimeValue(e))return\"\";var t=1e3*e,r=Math.floor(t/36e5),i=Math.floor(t/6e4%60),n=Math.floor(t/1e3%60),a=Math.floor(t%1e3);return\"\".concat(N.addLeadingZeros(r,2),\":\").concat(N.addLeadingZeros(i,2),\":\").concat(N.addLeadingZeros(n,2),\".\").concat(N.addLeadingZeros(a,3))}},{key:\"progressFormatted\",value:function(){return this.convertToTimecode(this.progress)}}]),a}(K);e.VASTClient=ce,e.VASTParser=oe,e.VASTTracker=de,Object.defineProperty(e,\"__esModule\",{value:!0})}));\n\n\n//# sourceURL=webpack://adserve/./node_modules/@dailymotion/vast-client/dist/vast-client.min.js?");

/***/ }),

/***/ "./src/ad-error.js":
/*!*************************!*\
  !*** ./src/ad-error.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ \"./src/utils.js\");\n\r\n\r\nconst AdError = function(message, errorCode, innerError) {\r\n  this.message = message;\r\n  this.errorCode = errorCode;\r\n  this.innerError = innerError;\r\n};\r\nAdError.prototype.getMessage = function() {\r\n  return this.message;\r\n};\r\nAdError.prototype.getErrorCode = function() {\r\n  return this.errorCode;\r\n};\r\nAdError.prototype.getInnerError = function() {\r\n  return this.innerError instanceof Object ? this.innerError : null;\r\n};\r\nAdError.prototype.setInnerError = function(innerError) {\r\n  this.innerError = innerError\r\n}\r\nAdError.prototype.formatMessage = function(...values) {\r\n  this.message = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.format)(this.message, values);\r\n  return this;\r\n};\r\nAdError.prototype.toString = function() {\r\n  return 'AdError ' + this.getErrorCode() + ': ' + this.getMessage() + (null != this.getInnerError() ? ' Caused by: ' + this.getInnerError() : '');\r\n};\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AdError);\r\n\n\n//# sourceURL=webpack://adserve/./src/ad-error.js?");

/***/ }),

/***/ "./src/ad.js":
/*!*******************!*\
  !*** ./src/ad.js ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst Ad = function(creative) {\r\n  this.adId = creative.adId;\r\n  this.duration = creative.duration;\r\n  this.linear = creative.type === 'linear' ? true : false;\r\n};\r\nAd.prototype.getAdId = function() {\r\n  return this.adId;\r\n};\r\nAd.prototype.getDuration = function() {\r\n  return this.duration;\r\n};\r\nAd.prototype.getMediaUrl = function() {\r\n  return null;\r\n};\r\nAd.prototype.isLinear = function() {\r\n  return this.linear;\r\n};\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Ad);\r\n\n\n//# sourceURL=webpack://adserve/./src/ad.js?");

/***/ }),

/***/ "./src/ads-manager.js":
/*!****************************!*\
  !*** ./src/ads-manager.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dailymotion/vast-client */ \"./node_modules/@dailymotion/vast-client/dist/vast-client.min.js\");\n/* harmony import */ var _dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _ad_error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ad-error */ \"./src/ad-error.js\");\n/* harmony import */ var _ad__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ad */ \"./src/ad.js\");\n\r\n\r\n\r\n\r\nconst AdsManager = function(adContainer) {\r\n\r\n  if(!(adContainer && (adContainer instanceof HTMLElement\r\n    || adContainer.getRootNode))) {\r\n    throw new Error('ad container is not defined');\r\n  }\r\n\r\n\r\n  // Ad Container\r\n  this._adContainer = adContainer;\r\n\r\n  // Slot\r\n  this._slot = null;\r\n  // Video Slot\r\n  this._videoSlot = null;\r\n\r\n  // Create Slot\r\n  this.createSlot();\r\n\r\n  // Events\r\n  this.EVENTS = {\r\n    AdsManagerLoaded: 'AdsManagerLoaded', // After success ad request, when vast xml is parsed and ready\r\n    AdStarted: 'AdStarted',\r\n    AdStopped: 'AdStopped',\r\n    AdSkipped: 'AdSkipped',\r\n    AdLoaded: 'AdLoaded',\r\n    AdLinearChange: 'AdLinearChange',\r\n    AdSizeChange: 'AdSizeChange',\r\n    AdExpandedChange: 'AdExpandedChange',\r\n    AdSkippableStateChange: 'AdSkippableStateChange',\r\n    AdDurationChange: 'AdDurationChange',\r\n    AdRemainingTimeChange: 'AdRemainingTimeChange',\r\n    AdVolumeChange: 'AdVolumeChange',\r\n    AdImpression: 'AdImpression',\r\n    AdClickThru: 'AdClickThru',\r\n    AdInteraction: 'AdInteraction',\r\n    AdVideoStart: 'AdVideoStart',\r\n    AdVideoFirstQuartile: 'AdVideoFirstQuartile',\r\n    AdVideoMidpoint: 'AdVideoMidpoint',\r\n    AdVideoThirdQuartile: 'AdVideoThirdQuartile',\r\n    AdVideoComplete: 'AdVideoComplete',\r\n    AdUserAcceptInvitation: 'AdUserAcceptInvitation',\r\n    AdUserMinimize: 'AdUserMinimize',\r\n    AdUserClose: 'AdUserClose',\r\n    AdPaused: 'AdPaused',\r\n    AdPlaying: 'AdPlaying',\r\n    AdError: 'AdError',\r\n    AdLog: 'AdLog',\r\n    AllAdsCompleted: 'AllAdsCompleted' // After all ads completed, vast, vpaid, vmap\r\n  };\r\n  this._eventCallbacks = {};\r\n  this._creativeEventCallbacks = {};\r\n\r\n  // Attributes\r\n  this._attributes = {\r\n    width: 300,\r\n    height: 154,\r\n    viewMode: 'normal',\r\n    desiredBitrate: -1, // 268,\r\n    duration: 10,\r\n    remainingTime: 10,\r\n    currentTime: 0,\r\n    volume: 0,\r\n    version: '1.2.10'\r\n  };\r\n\r\n  // Quartile Events\r\n  this._quartileEvents = [\r\n    { event: 'AdImpression', value: 0 },\r\n    { event: 'AdVideoStart', value: 0 },\r\n    { event: 'AdVideoFirstQuartile', value: 25 },\r\n    { event: 'AdVideoMidpoint', value: 50 },\r\n    { event: 'AdVideoThirdQuartile', value: 75 },\r\n    { event: 'AdVideoComplete', value: 100 }\r\n  ];\r\n  this._nextQuartileIndex = 0;\r\n  this._defaultEventCallbacks = {\r\n    'AdImpression': this.onAdImpression.bind(this),\r\n    'AdVideoStart': this.onAdVideoStart.bind(this),\r\n    'AdVideoFirstQuartile': this.onAdVideoFirstQuartile.bind(this),\r\n    'AdVideoMidpoint': this.onAdVideoMidpoint.bind(this),\r\n    'AdVideoThirdQuartile': this.onAdVideoThirdQuartile.bind(this),\r\n    'AdVideoComplete': this.onAdVideoComplete.bind(this)\r\n  };\r\n\r\n  // Options\r\n  this._options = {\r\n    autoplay: true,\r\n    muted: true,\r\n    vastLoadTimeout: 23000,\r\n    loadVideoTimeout: 8000,\r\n    withCredentials: false,\r\n    wrapperLimit: 10,\r\n    resolveAll: true\r\n  };\r\n  // Error codes\r\n  this.ERROR_CODES = {\r\n    VAST_MALFORMED_RESPONSE:100,\r\n    ADS_REQUEST_NETWORK_ERROR: 1012,\r\n    FAILED_TO_REQUEST_ADS: 1005,\r\n    UNKNOWN_AD_RESPONSE: 1010,\r\n    VAST_ASSET_NOT_FOUND: 1007,\r\n    VAST_EMPTY_RESPONSE: 1009,\r\n    VAST_LINEAR_ASSET_MISMATCH: 403,\r\n    VAST_LOAD_TIMEOUT: 301,\r\n    VAST_MEDIA_LOAD_TIMEOUT: 402,\r\n    VIDEO_PLAY_ERROR: 400,\r\n    VPAID_ERROR: 901,\r\n  };\r\n  // Error messages\r\n  this.ERROR_MESSAGES = {\r\n    VAST_MALFORMED_RESPONSE: 'VAST response was malformed and could not be parsed.', // 100\r\n    ADS_REQUEST_ERROR: 'Unable to request ads from server. Cause: {0}.', // 1005\r\n    ADS_REQUEST_NETWORK_ERROR: 'Unable to request ads from server due to network error.', // 1012\r\n    FAILED_TO_REQUEST_ADS: 'The was a problem requesting ads from the server.', // 1005\r\n    NO_ADS_FOUND: 'The response does not contain any valid ads.', // 1009\r\n    UNKNOWN_AD_RESPONSE: 'The ad response was not understood and cannot be parsed.', // 1010\r\n    VAST_ASSET_NOT_FOUND: 'No assets were found in the VAST ad response.', // 1007\r\n    VAST_EMPTY_RESPONSE: 'The VAST response document is empty.', // 1009\r\n    VAST_LINEAR_ASSET_MISMATCH: 'Linear assets were found in the VAST ad response, but none of them matched the player\\'s capabilities.', // 403\r\n    VAST_LOAD_TIMEOUT: 'Ad request reached a timeout.', // 301\r\n    VAST_MEDIA_LOAD_TIMEOUT: 'VAST media file loading reached a timeout of {0} seconds.', // 402\r\n    VIDEO_PLAY_ERROR: 'There was an error playing the video ad.', // 400\r\n    VPAID_CREATIVE_ERROR: 'An unexpected error occurred within the VPAID creative. Refer to the inner error for more info.' // 901 TODO:\r\n  };\r\n  // Errors\r\n  this.ERRORS = {\r\n    VAST_MALFORMED_RESPONSE: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_MALFORMED_RESPONSE, this.ERROR_CODES.VAST_MALFORMED_RESPONSE),\r\n    VAST_EMPTY_RESPONSE: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_EMPTY_RESPONSE, this.ERROR_CODES.VAST_EMPTY_RESPONSE),\r\n    VAST_ASSET_NOT_FOUND: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_ASSET_NOT_FOUND, this.ERROR_CODES.VAST_ASSET_NOT_FOUND),\r\n    VAST_LINEAR_ASSET_MISMATCH: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_LINEAR_ASSET_MISMATCH, this.ERROR_CODES.VAST_LINEAR_ASSET_MISMATCH),\r\n    VAST_LOAD_TIMEOUT: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_LOAD_TIMEOUT, this.ERROR_CODES.VAST_LOAD_TIMEOUT),\r\n    VAST_MEDIA_LOAD_TIMEOUT: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_MEDIA_LOAD_TIMEOUT, this.ERROR_CODES.VAST_MEDIA_LOAD_TIMEOUT),\r\n    VIDEO_PLAY_ERROR: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VIDEO_PLAY_ERROR, this.ERROR_CODES.VIDEO_PLAY_ERROR),\r\n    VPAID_CREATIVE_ERROR: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VPAID_CREATIVE_ERROR, this.ERROR_CODES.VPAID_ERROR)\r\n  };\r\n\r\n  this._vastClient = null;\r\n  this._vastParser = null;\r\n  this._vastTracker = null;\r\n\r\n  this._ad = null;\r\n  this._adPod = null;\r\n  this._isAdPod = false;\r\n\r\n  this._creative = null;\r\n  this._mediaFiles = null;\r\n  this._mediaFileIndex = 0;\r\n  this._mediaFile = null;\r\n\r\n  this._isVPAID = false;\r\n  this._vpaidIframe = null;\r\n  this._vpaidCreative = null;\r\n\r\n  // Timers, Intervals\r\n  this._vastMediaLoadTimer = null;\r\n  this._vpaidProgressTimer = null;\r\n\r\n  // Request ID\r\n  this._requestId = null;\r\n\r\n  // Handlers\r\n  this._handleLoadCreativeMessage = this.handleLoadCreativeMessage.bind(this);\r\n  // Slot handlers\r\n  this._handleSlotClick = this.handleSlotClick.bind(this);\r\n  // Video slot handlers\r\n  this._handleVideoSlotError = this.handleVideoSlotError.bind(this);\r\n  this._handleVideoSlotCanPlay = this.handleVideoSlotCanPlay.bind(this);\r\n  this._handleVideoSlotVolumeChange = this.handleVideoSlotVolumeChange.bind(this);\r\n  this._handleVideoSlotTimeUpdate = this.handleVideoSlotTimeUpdate.bind(this);\r\n  this._handleVideoSlotLoadedMetaData = this.handleVideoSlotLoadedMetaData.bind(this);\r\n  this._handleVideoSlotEnded = this.handleVideoSlotEnded.bind(this);\r\n\r\n  this.MIN_VPAID_VERSION = 2;\r\n\r\n  this._hasLoaded = false;\r\n  this._hasError = false;\r\n  this._hasImpression = false;\r\n  this._hasStarted = false;\r\n\r\n  this._isDestroyed = false;\r\n\r\n};\r\nAdsManager.prototype.createSlot = function() {\r\n  console.log('create slot......');\r\n  this._slot = document.createElement('div');\r\n  this._slot.style.position = 'absolute';\r\n  this._slot.style.display = 'none';\r\n  this._adContainer.appendChild(this._slot);\r\n\r\n\r\n  this.createVideoSlot();\r\n};\r\nAdsManager.prototype.removeSlot = function() {\r\n  this._slot.parentNode && this._slot.parentNode.removeChild(this._slot);\r\n};\r\nAdsManager.prototype.showSlot = function() {\r\n  // Check if video slot has src, if no then hide video slot\r\n\r\n  if(this._videoSlot.src === '') {\r\n    // this.hideVideoSlot();\r\n  }\r\n  // Show slot\r\n  this._slot.style.display = 'block';\r\n};\r\nAdsManager.prototype.hideSlot = function() {\r\n  // Hide slot\r\n  this._slot.style.display = 'none';\r\n};\r\nAdsManager.prototype.resizeSlot = function(width, height) {\r\n  this._slot.style.width = `${width }px`;\r\n  this._slot.style.height = `${height }px`;\r\n};\r\nAdsManager.prototype.createVideoSlot = function() {\r\n  this._videoSlot = document.createElement('video');\r\n  this._videoSlot.setAttribute('webkit-playsinline', true);\r\n  this._videoSlot.setAttribute('playsinline', true);\r\n  //this._videoSlot.setAttribute('preload', 'none');\r\n  this._videoSlot.style.width = '100%';\r\n  this._videoSlot.style.height = '100%';\r\n  this._videoSlot.style.backgroundColor = 'rgb(0, 0, 0)';\r\n  //this._adContainer.appendChild(this._videoSlot);\r\n  this._slot.appendChild(this._videoSlot);\r\n};\r\nAdsManager.prototype.hideVideoSlot = function() {\r\n  this._videoSlot.style.display = 'none';\r\n};\r\nAdsManager.prototype.stopVASTMediaLoadTimeout = function() {\r\n  if(this._vastMediaLoadTimer) {\r\n    clearTimeout(this._vastMediaLoadTimer);\r\n    this._vastMediaLoadTimer = null;\r\n  }\r\n};\r\nAdsManager.prototype.startVASTMediaLoadTimeout = function() {\r\n  this.stopVASTMediaLoadTimeout();\r\n  this._vastMediaLoadTimer = setTimeout(() => {\r\n    this.onAdError(this.ERRORS.VAST_MEDIA_LOAD_TIMEOUT.formatMessage(Math.floor((this._options.loadVideoTimeout / 1000) % 60)));\r\n  }, this._options.loadVideoTimeout);\r\n};\r\nAdsManager.prototype.updateVPAIDProgress = function() {\r\n  // Check remaining time\r\n  this._attributes.remainingTime = this._isCreativeFunctionInvokable('getAdRemainingTime') ? this._vpaidCreative.getAdRemainingTime() : -1;\r\n  if(!isNaN(this._attributes.remainingTime) && this._attributes.remainingTime !== 1) {\r\n    this._attributes.currentTime = this._attributes.duration - this._attributes.remainingTime;\r\n    // Track progress\r\n    this._vastTracker.setProgress(this._attributes.currentTime);\r\n  }\r\n};\r\nAdsManager.prototype.startVPAIDProgress = function() {\r\n  this.stopVPAIDProgress();\r\n  this._vpaidProgressTimer = setInterval(() => {\r\n    if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\r\n      this.updateVPAIDProgress();\r\n    } else {\r\n      this.stopVPAIDProgress();\r\n    }\r\n  }, 1000);\r\n};\r\nAdsManager.prototype.stopVPAIDProgress = function() {\r\n  if(this._vpaidProgressTimer) {\r\n    clearInterval(this._vpaidProgressTimer);\r\n    this._vpaidProgressTimer = null;\r\n  }\r\n};\r\nAdsManager.prototype._callEvent = function(eventName) {\r\n  if(eventName in this._eventCallbacks) {\r\n    this._eventCallbacks[eventName]();\r\n  }\r\n};\r\nAdsManager.prototype.addEventListener = function(eventName, callback, context) {\r\n\r\n  const givenCallback = callback.bind(context);\r\n  this._eventCallbacks[eventName] = givenCallback;\r\n};\r\nAdsManager.prototype.removeEventListener = function(eventName) {\r\n  this._eventCallbacks[eventName] = null;\r\n};\r\nAdsManager.prototype.removeEventListeners = function(eventCallbacks) {\r\n  for (const eventName in eventCallbacks) {\r\n    eventCallbacks.hasOwnProperty(eventName) && this.removeEventListener(eventName);\r\n  }\r\n};\r\nAdsManager.prototype.onAdsManagerLoaded = function() {\r\n  this._callEvent(this.EVENTS.AdsManagerLoaded);\r\n};\r\nAdsManager.prototype.onAdLoaded = function() {\r\n\r\n  this._hasLoaded = true;\r\n\r\n  this.stopVASTMediaLoadTimeout();\r\n\r\n  if (this.EVENTS.AdLoaded in this._eventCallbacks) {\r\n    this._eventCallbacks[this.EVENTS.AdLoaded](new _ad__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this._creative));\r\n  }\r\n};\r\nAdsManager.prototype.onAdDurationChange = function() {\r\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\r\n    this._attributes.duration = this._isCreativeFunctionInvokable('getAdDuration') ? this._vpaidCreative.getAdDuration() : -1;\r\n    if(this._attributes.duration !== -1) {\r\n      this._vastTracker.setDuration(this._attributes.duration);\r\n    }\r\n  }\r\n  this._callEvent(this.EVENTS.AdDurationChange);\r\n};\r\nAdsManager.prototype.onAdSizeChange = function() {\r\n  this._callEvent(this.EVENTS.AdSizeChange);\r\n};\r\nAdsManager.prototype.onAdStarted = function() {\r\n  this._hasStarted = true;\r\n  // Show ad slot\r\n  this.showSlot();\r\n  this._callEvent(this.EVENTS.AdStarted);\r\n};\r\nAdsManager.prototype.onAdVideoStart = function() {\r\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\r\n    this.updateVPAIDProgress();\r\n  }\r\n  this._callEvent(this.EVENTS.AdVideoStart);\r\n};\r\nAdsManager.prototype.onAdStopped = function() {\r\n  if(!this._hasStarted) {\r\n    this.onAdError(this.ERRORS.VPAID_CREATIVE_ERROR);\r\n  } else {\r\n    if(this._isAdPod && this._adPod.length != 0) {\r\n\r\n      this._nextQuartileIndex = 0;\r\n      this._hasImpression = false;\r\n\r\n      // Removes ad assets loaded at runtime that need to be properly removed at the time of ad completion\r\n      // and stops the ad and all tracking.\r\n      window.removeEventListener('message', this._handleLoadCreativeMessage);\r\n\r\n      if(this._isVPAID) {\r\n        // Unsubscribe for VPAID events\r\n        this.removeCallbacksForCreative(this._creativeEventCallbacks);\r\n        this.removeCreativeAsset();\r\n        this._isVPAID = false;\r\n      }\r\n\r\n      // Remove handlers from slot and videoSlot\r\n      this._removeHandlers();\r\n      // Pause video slot, and remove src\r\n      this._videoSlot.pause();\r\n      this._videoSlot.removeAttribute('src'); // empty source\r\n      this._videoSlot.load();\r\n\r\n      setTimeout(() => {\r\n        this._nextAd();\r\n      },75);\r\n\r\n    } else {\r\n      this._callEvent(this.EVENTS.AdStopped);\r\n      // abort the ad, unsubscribe and reset to a default state\r\n      this._abort();\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.onAdSkipped = function() {\r\n  this._callEvent(this.EVENTS.AdSkipped);\r\n  // abort the ad, unsubscribe and reset to a default state\r\n  this._abort();\r\n};\r\nAdsManager.prototype.onAdVolumeChange = function() {\r\n  this._callEvent(this.EVENTS.AdVolumeChange);\r\n};\r\nAdsManager.prototype.onAdImpression = function() {\r\n  console.log('is vpaid', this._isVPAID);\r\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\r\n    if (!this._hasImpression) {\r\n      // Check duration\r\n      this._attributes.duration = this._isCreativeFunctionInvokable('getAdDuration') ? this._vpaidCreative.getAdDuration() : -1;\r\n      if(this._attributes.duration !== -1) {\r\n        this._vastTracker.setDuration(this._attributes.duration);\r\n      }\r\n      /*\r\n      // Check remaining time\r\n      this._attributes.remainingTime = this._isCreativeFunctionInvokable(\"getAdRemainingTime\") ? this._vpaidCreative.getAdRemainingTime() : -1;\r\n      console.log('update tracker with new remainingTime', this._attributes.remainingTime);\r\n      console.log('update tracker with new duration', this._attributes.duration);\r\n       */\r\n      // Track impression\r\n      this._vastTracker.trackImpression();\r\n\r\n      // Start VPAID process\r\n      this.startVPAIDProgress();\r\n\r\n      this._hasImpression = true;\r\n    }\r\n  }\r\n  this._callEvent(this.EVENTS.AdImpression);\r\n};\r\nAdsManager.prototype.onAdClickThru = function(url, id, playerHandles) {\r\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\r\n    this._vastTracker.click();\r\n  }\r\n  if (this.EVENTS.AdClickThru in this._eventCallbacks) {\r\n    this._eventCallbacks[this.EVENTS.AdClickThru](url, id, playerHandles);\r\n  }\r\n};\r\nAdsManager.prototype.onAdVideoFirstQuartile = function() {\r\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\r\n    this.updateVPAIDProgress();\r\n  }\r\n  this._callEvent(this.EVENTS.AdVideoFirstQuartile);\r\n};\r\nAdsManager.prototype.onAdVideoMidpoint = function() {\r\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\r\n    this.updateVPAIDProgress();\r\n  }\r\n  this._callEvent(this.EVENTS.AdVideoMidpoint);\r\n};\r\nAdsManager.prototype.onAdVideoThirdQuartile = function() {\r\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\r\n    this.updateVPAIDProgress();\r\n  }\r\n  this._callEvent(this.EVENTS.AdVideoThirdQuartile);\r\n};\r\nAdsManager.prototype.onAdPaused = function() {\r\n  if(this._vastTracker) {\r\n    this._vastTracker.setPaused(true);\r\n  }\r\n  this._callEvent(this.EVENTS.AdPaused);\r\n};\r\nAdsManager.prototype.onAdPlaying = function() {\r\n  if(this._vastTracker) {\r\n    this._vastTracker.setPaused(false);\r\n  }\r\n  this._callEvent(this.EVENTS.AdPlaying);\r\n};\r\nAdsManager.prototype.onAdVideoComplete = function() {\r\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\r\n    this._vastTracker.complete();\r\n  }\r\n  this._callEvent(this.EVENTS.AdVideoComplete);\r\n};\r\nAdsManager.prototype.onAllAdsCompleted = function() {\r\n  this._callEvent(this.EVENTS.AllAdsCompleted);\r\n};\r\nAdsManager.prototype.onAdError = function(message) {\r\n\r\n  this._hasError = true;\r\n  /*\r\n  // Stop and clear timeouts, intervals\r\n  this.stopVASTMediaLoadTimeout();\r\n  this.stopVPAIDProgress();\r\n   */\r\n  this.abort();\r\n\r\n  if (this.EVENTS.AdError in this._eventCallbacks) {\r\n    this._eventCallbacks[this.EVENTS.AdError](typeof message !== 'object' ? new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](message) : message);\r\n  }\r\n};\r\nAdsManager.prototype.onAdLog = function(message) {\r\n  if (this.EVENTS.AdLog in this._eventCallbacks) {\r\n    this._eventCallbacks[this.EVENTS.AdLog](message);\r\n  }\r\n};\r\nAdsManager.prototype.processVASTResponse = function(res) {\r\n \r\n  const ads = res.ads;\r\n  if(ads.length != 0) {\r\n\r\n    if(ads.length > 1) {\r\n      // Ad pod\r\n      this._isAdPod = true;\r\n      console.log('ads', ads);\r\n      // Filter by sequence\r\n      this._adPod = ads.sort(function(a, b) {\r\n        const aSequence = a.sequence;\r\n        const bSequence = b.sequence;\r\n        if (aSequence === bSequence) {\r\n          return 0;\r\n        } else if (aSequence === null) {\r\n          return 1;\r\n        } else if (bSequence === null) {\r\n          return -1;\r\n        }\r\n        return (aSequence < bSequence) ? -1 : (aSequence > bSequence) ? 1 : 0;\r\n      });\r\n\r\n      // Shift from adPod array\r\n      this._ad = this._adPod.shift();\r\n    } else {\r\n      // Ad\r\n      this._ad = ads[0];\r\n    }\r\n\r\n    // Process ad\r\n    this._processAd();\r\n\r\n  } else {\r\n    // The VAST response document is empty.\r\n    this.onAdError(this.ERRORS.VAST_EMPTY_RESPONSE);\r\n  }\r\n};\r\nAdsManager.prototype.requestAds = function(vastUrl, options = {}) {\r\n \r\n  \r\n  if(this._isDestroyed) {\r\n    return;\r\n  }\r\n\r\n  // Generate request Id\r\n  this._requestId = new Date().getTime();\r\n\r\n  // Assign options\r\n  Object.assign(this._options, options);\r\n\r\n  // VAST options\r\n  // timeout: Number - A custom timeout for the requests (default 120000 ms)\r\n  // withCredentials: Boolean - A boolean to enable the withCredentials options for the XHR URLHandler (default false)\r\n  // wrapperLimit: Number - A number of Wrapper responses that can be received with no InLine response (default 10)\r\n  // resolveAll: Boolean - Allows you to parse all the ads contained in the VAST or to parse them ad by ad or adPod by adPod (default true)\r\n  // allowMultipleAds: Boolean - A Boolean value that identifies whether multiple ads are allowed in the requested VAST response. This will override any value of allowMultipleAds attribute set in the VAST\r\n  // followAdditionalWrappers: Boolean - a Boolean value that identifies whether subsequent Wrappers after a requested VAST response is allowed. This will override any value of followAdditionalWrappers attribute set in the VAST\r\n  const vastOptions = {\r\n    timeout: this._options.vastLoadTimeout,\r\n    withCredentials: this._options.withCredentials,\r\n    wrapperLimit: this._options.wrapperLimit,\r\n    resolveAll: this._options.resolveAll\r\n  };\r\n\r\n  // Abort\r\n  this.abort();\r\n\r\n  // Check if vastUrl exists\r\n  if(vastUrl && typeof vastUrl === 'string') {\r\n\r\n    let isURL = false;\r\n    try {\r\n      new URL(vastUrl);\r\n      isURL = true;\r\n    } catch (e) {}\r\n\r\n    if (isURL) {\r\n      // use VAST URL\r\n      this._vastClient = new _dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0__.VASTClient();\r\n      this._vastClient\r\n        .get(vastUrl, vastOptions)\r\n        .then(res => {\r\n          this.processVASTResponse(res);\r\n        })\r\n        .catch(err => {\r\n          this.onAdError(err.message);\r\n        });\r\n    } else {\r\n      // use VAST XML\r\n      const vastXml = (new window.DOMParser()).parseFromString(vastUrl, 'text/xml');\r\n      this._vastParser = new _dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0__.VASTParser();\r\n      this._vastParser\r\n        .parseVAST(vastXml, vastOptions)\r\n        .then(res => {\r\n          this.processVASTResponse(res);\r\n        })\r\n        .catch(err => {\r\n          this.onAdError(err.message);\r\n        });\r\n    }\r\n  } else {\r\n    this.onAdError('VAST URL/XML is empty');\r\n  }\r\n};\r\nAdsManager.prototype.canPlayVideoType = function(mimeType) {\r\n  if(mimeType === 'video/3gpp' && this.supportsThreeGPVideo()) {\r\n    return true;\r\n  } else if(mimeType === 'video/webm' && this.supportsWebmVideo()) {\r\n    return true;\r\n  } else if(mimeType === 'video/ogg' && this.supportsOggTheoraVideo()) {\r\n    return true;\r\n  } else if(mimeType === 'video/mp4' && this.supportsH264BaselineVideo()) {\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\nAdsManager.prototype.supportsVideo = function() {\r\n  return !!document.createElement('video').canPlayType;\r\n};\r\nAdsManager.prototype.supportsH264BaselineVideo = function() {\r\n  if(!this.supportsVideo()) return false;\r\n  return document.createElement('video').canPlayType('video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"');\r\n};\r\nAdsManager.prototype.supportsOggTheoraVideo = function() {\r\n  if(!this.supportsVideo()) return false;\r\n  return document.createElement('video').canPlayType('video/ogg; codecs=\"theora, vorbis\"');\r\n};\r\nAdsManager.prototype.supportsWebmVideo = function() {\r\n  if(!this.supportsVideo()) return false;\r\n  return document.createElement('video').canPlayType('video/webm; codecs=\"vp8, vorbis\"');\r\n};\r\nAdsManager.prototype.supportsThreeGPVideo = function() {\r\n  if(!this.supportsVideo()) return false;\r\n  return document.createElement('video').canPlayType('video/3gpp; codecs=\"mp4v.20.8, samr\"');\r\n};\r\nAdsManager.prototype.handshakeVersion = function(version) {\r\n  return this._vpaidCreative.handshakeVersion(version);\r\n};\r\nAdsManager.prototype._isCreativeFunctionInvokable = function(a) {\r\n  return this._vpaidCreative ? (a = this._vpaidCreative[a]) && typeof a === 'function' : false;\r\n};\r\nAdsManager.prototype.checkVPAIDInterface = function(a) {\r\n  const b = { passed: true, missingInterfaces: ''};\r\n  for (let d = a.length - 1; 0 <= d; d--)\r\n    this._isCreativeFunctionInvokable(a[d]) || (b.passed = false, b.missingInterfaces += `${a[d] } `);\r\n  return b;\r\n};\r\nAdsManager.prototype.setCallbacksForCreative = function(eventCallbacks, context) {\r\n  for (const event in eventCallbacks) eventCallbacks.hasOwnProperty(event) && this._vpaidCreative.subscribe(eventCallbacks[event], event, context)\r\n};\r\nAdsManager.prototype.removeCallbacksForCreative = function(eventCallbacks) {\r\n  if(this._vpaidCreative !== null) {\r\n    for (const event in eventCallbacks) {\r\n      eventCallbacks.hasOwnProperty(event) && this._vpaidCreative.unsubscribe(event); // && this._vpaidCreative.unsubscribe(eventCallbacks[event], event);\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.creativeAssetLoaded = function() {\r\n  const checkVPAIDMinVersion = () => {\r\n    const c = this.handshakeVersion(this.MIN_VPAID_VERSION.toFixed(1));\r\n    return c ? parseFloat(c) < this.MIN_VPAID_VERSION ? (this.onAdError(`Only support creatives with VPAID version >= ${ this.MIN_VPAID_VERSION.toFixed(1)}`), !1) : !0 : (this.onAdError('Cannot get VPAID version from the creative'), !1)\r\n  };\r\n  if (function(that) {\r\n    const c = that.checkVPAIDInterface('handshakeVersion initAd startAd stopAd subscribe unsubscribe getAdLinear'.split(' '));\r\n    c.passed || that.onAdError(`Missing interfaces in the VPAID creative: ${ c.missingInterfaces}`);\r\n    return c.passed\r\n  }(this) && checkVPAIDMinVersion()) {\r\n\r\n\r\n    // VPAID events\r\n    this._creativeEventCallbacks = {\r\n      AdStarted: this.onAdStarted.bind(this),\r\n      AdStopped: this.onAdStopped.bind(this),\r\n      AdSkipped: this.onAdSkipped.bind(this),\r\n      AdLoaded:  this.onAdLoaded.bind(this),\r\n      //AdLinearChange: this.onAdLinearChange,\r\n      AdSizeChange: this.onAdSizeChange.bind(this),\r\n      //AdExpandedChange: this.onAdExpandedChange,\r\n      AdDurationChange: this.onAdDurationChange.bind(this),\r\n      AdVolumeChange: this.onAdVolumeChange.bind(this),\r\n      AdImpression: this.onAdImpression.bind(this),\r\n      AdClickThru: this.onAdClickThru.bind(this),\r\n      //AdInteraction: this.onAdInteraction,\r\n      AdVideoStart: this.onAdVideoStart.bind(this),\r\n      AdVideoFirstQuartile: this.onAdVideoFirstQuartile.bind(this),\r\n      AdVideoMidpoint: this.onAdVideoMidpoint.bind(this),\r\n      AdVideoThirdQuartile: this.onAdVideoThirdQuartile.bind(this),\r\n      AdVideoComplete: this.onAdVideoComplete.bind(this),\r\n      //AdUserAcceptInvitation: this.onAdUserAcceptInvitation,\r\n      //AdUserMinimize: this.onAdUserMinimize,\r\n      //AdUserClose: this.onAdUserClose,\r\n      AdPaused: this.onAdPaused.bind(this),\r\n      AdPlaying: this.onAdPlaying.bind(this), // onAdResumed\r\n      AdError: this.onAdError.bind(this),\r\n      AdLog: this.onAdLog.bind(this)\r\n    }\r\n\r\n    // Subscribe for VPAID events\r\n    this.setCallbacksForCreative(this._creativeEventCallbacks, this);\r\n\r\n    // Prepare for iniAd\r\n    const width = this._attributes.width;\r\n    const height = this._attributes.height;\r\n    const creativeData = {\r\n      AdParameters: this._creative.adParameters\r\n    };\r\n\r\n    const slotInIframe = this._vpaidIframe.contentDocument.querySelector('#slot');\r\n\r\n    slotInIframe.setAttribute('style', 'width:' + width + 'px; height:'+height+'px');\r\n\r\n    const environmentVars = {\r\n      slot: slotInIframe,\r\n      videoSlot: this._videoSlot,\r\n      videoSlotCanAutoPlay: true\r\n    };\r\n\r\n    // iniAd(width, height, viewMode, desiredBitrate, creativeData, environmentVars)\r\n    // Start loadVideoTimeout\r\n    this.startVASTMediaLoadTimeout();\r\n\r\n\r\n    try {\r\n\r\n      this._vpaidCreative.initAd(width, height, this._attributes.viewMode, this._attributes.desiredBitrate, creativeData, environmentVars);\r\n\r\n    } catch(err) {\r\n      this.onAdError(err);\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.handleLoadCreativeMessage = function(msg) {\r\n  if (msg && msg.data) {\r\n    const match = String(msg.data).match(new RegExp(`adm:${ this._requestId }://(.*)`));\r\n    if (match) {\r\n      console.log('vpaid creative message', match);\r\n      const value = JSON.parse(match[1]);\r\n      if(value == 'load') {\r\n        console.log('vpaid message load', this._requestId);\r\n        try {\r\n          let VPAIDAd = this._vpaidIframe.contentWindow.getVPAIDAd;\r\n          if (VPAIDAd && typeof VPAIDAd === 'function') {\r\n            VPAIDAd = VPAIDAd();\r\n            console.log('vpaid', typeof VPAIDAd);\r\n            typeof VPAIDAd === 'undefined'\r\n              ? this.onAdError('getVPAIDAd() returns undefined value')\r\n              : VPAIDAd == null\r\n                ? this.onAdError('getVPAIDAd() returns null')\r\n                : ((this._vpaidCreative = VPAIDAd),\r\n                  this.creativeAssetLoaded());\r\n          } else {\r\n            this.onAdError('getVPAIDAd() is undefined');\r\n          }\r\n        } catch (e) {\r\n          this.onAdError(e);\r\n        }\r\n      } else if (value == 'error') {\r\n        this.onAdError('Error load VPAID');\r\n      }\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.loadCreativeAsset = function(fileURL) {\r\n \r\n  console.log('vpaid creative asset', fileURL);\r\n  window.addEventListener('message', this._handleLoadCreativeMessage);\r\n\r\n  // Create iframe\r\n  this._vpaidIframe = document.createElement('iframe');\r\n  this._vpaidIframe.style.position = 'absolute';\r\n  this._vpaidIframe.style.width = '100%';\r\n  this._vpaidIframe.style.height = '100%';\r\n  this._vpaidIframe.style.left = '0px';\r\n  this._vpaidIframe.style.right = '0px';\r\n  this._vpaidIframe.style.border= 'none';\r\n  \r\n  console.log(this._videoSlot.clientHeight);\r\n\r\n  // Append iframe\r\n  this._adContainer.appendChild(this._vpaidIframe);\r\n\r\n  // Open iframe, write and close\r\n  this._vpaidIframe.contentWindow.document.open();\r\n  this._vpaidIframe.contentWindow.document.write(`\r\n<script>function sendMessage(msg) {\r\n  var postMsg = 'adm:${this._requestId}://' + JSON.stringify(msg);\r\n  window.parent.postMessage(postMsg, '*');\r\n} \\x3c/script>\r\n<script type=\"text/javascript\" onload=\"sendMessage('load')\" onerror=\"sendMessage('error')\" src=\"${fileURL}\"> \\x3c/script>\r\n<body style=\"margin: 0px; padding:0px; height: 100%; overflow: hidden; background: transparent;\"><div id=\"slot\" style=\"position: absolute; left:0px; right:0px; z-index: 1000\"></div></body>\r\n`\r\n);\r\n  this._vpaidIframe.contentWindow.document.close();\r\n};\r\nAdsManager.prototype.removeCreativeAsset = function() {\r\n  // Remove VPAID iframe\r\n  console.log('remove vpaid iframe');\r\n  if(this._vpaidIframe) {\r\n    this._vpaidIframe.parentNode.removeChild(this._vpaidIframe);\r\n  }\r\n\r\n  // Remove 3rd-party HTML elements from the slot\r\n  console.log('remove 3rd-party HTML elements from the slot');\r\n  [...this._slot.children]\r\n    .forEach(child => {\r\n      console.log(child !== this._videoSlot);\r\n      child !== this._videoSlot ? this._slot.removeChild(child) : null\r\n    });\r\n};\r\nAdsManager.prototype._removeHandlers = function() {\r\n  // Remove event listeners from slot\r\n  this._slot.removeEventListener('click', this._handleSlotClick);\r\n\r\n  // Remove event listeners from video slot\r\n  this._videoSlot.removeEventListener('error', this._handleVideoSlotError, false);\r\n  this._videoSlot.removeEventListener('canplay', this._handleVideoSlotCanPlay);\r\n  this._videoSlot.removeEventListener('volumechange', this._handleVideoSlotVolumeChange);\r\n  this._videoSlot.removeEventListener('timeupdate', this._handleVideoSlotTimeUpdate, true);\r\n  this._videoSlot.removeEventListener('loadedmetadata', this._handleVideoSlotLoadedMetaData);\r\n  this._videoSlot.removeEventListener('ended', this._handleVideoSlotEnded);\r\n};\r\nAdsManager.prototype._abort = function() {\r\n  // Abort\r\n  this.abort();\r\n  // Dispatch AllAdsCompleted\r\n  this.onAllAdsCompleted();\r\n};\r\nAdsManager.prototype.isCreativeExists = function() {\r\n  return this._creative && this._creative.mediaFiles.length != 0;\r\n};\r\nAdsManager.prototype.handleSlotClick = function() {\r\n  if(!this._isVPAID && this._vastTracker) {\r\n    this._vastTracker.click();\r\n  }\r\n};\r\nAdsManager.prototype.handleVideoSlotError = function() {\r\n  this.onAdError(this.ERRORS.VIDEO_PLAY_ERROR);\r\n};\r\nAdsManager.prototype.handleVideoSlotCanPlay = function() {\r\n  console.log('video slot can play...');\r\n};\r\nAdsManager.prototype.handleVideoSlotVolumeChange = function(event) {\r\n  this._vastTracker && this._vastTracker.setMuted(event.target.muted);\r\n};\r\nAdsManager.prototype.handleVideoSlotTimeUpdate = function(event) {\r\n  if(this.isCreativeExists()) {\r\n\r\n    if (this._nextQuartileIndex >= this._quartileEvents.length) {\r\n      return;\r\n    }\r\n\r\n    const percentPlayed = event.target.currentTime * 100.0 / event.target.duration;\r\n    if (percentPlayed >= this._quartileEvents[this._nextQuartileIndex].value) {\r\n      const lastQuartileEvent = this._quartileEvents[this._nextQuartileIndex].event;\r\n      this._defaultEventCallbacks[lastQuartileEvent]();\r\n      this._nextQuartileIndex += 1;\r\n    }\r\n\r\n    if (percentPlayed >= 0) {\r\n      if (!this._hasImpression) {\r\n        this._vastTracker && this._vastTracker.trackImpression();\r\n        this._hasImpression = true;\r\n      }\r\n    }\r\n    this._vastTracker && this._vastTracker.setProgress(event.target.currentTime);\r\n    if (event.target.duration > 0) {\r\n      this._attributes.remainingTime = event.target.duration - event.target.currentTime;\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.handleVideoSlotLoadedMetaData = function(event) {\r\n  this._attributes.duration = event.target.duration;\r\n  // Update tracking duration with real media meta data\r\n  this._vastTracker && this._vastTracker.setDuration(event.target.duration);\r\n  //if(!this._isVPAID) {\r\n  this.onAdDurationChange();\r\n  //}\r\n};\r\nAdsManager.prototype.handleVideoSlotEnded = function() {\r\n  // Complete\r\n  this._vastTracker && this._vastTracker.complete();\r\n  //setTimeout(() => {\r\n  this.onAdStopped();\r\n  //}, 75);\r\n};\r\n\r\nAdsManager.prototype.checkOnSkippable = function(){\r\n  return this._creative?.trackingEvents?.skip?.length > 0\r\n}\r\n\r\nAdsManager.prototype._processAd = function(isNext = false) {\r\n\r\n  // Filter linear creatives, get first\r\n  this._creative = this._ad.creatives.filter(creative => creative.type === 'linear')[0];\r\n  // Check if creative has media files\r\n  if(this._creative) {\r\n\r\n    if(this._creative.mediaFiles.length != 0) {\r\n      // Filter and check media files for mime type canPlay and if VPAID or not\r\n      this._mediaFiles = this._creative.mediaFiles.filter(mediaFile => {\r\n        // mime types -> mp4, webm, ogg, 3gp\r\n        if(this.canPlayVideoType(mediaFile.mimeType)) {\r\n          return mediaFile;\r\n        } else if(mediaFile.mimeType === 'application/javascript') {\r\n          // apiFramework -> mime type -> application/javascript\r\n          return mediaFile;\r\n        }\r\n      });//[0]; // take the first one\r\n\r\n      // Sort media files by size\r\n      this._mediaFiles.sort(function(a, b) {\r\n        const aHeight = a.height;\r\n        const bHeight = b.height;\r\n        return (aHeight < bHeight) ? -1 : (aHeight > bHeight) ? 1 : 0;\r\n      });\r\n\r\n      if(this._mediaFiles && this._mediaFiles.length != 0) {\r\n        // Initialize VASTTracker for tracking events\r\n        this._vastTracker = new _dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0__.VASTTracker(null, this._ad, this._creative);\r\n        this._vastTracker.load();\r\n\r\n\r\n        if(!isNext) {\r\n          // If not VPAID dispatch AdsManagerLoaded event -> ad is ready for init\r\n          this.onAdsManagerLoaded();\r\n        } else {\r\n          this.init(this._attributes.width, this._attributes.height, this._attributes.viewMode, isNext);\r\n        }\r\n      } else {\r\n        // Linear assets were found in the VAST ad response, but none of them match the video player's capabilities.\r\n        this.onAdError(this.ERRORS.VAST_LINEAR_ASSET_MISMATCH);\r\n      }\r\n\r\n    } else {\r\n      // No assets were found in the VAST ad response.\r\n      this.onAdError(this.ERRORS.VAST_ASSET_NOT_FOUND);\r\n    }\r\n  } else {\r\n    // Non-Linear\r\n    console.log('non linear');\r\n    this.onAdError('non linear');\r\n  }\r\n};\r\nAdsManager.prototype._nextAd = function() {\r\n  // Shift next ad\r\n  this._ad = this._adPod.shift();\r\n  console.log('next ad', this._ad);\r\n  // Process ad\r\n  this._processAd(true);\r\n};\r\nAdsManager.prototype.init = function(width, height, viewMode, isNext = false) {\r\n\r\n  console.log('init....');\r\n\r\n  if(this._isDestroyed) {\r\n    return;\r\n  }\r\n\r\n  if(this.isCreativeExists()) {\r\n\r\n    if(!isNext) {\r\n      if (this._options.muted) {\r\n        this._videoSlot.muted = true;\r\n        this._videoSlot.volume = 0;\r\n      }\r\n    }\r\n\r\n    // Find the best resolution for mediaFile\r\n    this._mediaFileIndex = this._mediaFiles.findIndex(function(item) {\r\n      return item.height >= height\r\n    });\r\n\r\n    if(this._mediaFileIndex != -1) {\r\n      this._mediaFile = this._mediaFiles[this._mediaFileIndex];\r\n    } else {\r\n      // Get the last from array\r\n      this._mediaFile = this._mediaFiles[this._mediaFiles.length - 1];\r\n    }\r\n\r\n    if(this._mediaFile) {\r\n      // Check if VPAID\r\n      if (this._mediaFile.mimeType === 'application/javascript') {\r\n        this._isVPAID = true;\r\n      }\r\n\r\n      this._attributes.width = width;\r\n      this._attributes.height = height;\r\n      this._attributes.viewMode = viewMode;\r\n\r\n      // Resize slot\r\n      this.resizeSlot(this._attributes.width, this._attributes.height);\r\n\r\n      this._videoSlot.addEventListener('error', this._handleVideoSlotError, false);\r\n\r\n      if(this._isVPAID) {\r\n        // VPAID\r\n        this.loadCreativeAsset(this._mediaFile.fileURL);\r\n      } else {\r\n\r\n        // VAST\r\n        this._slot.addEventListener('click', this._handleSlotClick);\r\n\r\n        // Ad video slot event listeners\r\n        this._videoSlot.addEventListener('canplay', this._handleVideoSlotCanPlay);\r\n        this._videoSlot.addEventListener('volumechange', this._handleVideoSlotVolumeChange);\r\n        this._videoSlot.addEventListener('timeupdate', this._handleVideoSlotTimeUpdate, true);\r\n        this._videoSlot.addEventListener('loadedmetadata', this._handleVideoSlotLoadedMetaData);\r\n        this._videoSlot.addEventListener('ended', this._handleVideoSlotEnded);\r\n\r\n        // Set video slot src\r\n        this._videoSlot.setAttribute('src', this._mediaFile.fileURL);\r\n\r\n        // Ad Loaded\r\n        this.onAdLoaded();\r\n      }\r\n\r\n      // Tracking\r\n      if(this._vastTracker) {\r\n\r\n        this._vastTracker.on('clickthrough', (url) => {\r\n          if (!this._isVPAID) {\r\n            this.onAdClickThru(url);\r\n          }\r\n\r\n          // Open the resolved clickThrough url\r\n          const opener = window.open(url, '_blank');\r\n          void 0 !== opener ? opener.focus() : window.location.href = url;\r\n        });\r\n\r\n      }\r\n\r\n    } else {\r\n      // console.log('media file not found');\r\n    }\r\n\r\n  } /* else {\r\n    this.onAdError('');\r\n  }*/\r\n};\r\nAdsManager.prototype.start = function() {\r\n  if(this.isCreativeExists()) {\r\n\r\n    // Override play function\r\n    // Backup origin play function\r\n    const _play = this._videoSlot.play;\r\n    const maxPlayRetries = 3;\r\n    let playRetries = 0;\r\n    this._videoSlot.play = function() {\r\n      //this.muted = true;\r\n      // Apply origin play, and connect to play Promise to detect autoplay exceptions\r\n      const _playPromise = _play.apply(this, [].slice.call(arguments));\r\n      if(_playPromise instanceof Promise) {\r\n        _playPromise.then(_=> {\r\n          // Autoplay worked!\r\n          console.log('autoplay worked!!!', this);\r\n        }).catch(err => {\r\n          // Autoplay failed\r\n          if(playRetries <= maxPlayRetries) {\r\n            // Try to play as muted if failed in autoplay\r\n            console.log('autoplay failed > play retries', playRetries);\r\n            this.muted = true;\r\n            this.play();\r\n\r\n            playRetries++;\r\n          }\r\n        });\r\n      }\r\n      return _playPromise;\r\n    };\r\n\r\n    if (this._isVPAID) {\r\n      this._isCreativeFunctionInvokable('startAd') && this._vpaidCreative.startAd();\r\n    } else {\r\n\r\n      //this._videoSlot.autoplay = true;\r\n      this._videoSlot.load();\r\n      this._videoSlot.play();\r\n\r\n      this.onAdStarted();\r\n\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.getDuration = function() {\r\n  return this.isCreativeExists() && this._attributes.duration;\r\n};\r\nAdsManager.prototype.pause = function() {\r\n  if(this.isCreativeExists()) {\r\n    if (this._isVPAID) {\r\n      this._isCreativeFunctionInvokable('pauseAd') && this._vpaidCreative.pauseAd();\r\n    } else {\r\n      this._videoSlot.pause();\r\n      this.onAdPaused();\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.resume = function() {\r\n  if(this.isCreativeExists()) {\r\n    if (this._isVPAID) {\r\n      this._isCreativeFunctionInvokable('resumeAd') && this._vpaidCreative.resumeAd();\r\n    } else {\r\n      this._videoSlot.play();\r\n      this.onAdPlaying();\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.stop = function() {\r\n  if(this.isCreativeExists()) {\r\n    if (this._isVPAID) {\r\n      this._isCreativeFunctionInvokable('stopAd') && this._vpaidCreative.stopAd();\r\n    } else {\r\n      this.onAdStopped();\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.skip = function() {\r\n  if(this.isCreativeExists()) {\r\n    if (this._isVPAID) {\r\n      this._isCreativeFunctionInvokable('skipAd') && this._vpaidCreative.skipAd();\r\n    } else {\r\n      this.onAdSkipped();\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.resize = function(width, height, viewMode) {\r\n  if(this.isCreativeExists()) {\r\n\r\n    this._attributes.width = width;\r\n    this._attributes.height = height;\r\n    this._attributes.viewMode = viewMode;\r\n\r\n    // Resize slot\r\n    this.resizeSlot(this._attributes.width, this._attributes.height);\r\n\r\n    if (this._isVPAID) {\r\n      this._isCreativeFunctionInvokable('resizeAd') && this._vpaidCreative.resizeAd(width, height, viewMode);\r\n    } else {\r\n      this.onAdSizeChange();\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.getVolume = function() {\r\n  if(this.isCreativeExists()) {\r\n    if (this._isVPAID) {\r\n      return this._isCreativeFunctionInvokable('getAdVolume') ? this._vpaidCreative.getAdVolume() : -1;\r\n    }\r\n    // on iOS the video slot volume is always 1 even if the video slot is muted,\r\n    // if video slot is muted, return 0, otherwise volume\r\n    return this._videoSlot.muted ? 0 : this._videoSlot.volume;\r\n  }\r\n};\r\nAdsManager.prototype.setVolume = function(volume) {\r\n  if(this.isCreativeExists()) {\r\n    if (this._isVPAID) {\r\n      this._isCreativeFunctionInvokable('setAdVolume') && this._vpaidCreative.setAdVolume(volume);\r\n    }\r\n    const isVolumeChanged = volume !== this.getVolume();\r\n    this._attributes.volume = volume;\r\n    if(this._attributes.volume !== 0) {\r\n      this._videoSlot.muted = false;\r\n    } else {\r\n      this._videoSlot.muted = true;\r\n    }\r\n    this._videoSlot.volume = this._attributes.volume;\r\n    if(isVolumeChanged) {\r\n      this.onAdVolumeChange();\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.getRemainingTime = function() {\r\n  if(this.isCreativeExists()) {\r\n    if (this._isVPAID) {\r\n      return this._isCreativeFunctionInvokable('getAdRemainingTime') ? this._vpaidCreative.getAdRemainingTime() : -1\r\n    }\r\n    return this._attributes.remainingTime;\r\n  }\r\n};\r\nAdsManager.prototype.collapse = function() {\r\n  if(this.isCreativeExists()) {\r\n    if(this._isVPAID) {\r\n      this._isCreativeFunctionInvokable('collapseAd') && this._vpaidCreative.collapseAd();\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.expand = function() {\r\n  if(this.isCreativeExists()) {\r\n    if(this._isVPAID) {\r\n      this._isCreativeFunctionInvokable('expandAd') && this._vpaidCreative.expandAd();\r\n    }\r\n  }\r\n};\r\nAdsManager.prototype.abort = function() {\r\n\r\n  if(this._isDestroyed) {\r\n    return;\r\n  }\r\n\r\n  // Removes ad assets loaded at runtime that need to be properly removed at the time of ad completion\r\n  // and stops the ad and all tracking.\r\n  window.removeEventListener('message', this._handleLoadCreativeMessage);\r\n\r\n  // Stop and clear timeouts, intervals\r\n  this.stopVASTMediaLoadTimeout();\r\n  this.stopVPAIDProgress();\r\n\r\n  if(this._isVPAID) {\r\n    // Unsubscribe for VPAID events\r\n    this.removeCallbacksForCreative(this._creativeEventCallbacks);\r\n    this.removeCreativeAsset();\r\n  }\r\n\r\n  // Reset global variables to default values\r\n  this._nextQuartileIndex = 0;\r\n\r\n  this._isVPAID = false;\r\n\r\n  this._hasLoaded = false;\r\n  this._hasError = false;\r\n  this._hasImpression = false;\r\n  this._hasStarted = false;\r\n\r\n  this._ad = null;\r\n  this._adPod = null;\r\n  this._isAdPod = false;\r\n\r\n  this._creative = null;\r\n  this._mediaFile = null;\r\n  this._vpaidCreative = null;\r\n  this._vastTracker = null;\r\n\r\n  // Remove handlers from slot and videoSlot\r\n  this._removeHandlers();\r\n\r\n  // Pause video slot, and remove src\r\n  this._videoSlot.pause();\r\n  this._videoSlot.removeAttribute('src'); // empty source\r\n  this._videoSlot.load();\r\n\r\n  // Hide slot\r\n  this.hideSlot();\r\n\r\n};\r\nAdsManager.prototype.destroy = function() {\r\n\r\n  if(this._isDestroyed) {\r\n    return;\r\n  }\r\n\r\n  // Cleans up the internal state, abort anything that is currently doing on with the AdsManager\r\n  // and reset to a default state.\r\n\r\n  // Reset the internal state of AdsManager\r\n  this.abort();\r\n  // Remove event listeners\r\n  this.removeEventListeners(this._eventCallbacks);\r\n  // Remove slot element from the DOM\r\n  this.removeSlot();\r\n\r\n  this._adContainer = null;\r\n  this._slot = null;\r\n  this._videoSlot = null;\r\n\r\n  this._isDestroyed = true;\r\n\r\n};\r\nAdsManager.prototype.isDestroyed = function() {\r\n  return this._isDestroyed;\r\n};\r\nAdsManager.prototype.getVersion = function() {\r\n  return this._attributes.version;\r\n};\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AdsManager);\r\n\n\n//# sourceURL=webpack://adserve/./src/ads-manager.js?");

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"tv\": () => (/* binding */ tv)\n/* harmony export */ });\n/* harmony import */ var _ads_manager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ads-manager.js */ \"./src/ads-manager.js\");\n\r\n\r\nconst tv = {\r\n  AdsManager: _ads_manager_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n}\r\n\r\n\r\n\r\n\n\n//# sourceURL=webpack://adserve/./src/index.js?");

/***/ }),

/***/ "./src/utils.js":
/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"format\": () => (/* binding */ format)\n/* harmony export */ });\nfunction format(message, ...values) {\r\n  try {\r\n    values.forEach((value, key) => {\r\n      message = message.replace(\r\n        new RegExp('\\\\{' + key + '}', 'g'),\r\n        value\r\n      )\r\n    });\r\n  } catch (e) {}\r\n  return message\r\n}\r\n\r\n\r\n\n\n//# sourceURL=webpack://adserve/./src/utils.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.js");
/******/ 	adserve = __webpack_exports__;
/******/ 	
/******/ })()
;