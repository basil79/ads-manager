/*!
 * ads-manager v1.1.6 development
 * Updated : 2022-09-21
 */
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
var adserve;
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/@dailymotion/vast-client/dist/vast-client.min.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@dailymotion/vast-client/dist/vast-client.min.js ***!
  \***********************************************************************/
/***/ (function(__unused_webpack_module, exports) {

eval("!function(e,t){ true?t(exports):0}(this,(function(e){\"use strict\";function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function r(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?t(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e){return i=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},i(e)}function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function a(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,\"prototype\",{writable:!1}),e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&c(e,t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function d(e,t){if(t&&(\"object\"==typeof t||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(e)}function p(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=u(e);if(t){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return d(this,r)}}function h(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||function(e,t){if(!e)return;if(\"string\"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adId:e.adId||null,sequence:e.sequence||null,apiFramework:e.apiFramework||null,universalAdIds:[],creativeExtensions:[]}}var m=[\"ADCATEGORIES\",\"ADCOUNT\",\"ADPLAYHEAD\",\"ADSERVINGID\",\"ADTYPE\",\"APIFRAMEWORKS\",\"APPBUNDLE\",\"ASSETURI\",\"BLOCKEDADCATEGORIES\",\"BREAKMAXADLENGTH\",\"BREAKMAXADS\",\"BREAKMAXDURATION\",\"BREAKMINADLENGTH\",\"BREAKMINDURATION\",\"BREAKPOSITION\",\"CLICKPOS\",\"CLICKTYPE\",\"CLIENTUA\",\"CONTENTID\",\"CONTENTPLAYHEAD\",\"CONTENTURI\",\"DEVICEIP\",\"DEVICEUA\",\"DOMAIN\",\"EXTENSIONS\",\"GDPRCONSENT\",\"IFA\",\"IFATYPE\",\"INVENTORYSTATE\",\"LATLONG\",\"LIMITADTRACKING\",\"MEDIAMIME\",\"MEDIAPLAYHEAD\",\"OMIDPARTNER\",\"PAGEURL\",\"PLACEMENTTYPE\",\"PLAYERCAPABILITIES\",\"PLAYERSIZE\",\"PLAYERSTATE\",\"PODSEQUENCE\",\"REGULATIONS\",\"SERVERSIDE\",\"SERVERUA\",\"TRANSACTIONID\",\"UNIVERSALADID\",\"VASTVERSIONS\",\"VERIFICATIONVENDORS\"];function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[],n=A(e);for(var a in!t.ERRORCODE||r.isCustomCode||/^[0-9]{3}$/.test(t.ERRORCODE)||(t.ERRORCODE=900),t.CACHEBUSTING=E(Math.round(1e8*Math.random()).toString()),t.TIMESTAMP=(new Date).toISOString(),t.RANDOM=t.random=t.CACHEBUSTING,t)t[a]=b(t[a]);for(var o in n){var s=n[o];\"string\"==typeof s&&i.push(T(s,t))}return i}function T(e,t){var r=(e=y(e,t)).match(/[^[\\]]+(?=])/g);if(!r)return e;var i=r.filter((function(e){return m.indexOf(e)>-1}));return 0===i.length?e:y(e,i=i.reduce((function(e,t){return e[t]=-1,e}),{}))}function y(e,t){var r=e;for(var i in t){var n=t[i];r=r.replace(new RegExp(\"(?:\\\\[|%%)(\".concat(i,\")(?:\\\\]|%%)\"),\"g\"),n)}return r}function A(e){return Array.isArray(e)?e.map((function(e){return e&&e.hasOwnProperty(\"url\")?e.url:e})):e}function k(e,t){for(var r=0;r<t.length;r++)if(R(t[r],e))return!0;return!1}function R(e,t){if(e&&t){var r=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);return r.length===i.length&&(e.id===t.id&&e.url===t.url)}return!1}function b(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16))}))}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=String(e);return r.length<t?N(0,t-r.length,!1).map((function(){return\"0\"})).join(\"\")+r:r}function N(e,t,r){for(var i=[],n=e<t,a=r?n?t+1:t-1:t,o=e;n?o<a:o>a;n?o++:o--)i.push(o);return i}var L={track:function(e,t,r){g(e,t,r).forEach((function(e){\"undefined\"!=typeof window&&null!==window&&((new Image).src=e)}))},resolveURLTemplates:g,extractURLsFromTemplates:A,containsTemplateObject:k,isTemplateObjectEqual:R,encodeURIComponentRFC3986:b,replaceUrlMacros:T,leftpad:E,range:N,isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},flatten:function e(t){return t.reduce((function(t,r){return t.concat(Array.isArray(r)?e(r):r)}),[])},joinArrayOfUniqueTemplateObjs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Array.isArray(e)?e:[],i=Array.isArray(t)?t:[],n=r.concat(i);return n.reduce((function(e,t){return k(t,e)||e.push(t),e}),[])}};function w(e){return-1!==[\"true\",\"TRUE\",\"True\",\"1\"].indexOf(e)}var U={childByName:function(e,t){var r=e.childNodes;for(var i in r){var n=r[i];if(n.nodeName===t)return n}},childrenByName:function(e,t){var r=[],i=e.childNodes;for(var n in i){var a=i[n];a.nodeName===t&&r.push(a)}return r},resolveVastAdTagURI:function(e,t){if(!t)return e;if(0===e.indexOf(\"//\")){var r=location.protocol;return\"\".concat(r).concat(e)}if(-1===e.indexOf(\"://\")){var i=t.slice(0,t.lastIndexOf(\"/\"));return\"\".concat(i,\"/\").concat(e)}return e},parseBoolean:w,parseNodeText:function(e){return e&&(e.textContent||e.text||\"\").trim()},copyNodeAttribute:function(e,t,r){var i=t.getAttribute(e);i&&r.setAttribute(e,i)},parseAttributes:function(e){for(var t=e.attributes,r={},i=0;i<t.length;i++)r[t[i].nodeName]=t[i].nodeValue;return r},parseDuration:function(e){if(null==e)return-1;if(L.isNumeric(e))return parseInt(e);var t=e.split(\":\");if(3!==t.length)return-1;var r=t[2].split(\".\"),i=parseInt(r[0]);2===r.length&&(i+=parseFloat(\"0.\".concat(r[1])));var n=parseInt(60*t[1]),a=parseInt(60*t[0]*60);return isNaN(a)||isNaN(n)||isNaN(i)||n>3600||i>60?-1:a+n+i},splitVAST:function(e){var t=[],r=null;return e.forEach((function(i,n){if(i.sequence&&(i.sequence=parseInt(i.sequence,10)),i.sequence>1){var a=e[n-1];if(a&&a.sequence===i.sequence-1)return void(r&&r.push(i));delete i.sequence}r=[i],t.push(r)})),t},assignAttributes:function(e,t){if(e)for(var r in e){var i=e[r];if(i.nodeName&&i.nodeValue&&t.hasOwnProperty(i.nodeName)){var n=i.nodeValue;\"boolean\"==typeof t[i.nodeName]&&(n=w(n)),t[i.nodeName]=n}}},mergeWrapperAdData:function(e,t){e.errorURLTemplates=t.errorURLTemplates.concat(e.errorURLTemplates),e.impressionURLTemplates=t.impressionURLTemplates.concat(e.impressionURLTemplates),e.extensions=t.extensions.concat(e.extensions),t.viewableImpression.length>0&&(e.viewableImpression=[].concat(h(e.viewableImpression),h(t.viewableImpression))),e.followAdditionalWrappers=t.followAdditionalWrappers,e.allowMultipleAds=t.allowMultipleAds,e.fallbackOnNoAd=t.fallbackOnNoAd;var r=(t.creatives||[]).filter((function(e){return e&&\"companion\"===e.type})),i=r.reduce((function(e,t){return(t.variations||[]).forEach((function(t){(t.companionClickTrackingURLTemplates||[]).forEach((function(t){L.containsTemplateObject(t,e)||e.push(t)}))})),e}),[]);e.creatives=r.concat(e.creatives);var n=t.videoClickTrackingURLTemplates&&t.videoClickTrackingURLTemplates.length,a=t.videoCustomClickURLTemplates&&t.videoCustomClickURLTemplates.length;e.creatives.forEach((function(e){if(t.trackingEvents&&t.trackingEvents[e.type])for(var r in t.trackingEvents[e.type]){var o=t.trackingEvents[e.type][r];Array.isArray(e.trackingEvents[r])||(e.trackingEvents[r]=[]),e.trackingEvents[r]=e.trackingEvents[r].concat(o)}\"linear\"===e.type&&(n&&(e.videoClickTrackingURLTemplates=e.videoClickTrackingURLTemplates.concat(t.videoClickTrackingURLTemplates)),a&&(e.videoCustomClickURLTemplates=e.videoCustomClickURLTemplates.concat(t.videoCustomClickURLTemplates)),!t.videoClickThroughURLTemplate||null!==e.videoClickThroughURLTemplate&&void 0!==e.videoClickThroughURLTemplate||(e.videoClickThroughURLTemplate=t.videoClickThroughURLTemplate)),\"companion\"===e.type&&i.length&&(e.variations||[]).forEach((function(e){e.companionClickTrackingURLTemplates=L.joinArrayOfUniqueTemplateObjs(e.companionClickTrackingURLTemplates,i)}))})),t.adVerifications&&(e.adVerifications=e.adVerifications.concat(t.adVerifications)),t.blockedAdCategories&&(e.blockedAdCategories=e.blockedAdCategories.concat(t.blockedAdCategories))}};function C(e,t){var r=function(){var e=f(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),t=e.id,r=e.adId,i=e.sequence,n=e.apiFramework;return{id:t,adId:r,sequence:i,apiFramework:n,type:\"companion\",required:null,variations:[]}}(t);return r.required=e.getAttribute(\"required\")||null,r.variations=U.childrenByName(e,\"Companion\").map((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adType:\"companionAd\",width:e.width||0,height:e.height||0,assetWidth:e.assetWidth||null,assetHeight:e.assetHeight||null,expandedWidth:e.expandedWidth||null,expandedHeight:e.expandedHeight||null,apiFramework:e.apiFramework||null,adSlotID:e.adSlotID||null,pxratio:e.pxratio||\"1\",renderingMode:e.renderingMode||\"default\",staticResources:[],htmlResources:[],iframeResources:[],adParameters:null,xmlEncoded:null,altText:null,companionClickThroughURLTemplate:null,companionClickTrackingURLTemplates:[],trackingEvents:{}}}(U.parseAttributes(e));t.htmlResources=U.childrenByName(e,\"HTMLResource\").reduce((function(e,t){var r=U.parseNodeText(t);return r?e.concat(r):e}),[]),t.iframeResources=U.childrenByName(e,\"IFrameResource\").reduce((function(e,t){var r=U.parseNodeText(t);return r?e.concat(r):e}),[]),t.staticResources=U.childrenByName(e,\"StaticResource\").reduce((function(e,t){var r=U.parseNodeText(t);return r?e.concat({url:r,creativeType:t.getAttribute(\"creativeType\")||null}):e}),[]),t.altText=U.parseNodeText(U.childByName(e,\"AltText\"))||null;var r=U.childByName(e,\"TrackingEvents\");r&&U.childrenByName(r,\"Tracking\").forEach((function(e){var r=e.getAttribute(\"event\"),i=U.parseNodeText(e);r&&i&&(Array.isArray(t.trackingEvents[r])||(t.trackingEvents[r]=[]),t.trackingEvents[r].push(i))})),t.companionClickTrackingURLTemplates=U.childrenByName(e,\"CompanionClickTracking\").map((function(e){return{id:e.getAttribute(\"id\")||null,url:U.parseNodeText(e)}})),t.companionClickThroughURLTemplate=U.parseNodeText(U.childByName(e,\"CompanionClickThrough\"))||null;var i=U.childByName(e,\"AdParameters\");return i&&(t.adParameters=U.parseNodeText(i),t.xmlEncoded=i.getAttribute(\"xmlEncoded\")||null),t})),r}function I(e){return\"linear\"===e.type}function x(e,t){var r,i=function(){var e=f(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),t=e.id,r=e.adId,i=e.sequence,n=e.apiFramework;return{id:t,adId:r,sequence:i,apiFramework:n,type:\"linear\",duration:0,skipDelay:null,mediaFiles:[],mezzanine:null,interactiveCreativeFile:null,closedCaptionFiles:[],videoClickThroughURLTemplate:null,videoClickTrackingURLTemplates:[],videoCustomClickURLTemplates:[],adParameters:null,icons:[],trackingEvents:{}}}(t);i.duration=U.parseDuration(U.parseNodeText(U.childByName(e,\"Duration\")));var n=e.getAttribute(\"skipoffset\");if(null==n)i.skipDelay=null;else if(\"%\"===n.charAt(n.length-1)&&-1!==i.duration){var a=parseInt(n,10);i.skipDelay=i.duration*(a/100)}else i.skipDelay=U.parseDuration(n);var o=U.childByName(e,\"VideoClicks\");if(o){var s=U.childByName(o,\"ClickThrough\");i.videoClickThroughURLTemplate=s?{id:s.getAttribute(\"id\")||null,url:U.parseNodeText(s)}:null,U.childrenByName(o,\"ClickTracking\").forEach((function(e){i.videoClickTrackingURLTemplates.push({id:e.getAttribute(\"id\")||null,url:U.parseNodeText(e)})})),U.childrenByName(o,\"CustomClick\").forEach((function(e){i.videoCustomClickURLTemplates.push({id:e.getAttribute(\"id\")||null,url:U.parseNodeText(e)})}))}var l=U.childByName(e,\"AdParameters\");l&&(i.adParameters=U.parseNodeText(l)),U.childrenByName(e,\"TrackingEvents\").forEach((function(e){U.childrenByName(e,\"Tracking\").forEach((function(e){var t=e.getAttribute(\"event\"),n=U.parseNodeText(e);if(t&&n){if(\"progress\"===t){if(!(r=e.getAttribute(\"offset\")))return;t=\"%\"===r.charAt(r.length-1)?\"progress-\".concat(r):\"progress-\".concat(Math.round(U.parseDuration(r)))}Array.isArray(i.trackingEvents[t])||(i.trackingEvents[t]=[]),i.trackingEvents[t].push(n)}}))})),U.childrenByName(e,\"MediaFiles\").forEach((function(e){U.childrenByName(e,\"MediaFile\").forEach((function(e){i.mediaFiles.push(function(e){var t={id:null,fileURL:null,fileSize:0,deliveryType:\"progressive\",mimeType:null,mediaType:null,codec:null,bitrate:0,minBitrate:0,maxBitrate:0,width:0,height:0,apiFramework:null,scalable:null,maintainAspectRatio:null};t.id=e.getAttribute(\"id\"),t.fileURL=U.parseNodeText(e),t.deliveryType=e.getAttribute(\"delivery\"),t.codec=e.getAttribute(\"codec\"),t.mimeType=e.getAttribute(\"type\"),t.mediaType=e.getAttribute(\"mediaType\")||\"2D\",t.apiFramework=e.getAttribute(\"apiFramework\"),t.fileSize=parseInt(e.getAttribute(\"fileSize\")||0),t.bitrate=parseInt(e.getAttribute(\"bitrate\")||0),t.minBitrate=parseInt(e.getAttribute(\"minBitrate\")||0),t.maxBitrate=parseInt(e.getAttribute(\"maxBitrate\")||0),t.width=parseInt(e.getAttribute(\"width\")||0),t.height=parseInt(e.getAttribute(\"height\")||0);var r=e.getAttribute(\"scalable\");r&&\"string\"==typeof r&&(t.scalable=U.parseBoolean(r));var i=e.getAttribute(\"maintainAspectRatio\");i&&\"string\"==typeof i&&(t.maintainAspectRatio=U.parseBoolean(i));return t}(e))}));var t=U.childByName(e,\"InteractiveCreativeFile\");t&&(i.interactiveCreativeFile=function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,apiFramework:e.apiFramework||null,variableDuration:U.parseBoolean(e.variableDuration),fileURL:null}}(U.parseAttributes(e));return t.fileURL=U.parseNodeText(e),t}(t));var r=U.childByName(e,\"ClosedCaptionFiles\");r&&U.childrenByName(r,\"ClosedCaptionFile\").forEach((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,language:e.language||null,fileURL:null}}(U.parseAttributes(e));t.fileURL=U.parseNodeText(e),i.closedCaptionFiles.push(t)}));var n,a,o,s=U.childByName(e,\"Mezzanine\"),l=(n=s,a={},o=!1,[\"delivery\",\"type\",\"width\",\"height\"].forEach((function(e){n&&n.getAttribute(e)?a[e]=n.getAttribute(e):o=!0})),o?null:a);if(l){var u={id:null,fileURL:null,delivery:null,codec:null,type:null,width:0,height:0,fileSize:0,mediaType:\"2D\"};u.id=s.getAttribute(\"id\"),u.fileURL=U.parseNodeText(s),u.delivery=l.delivery,u.codec=s.getAttribute(\"codec\"),u.type=l.type,u.width=parseInt(l.width,10),u.height=parseInt(l.height,10),u.fileSize=parseInt(s.getAttribute(\"fileSize\"),10),u.mediaType=s.getAttribute(\"mediaType\")||\"2D\",i.mezzanine=u}}));var u=U.childByName(e,\"Icons\");return u&&U.childrenByName(u,\"Icon\").forEach((function(e){i.icons.push(function(e){var t={program:null,height:0,width:0,xPosition:0,yPosition:0,apiFramework:null,offset:null,duration:0,type:null,staticResource:null,htmlResource:null,iframeResource:null,pxratio:\"1\",iconClickThroughURLTemplate:null,iconClickTrackingURLTemplates:[],iconViewTrackingURLTemplate:null};t.program=e.getAttribute(\"program\"),t.height=parseInt(e.getAttribute(\"height\")||0),t.width=parseInt(e.getAttribute(\"width\")||0),t.xPosition=function(e){if(-1!==[\"left\",\"right\"].indexOf(e))return e;return parseInt(e||0)}(e.getAttribute(\"xPosition\")),t.yPosition=function(e){if(-1!==[\"top\",\"bottom\"].indexOf(e))return e;return parseInt(e||0)}(e.getAttribute(\"yPosition\")),t.apiFramework=e.getAttribute(\"apiFramework\"),t.pxratio=e.getAttribute(\"pxratio\")||\"1\",t.offset=U.parseDuration(e.getAttribute(\"offset\")),t.duration=U.parseDuration(e.getAttribute(\"duration\")),U.childrenByName(e,\"HTMLResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||\"text/html\",t.htmlResource=U.parseNodeText(e)})),U.childrenByName(e,\"IFrameResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||0,t.iframeResource=U.parseNodeText(e)})),U.childrenByName(e,\"StaticResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||0,t.staticResource=U.parseNodeText(e)}));var r=U.childByName(e,\"IconClicks\");r&&(t.iconClickThroughURLTemplate=U.parseNodeText(U.childByName(r,\"IconClickThrough\")),U.childrenByName(r,\"IconClickTracking\").forEach((function(e){t.iconClickTrackingURLTemplates.push({id:e.getAttribute(\"id\")||null,url:U.parseNodeText(e)})})));return t.iconViewTrackingURLTemplate=U.parseNodeText(U.childByName(e,\"IconViewTracking\")),t}(e))})),i}function S(e,t){var r=function(){var e=f(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),t=e.id,r=e.adId,i=e.sequence,n=e.apiFramework;return{id:t,adId:r,sequence:i,apiFramework:n,type:\"nonlinear\",variations:[],trackingEvents:{}}}(t);return U.childrenByName(e,\"TrackingEvents\").forEach((function(e){var t,i;U.childrenByName(e,\"Tracking\").forEach((function(e){t=e.getAttribute(\"event\"),i=U.parseNodeText(e),t&&i&&(Array.isArray(r.trackingEvents[t])||(r.trackingEvents[t]=[]),r.trackingEvents[t].push(i))}))})),U.childrenByName(e,\"NonLinear\").forEach((function(e){var t={id:null,width:0,height:0,expandedWidth:0,expandedHeight:0,scalable:!0,maintainAspectRatio:!0,minSuggestedDuration:0,apiFramework:\"static\",adType:\"nonLinearAd\",type:null,staticResource:null,htmlResource:null,iframeResource:null,nonlinearClickThroughURLTemplate:null,nonlinearClickTrackingURLTemplates:[],adParameters:null};t.id=e.getAttribute(\"id\")||null,t.width=e.getAttribute(\"width\"),t.height=e.getAttribute(\"height\"),t.expandedWidth=e.getAttribute(\"expandedWidth\"),t.expandedHeight=e.getAttribute(\"expandedHeight\"),t.scalable=U.parseBoolean(e.getAttribute(\"scalable\")),t.maintainAspectRatio=U.parseBoolean(e.getAttribute(\"maintainAspectRatio\")),t.minSuggestedDuration=U.parseDuration(e.getAttribute(\"minSuggestedDuration\")),t.apiFramework=e.getAttribute(\"apiFramework\"),U.childrenByName(e,\"HTMLResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||\"text/html\",t.htmlResource=U.parseNodeText(e)})),U.childrenByName(e,\"IFrameResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||0,t.iframeResource=U.parseNodeText(e)})),U.childrenByName(e,\"StaticResource\").forEach((function(e){t.type=e.getAttribute(\"creativeType\")||0,t.staticResource=U.parseNodeText(e)}));var i=U.childByName(e,\"AdParameters\");i&&(t.adParameters=U.parseNodeText(i)),t.nonlinearClickThroughURLTemplate=U.parseNodeText(U.childByName(e,\"NonLinearClickThrough\")),U.childrenByName(e,\"NonLinearClickTracking\").forEach((function(e){t.nonlinearClickTrackingURLTemplates.push({id:e.getAttribute(\"id\")||null,url:U.parseNodeText(e)})})),r.variations.push(t)})),r}function O(e){var t=[];return e.forEach((function(e){var r=D(e);r&&t.push(r)})),t}function D(e){if(\"#comment\"===e.nodeName)return null;var t,r={name:null,value:null,attributes:{},children:[]},i=e.attributes,n=e.childNodes;if(r.name=e.nodeName,e.attributes)for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];o.nodeName&&o.nodeValue&&(r.attributes[o.nodeName]=o.nodeValue)}for(var s in n)if(n.hasOwnProperty(s)){var l=D(n[s]);l&&r.children.push(l)}if(0===r.children.length||1===r.children.length&&[\"#cdata-section\",\"#text\"].indexOf(r.children[0].name)>=0){var u=U.parseNodeText(e);\"\"!==u&&(r.value=u),r.children=[]}return null===(t=r).value&&0===Object.keys(t.attributes).length&&0===t.children.length?null:r}function V(e){var t=[];return e.forEach((function(e){var r,i={id:e.getAttribute(\"id\")||null,adId:P(e),sequence:e.getAttribute(\"sequence\")||null,apiFramework:e.getAttribute(\"apiFramework\")||null},n=[];U.childrenByName(e,\"UniversalAdId\").forEach((function(e){var t={idRegistry:e.getAttribute(\"idRegistry\")||\"unknown\",value:U.parseNodeText(e)};n.push(t)}));var a=U.childByName(e,\"CreativeExtensions\");for(var o in a&&(r=O(U.childrenByName(a,\"CreativeExtension\"))),e.childNodes){var s=e.childNodes[o],l=void 0;switch(s.nodeName){case\"Linear\":l=x(s,i);break;case\"NonLinearAds\":l=S(s,i);break;case\"CompanionAds\":l=C(s,i)}l&&(n&&(l.universalAdIds=n),r&&(l.creativeExtensions=r),t.push(l))}})),t}function P(e){return e.getAttribute(\"AdID\")||e.getAttribute(\"adID\")||e.getAttribute(\"adId\")||null}var B={Wrapper:{subElements:[\"VASTAdTagURI\",\"Impression\"]},BlockedAdCategories:{attributes:[\"authority\"]},InLine:{subElements:[\"AdSystem\",\"AdTitle\",\"Impression\",\"AdServingId\",\"Creatives\"]},Category:{attributes:[\"authority\"]},Pricing:{attributes:[\"model\",\"currency\"]},Verification:{oneOfinLineResources:[\"JavaScriptResource\",\"ExecutableResource\"],attributes:[\"vendor\"]},UniversalAdId:{attributes:[\"idRegistry\"]},JavaScriptResource:{attributes:[\"apiFramework\",\"browserOptional\"]},ExecutableResource:{attributes:[\"apiFramework\",\"type\"]},Tracking:{attributes:[\"event\"]},Creatives:{subElements:[\"Creative\"]},Creative:{subElements:[\"UniversalAdId\"]},Linear:{subElements:[\"MediaFiles\",\"Duration\"]},MediaFiles:{subElements:[\"MediaFile\"]},MediaFile:{attributes:[\"delivery\",\"type\",\"width\",\"height\"]},Mezzanine:{attributes:[\"delivery\",\"type\",\"width\",\"height\"]},NonLinear:{oneOfinLineResources:[\"StaticResource\",\"IFrameResource\",\"HTMLResource\"],attributes:[\"width\",\"height\"]},Companion:{oneOfinLineResources:[\"StaticResource\",\"IFrameResource\",\"HTMLResource\"],attributes:[\"width\",\"height\"]},StaticResource:{attributes:[\"creativeType\"]},Icons:{subElements:[\"Icon\"]},Icon:{oneOfinLineResources:[\"StaticResource\",\"IFrameResource\",\"HTMLResource\"]}};function F(e,t){if(B[e.nodeName]&&B[e.nodeName].attributes){var r=B[e.nodeName].attributes.filter((function(t){return!e.getAttribute(t)}));r.length>0&&j({name:e.nodeName,parentName:e.parentNode.nodeName,attributes:r},t)}}function M(e,t,r){var i=B[e.nodeName],n=!r&&\"Wrapper\"!==e.nodeName;if(i&&!n){if(i.subElements){var a=i.subElements.filter((function(t){return!U.childByName(e,t)}));a.length>0&&j({name:e.nodeName,parentName:e.parentNode.nodeName,subElements:a},t)}if(r&&i.oneOfinLineResources)i.oneOfinLineResources.some((function(t){return U.childByName(e,t)}))||j({name:e.nodeName,parentName:e.parentNode.nodeName,oneOfResources:i.oneOfinLineResources},t)}}function W(e){return e.children&&0!==e.children.length}function j(e,t){var r=e.name,i=e.parentName,n=e.attributes,a=e.subElements,o=e.oneOfResources,s=\"Element '\".concat(r,\"'\");t(\"VAST-warning\",{message:s+=n?\" missing required attribute(s) '\".concat(n.join(\", \"),\"' \"):a?\" missing required sub element(s) '\".concat(a.join(\", \"),\"' \"):o?\" must provide one of the following '\".concat(o.join(\", \"),\"' \"):\" is empty\",parentElement:i,specVersion:4.1})}var q={verifyRequiredValues:function e(t,r,i){if(t&&t.nodeName)if(\"InLine\"===t.nodeName&&(i=!0),F(t,r),W(t)){M(t,r,i);for(var n=0;n<t.children.length;n++)e(t.children[n],r,i)}else 0===U.parseNodeText(t).length&&j({name:t.nodeName,parentName:t.parentNode.nodeName},r)},hasSubElements:W,emitMissingValueWarning:j,verifyRequiredAttributes:F,verifyRequiredSubElements:M};function H(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.allowMultipleAds,n=r.followAdditionalWrappers,a=e.childNodes;for(var o in a){var s=a[o];if(-1!==[\"Wrapper\",\"InLine\"].indexOf(s.nodeName)&&(\"Wrapper\"!==s.nodeName||!1!==n)){if(U.copyNodeAttribute(\"id\",e,s),U.copyNodeAttribute(\"sequence\",e,s),U.copyNodeAttribute(\"adType\",e,s),\"Wrapper\"===s.nodeName)return{ad:z(s,t),type:\"WRAPPER\"};if(\"InLine\"===s.nodeName)return{ad:_(s,t,{allowMultipleAds:i}),type:\"INLINE\"}}}}function _(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.allowMultipleAds;return!1===i&&e.getAttribute(\"sequence\")?null:G(e,t)}function G(e,t){var r=[];t&&q.verifyRequiredValues(e,t);var i=e.childNodes,n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,sequence:e.sequence||null,adType:e.adType||null,adServingId:null,categories:[],expires:null,viewableImpression:[],system:null,title:null,description:null,advertiser:null,pricing:null,survey:null,errorURLTemplates:[],impressionURLTemplates:[],creatives:[],extensions:[],adVerifications:[],blockedAdCategories:[],followAdditionalWrappers:!0,allowMultipleAds:!1,fallbackOnNoAd:null}}(U.parseAttributes(e));for(var a in i){var o=i[a];switch(o.nodeName){case\"Error\":n.errorURLTemplates.push(U.parseNodeText(o));break;case\"Impression\":n.impressionURLTemplates.push({id:o.getAttribute(\"id\")||null,url:U.parseNodeText(o)});break;case\"Creatives\":n.creatives=V(U.childrenByName(o,\"Creative\"));break;case\"Extensions\":var s=U.childrenByName(o,\"Extension\");n.extensions=O(s),n.adVerifications.length||(r=X(s));break;case\"AdVerifications\":n.adVerifications=Y(U.childrenByName(o,\"Verification\"));break;case\"AdSystem\":n.system={value:U.parseNodeText(o),version:o.getAttribute(\"version\")||null};break;case\"AdTitle\":n.title=U.parseNodeText(o);break;case\"AdServingId\":n.adServingId=U.parseNodeText(o);break;case\"Category\":n.categories.push({authority:o.getAttribute(\"authority\")||null,value:U.parseNodeText(o)});break;case\"Expires\":n.expires=parseInt(U.parseNodeText(o),10);break;case\"ViewableImpression\":n.viewableImpression.push(K(o));break;case\"Description\":n.description=U.parseNodeText(o);break;case\"Advertiser\":n.advertiser={id:o.getAttribute(\"id\")||null,value:U.parseNodeText(o)};break;case\"Pricing\":n.pricing={value:U.parseNodeText(o),model:o.getAttribute(\"model\")||null,currency:o.getAttribute(\"currency\")||null};break;case\"Survey\":n.survey=U.parseNodeText(o);break;case\"BlockedAdCategories\":n.blockedAdCategories.push({authority:o.getAttribute(\"authority\")||null,value:U.parseNodeText(o)})}}return r.length&&(n.adVerifications=n.adVerifications.concat(r)),n}function z(e,t){var r=G(e,t),i=e.getAttribute(\"followAdditionalWrappers\"),n=e.getAttribute(\"allowMultipleAds\"),a=e.getAttribute(\"fallbackOnNoAd\");r.followAdditionalWrappers=!i||U.parseBoolean(i),r.allowMultipleAds=!!n&&U.parseBoolean(n),r.fallbackOnNoAd=a?U.parseBoolean(a):null;var o=U.childByName(e,\"VASTAdTagURI\");if(o?r.nextWrapperURL=U.parseNodeText(o):(o=U.childByName(e,\"VASTAdTagURL\"))&&(r.nextWrapperURL=U.parseNodeText(U.childByName(o,\"URL\"))),r.creatives.forEach((function(e){if(-1!==[\"linear\",\"nonlinear\"].indexOf(e.type)){if(e.trackingEvents){r.trackingEvents||(r.trackingEvents={}),r.trackingEvents[e.type]||(r.trackingEvents[e.type]={});var t=function(t){var i=e.trackingEvents[t];Array.isArray(r.trackingEvents[e.type][t])||(r.trackingEvents[e.type][t]=[]),i.forEach((function(i){r.trackingEvents[e.type][t].push(i)}))};for(var i in e.trackingEvents)t(i)}e.videoClickTrackingURLTemplates&&(Array.isArray(r.videoClickTrackingURLTemplates)||(r.videoClickTrackingURLTemplates=[]),e.videoClickTrackingURLTemplates.forEach((function(e){r.videoClickTrackingURLTemplates.push(e)}))),e.videoClickThroughURLTemplate&&(r.videoClickThroughURLTemplate=e.videoClickThroughURLTemplate),e.videoCustomClickURLTemplates&&(Array.isArray(r.videoCustomClickURLTemplates)||(r.videoCustomClickURLTemplates=[]),e.videoCustomClickURLTemplates.forEach((function(e){r.videoCustomClickURLTemplates.push(e)})))}})),r.nextWrapperURL)return r}function Y(e){var t=[];return e.forEach((function(e){var r={resource:null,vendor:null,browserOptional:!1,apiFramework:null,type:null,parameters:null,trackingEvents:{}},i=e.childNodes;for(var n in U.assignAttributes(e.attributes,r),i){var a=i[n];switch(a.nodeName){case\"JavaScriptResource\":case\"ExecutableResource\":r.resource=U.parseNodeText(a),U.assignAttributes(a.attributes,r);break;case\"VerificationParameters\":r.parameters=U.parseNodeText(a)}}var o=U.childByName(e,\"TrackingEvents\");o&&U.childrenByName(o,\"Tracking\").forEach((function(e){var t=e.getAttribute(\"event\"),i=U.parseNodeText(e);t&&i&&(Array.isArray(r.trackingEvents[t])||(r.trackingEvents[t]=[]),r.trackingEvents[t].push(i))})),t.push(r)})),t}function X(e){var t=null,r=[];return e.some((function(e){return t=U.childByName(e,\"AdVerifications\")})),t&&(r=Y(U.childrenByName(t,\"Verification\"))),r}function K(e){var t={};t.id=e.getAttribute(\"id\")||null;var r=e.childNodes;for(var i in r){var n=r[i],a=n.nodeName,o=U.parseNodeText(n);if((\"Viewable\"===a||\"NotViewable\"===a||\"ViewUndetermined\"===a)&&o){var s=a.toLowerCase();Array.isArray(t[s])||(t[s]=[]),t[s].push(o)}}return t}var Q=function(){function e(){n(this,e),this._handlers=[]}return o(e,[{key:\"on\",value:function(e,t){if(\"function\"!=typeof t)throw new TypeError(\"The handler argument must be of type Function. Received type \".concat(i(t)));if(!e)throw new TypeError(\"The event argument must be of type String. Received type \".concat(i(e)));return this._handlers.push({event:e,handler:t}),this}},{key:\"once\",value:function(e,t){return this.on(e,function(e,t,r){var i={fired:!1,wrapFn:void 0};function n(){i.fired||(e.off(t,i.wrapFn),i.fired=!0,r.bind(e).apply(void 0,arguments))}return i.wrapFn=n,n}(this,e,t))}},{key:\"off\",value:function(e,t){return this._handlers=this._handlers.filter((function(r){return r.event!==e||r.handler!==t})),this}},{key:\"emit\",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var n=!1;return this._handlers.forEach((function(t){\"*\"===t.event&&(n=!0,t.handler.apply(t,[e].concat(r))),t.event===e&&(n=!0,t.handler.apply(t,r))})),n}},{key:\"removeAllListeners\",value:function(e){return e?(this._handlers=this._handlers.filter((function(t){return t.event!==e})),this):(this._handlers=[],this)}},{key:\"listenerCount\",value:function(e){return this._handlers.filter((function(t){return t.event===e})).length}},{key:\"listeners\",value:function(e){return this._handlers.reduce((function(t,r){return r.event===e&&t.push(r.handler),t}),[])}},{key:\"eventNames\",value:function(){return this._handlers.map((function(e){return e.event}))}}]),e}();var J={get:function(e,t,r){r(new Error(\"Please bundle the library for node to use the node urlHandler\"))}},$=12e4;function Z(){try{var e=new window.XMLHttpRequest;return\"withCredentials\"in e?e:null}catch(e){return null}}function ee(e,t,r){var i=r?408:e.status,n=r?\"XHRURLHandler: Request timed out after \".concat(e.timeout,\" ms (\").concat(i,\")\"):\"XHRURLHandler: \".concat(e.statusText,\" (\").concat(i,\")\");t(new Error(n),null,{statusCode:i})}var te={get:function(e,t,r){if(\"https:\"===window.location.protocol&&0===e.indexOf(\"http://\"))return r(new Error(\"XHRURLHandler: Cannot go from HTTPS to HTTP.\"));try{var i=Z();i.open(\"GET\",e),i.timeout=t.timeout||$,i.withCredentials=t.withCredentials||!1,i.overrideMimeType&&i.overrideMimeType(\"text/xml\"),i.onload=function(){return function(e,t){200===e.status?t(null,e.responseXML,{byteLength:e.response.length,statusCode:e.status}):ee(e,t,!1)}(i,r)},i.onerror=function(){return ee(i,r,!1)},i.onabort=function(){return ee(i,r,!1)},i.ontimeout=function(){return ee(i,r,!0)},i.send()}catch(e){r(new Error(\"XHRURLHandler: Unexpected error\"))}},supported:function(){return!!Z()}};var re={get:function(e,t,r){return r||(\"function\"==typeof t&&(r=t),t={}),\"undefined\"==typeof window||null===window?J.get(e,t,r):te.supported()?te.get(e,t,r):r(new Error(\"Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler\"))}};var ie=0,ne=0,ae=function(e,t){!e||!t||e<=0||t<=0||(ne=(ne*ie+8*e/t)/++ie)},oe={ERRORCODE:900,extensions:[]},se=function(e){l(r,e);var t=p(r);function r(){var e;return n(this,r),(e=t.call(this)).remainingAds=[],e.parentURLs=[],e.errorURLTemplates=[],e.rootErrorURLTemplates=[],e.maxWrapperDepth=null,e.URLTemplateFilters=[],e.fetchingOptions={},e.parsingOptions={},e}return o(r,[{key:\"addURLTemplateFilter\",value:function(e){\"function\"==typeof e&&this.URLTemplateFilters.push(e)}},{key:\"removeURLTemplateFilter\",value:function(){this.URLTemplateFilters.pop()}},{key:\"countURLTemplateFilters\",value:function(){return this.URLTemplateFilters.length}},{key:\"clearURLTemplateFilters\",value:function(){this.URLTemplateFilters=[]}},{key:\"trackVastError\",value:function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];this.emit(\"VAST-error\",Object.assign.apply(Object,[{},oe,t].concat(i))),L.track(e,t)}},{key:\"getErrorURLTemplates\",value:function(){return this.rootErrorURLTemplates.concat(this.errorURLTemplates)}},{key:\"getEstimatedBitrate\",value:function(){return ne}},{key:\"fetchVAST\",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(a,o){t.URLTemplateFilters.forEach((function(t){e=t(e)})),t.parentURLs.push(e);var s=Date.now();t.emit(\"VAST-resolving\",{url:e,previousUrl:i,wrapperDepth:r,maxWrapperDepth:t.maxWrapperDepth,timeout:t.fetchingOptions.timeout,wrapperAd:n}),t.urlHandler.get(e,t.fetchingOptions,(function(n,l){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=Math.round(Date.now()-s),d=Object.assign({url:e,previousUrl:i,wrapperDepth:r,error:n,duration:c},u);t.emit(\"VAST-resolved\",d),ae(u.byteLength,c),n?o(n):a(l)}))}))}},{key:\"initParsingStatus\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.errorURLTemplates=[],this.fetchingOptions={timeout:e.timeout||$,withCredentials:e.withCredentials},this.maxWrapperDepth=e.wrapperLimit||10,this.parentURLs=[],this.parsingOptions={allowMultipleAds:e.allowMultipleAds},this.remainingAds=[],this.rootErrorURLTemplates=[],this.rootURL=\"\",this.urlHandler=e.urlHandler||e.urlhandler||re,this.vastVersion=null,ae(e.byteLength,e.requestDuration)}},{key:\"getRemainingAds\",value:function(e){var t=this;if(0===this.remainingAds.length)return Promise.reject(new Error(\"No more ads are available for the given VAST\"));var r=e?L.flatten(this.remainingAds):this.remainingAds.shift();return this.errorURLTemplates=[],this.parentURLs=[],this.resolveAds(r,{wrapperDepth:0,url:this.rootURL}).then((function(e){return t.buildVASTResponse(e)}))}},{key:\"getAndParseVAST\",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(r),this.URLTemplateFilters.forEach((function(t){e=t(e)})),this.rootURL=e,this.fetchVAST(e).then((function(i){return r.previousUrl=e,r.isRootVAST=!0,r.url=e,t.parse(i,r).then((function(e){return t.buildVASTResponse(e)}))}))}},{key:\"parseVAST\",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(r),r.isRootVAST=!0,this.parse(e,r).then((function(e){return t.buildVASTResponse(e)}))}},{key:\"buildVASTResponse\",value:function(e){var t,r={ads:(t={ads:e,errorURLTemplates:this.getErrorURLTemplates(),version:this.vastVersion}).ads||[],errorURLTemplates:t.errorURLTemplates||[],version:t.version||null};return this.completeWrapperResolving(r),r}},{key:\"parseVastXml\",value:function(e,t){var r=t.isRootVAST,i=void 0!==r&&r,n=t.url,a=void 0===n?null:n,o=t.wrapperDepth,s=void 0===o?0:o,l=t.allowMultipleAds,u=t.followAdditionalWrappers;if(!e||!e.documentElement||\"VAST\"!==e.documentElement.nodeName)throw this.emit(\"VAST-ad-parsed\",{type:\"ERROR\",url:a,wrapperDepth:s}),new Error(\"Invalid VAST XMLDocument\");var c=[],d=e.documentElement.childNodes,p=e.documentElement.getAttribute(\"version\");for(var h in i&&p&&(this.vastVersion=p),d){var v=d[h];if(\"Error\"===v.nodeName){var f=U.parseNodeText(v);i?this.rootErrorURLTemplates.push(f):this.errorURLTemplates.push(f)}else if(\"Ad\"===v.nodeName){if(this.vastVersion&&parseFloat(this.vastVersion)<3)l=!0;else if(!1===l&&c.length>1)break;var m=H(v,this.emit.bind(this),{allowMultipleAds:l,followAdditionalWrappers:u});m.ad?(c.push(m.ad),this.emit(\"VAST-ad-parsed\",{type:m.type,url:a,wrapperDepth:s,adIndex:c.length-1,vastVersion:p})):this.trackVastError(this.getErrorURLTemplates(),{ERRORCODE:101})}}return c}},{key:\"parse\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.url,i=void 0===r?null:r,n=t.resolveAll,a=void 0===n||n,o=t.wrapperSequence,s=void 0===o?null:o,l=t.previousUrl,u=void 0===l?null:l,c=t.wrapperDepth,d=void 0===c?0:c,p=t.isRootVAST,h=void 0!==p&&p,v=t.followAdditionalWrappers,f=t.allowMultipleAds,m=[];this.vastVersion&&parseFloat(this.vastVersion)<3&&h&&(f=!0);try{m=this.parseVastXml(e,{isRootVAST:h,url:i,wrapperDepth:d,allowMultipleAds:f,followAdditionalWrappers:v})}catch(e){return Promise.reject(e)}return 1===m.length&&null!=s&&(m[0].sequence=s),!1===a&&(this.remainingAds=U.splitVAST(m),m=this.remainingAds.shift()),this.resolveAds(m,{wrapperDepth:d,previousUrl:u,url:i})}},{key:\"resolveAds\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,i=r.wrapperDepth,n=r.previousUrl,a=r.url,o=[];return n=a,t.forEach((function(t){var r=e.resolveWrappers(t,i,n);o.push(r)})),Promise.all(o).then((function(t){var r=L.flatten(t);if(!r&&e.remainingAds.length>0){var o=e.remainingAds.shift();return e.resolveAds(o,{wrapperDepth:i,previousUrl:n,url:a})}return r}))}},{key:\"resolveWrappers\",value:function(e,t,r){var i=this;return new Promise((function(n){var a;if(t++,!e.nextWrapperURL)return delete e.nextWrapperURL,n(e);if(t>=i.maxWrapperDepth||-1!==i.parentURLs.indexOf(e.nextWrapperURL))return e.errorCode=302,delete e.nextWrapperURL,n(e);e.nextWrapperURL=U.resolveVastAdTagURI(e.nextWrapperURL,r),i.URLTemplateFilters.forEach((function(t){e.nextWrapperURL=t(e.nextWrapperURL)}));var o=null!==(a=i.parsingOptions.allowMultipleAds)&&void 0!==a?a:e.allowMultipleAds,s=e.sequence;i.fetchVAST(e.nextWrapperURL,t,r,e).then((function(a){return i.parse(a,{url:e.nextWrapperURL,previousUrl:r,wrapperSequence:s,wrapperDepth:t,followAdditionalWrappers:e.followAdditionalWrappers,allowMultipleAds:o}).then((function(t){if(delete e.nextWrapperURL,0===t.length)return e.creatives=[],n(e);t.forEach((function(t){t&&U.mergeWrapperAdData(t,e)})),n(t)}))})).catch((function(t){e.errorCode=301,e.errorMessage=t.message,n(e)}))}))}},{key:\"completeWrapperResolving\",value:function(e){if(0===e.ads.length)this.trackVastError(e.errorURLTemplates,{ERRORCODE:303});else for(var t=e.ads.length-1;t>=0;t--){var r=e.ads[t];(r.errorCode||0===r.creatives.length)&&(this.trackVastError(r.errorURLTemplates.concat(e.errorURLTemplates),{ERRORCODE:r.errorCode||303},{ERRORMESSAGE:r.errorMessage||\"\"},{extensions:r.extensions},{system:r.system}),e.ads.splice(t,1))}}}]),r}(Q),le=null,ue={data:{},length:0,getItem:function(e){return this.data[e]},setItem:function(e,t){this.data[e]=t,this.length=Object.keys(this.data).length},removeItem:function(e){delete this.data[e],this.length=Object.keys(this.data).length},clear:function(){this.data={},this.length=0}},ce=function(){function e(){n(this,e),this.storage=this.initStorage()}return o(e,[{key:\"initStorage\",value:function(){if(le)return le;try{le=\"undefined\"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){le=null}return le&&!this.isStorageDisabled(le)||(le=ue).clear(),le}},{key:\"isStorageDisabled\",value:function(e){var t=\"__VASTStorage__\";try{if(e.setItem(t,t),e.getItem(t)!==t)return e.removeItem(t),!0}catch(e){return!0}return e.removeItem(t),!1}},{key:\"getItem\",value:function(e){return this.storage.getItem(e)}},{key:\"setItem\",value:function(e,t){return this.storage.setItem(e,t)}},{key:\"removeItem\",value:function(e){return this.storage.removeItem(e)}},{key:\"clear\",value:function(){return this.storage.clear()}}]),e}(),de=function(){function e(t,r,i){n(this,e),this.cappingFreeLunch=t||0,this.cappingMinimumTimeInterval=r||0,this.defaultOptions={withCredentials:!1,timeout:0},this.vastParser=new se,this.storage=i||new ce,void 0===this.lastSuccessfulAd&&(this.lastSuccessfulAd=0),void 0===this.totalCalls&&(this.totalCalls=0),void 0===this.totalCallsTimeout&&(this.totalCallsTimeout=0)}return o(e,[{key:\"getParser\",value:function(){return this.vastParser}},{key:\"lastSuccessfulAd\",get:function(){return this.storage.getItem(\"vast-client-last-successful-ad\")},set:function(e){this.storage.setItem(\"vast-client-last-successful-ad\",e)}},{key:\"totalCalls\",get:function(){return this.storage.getItem(\"vast-client-total-calls\")},set:function(e){this.storage.setItem(\"vast-client-total-calls\",e)}},{key:\"totalCallsTimeout\",get:function(){return this.storage.getItem(\"vast-client-total-calls-timeout\")},set:function(e){this.storage.setItem(\"vast-client-total-calls-timeout\",e)}},{key:\"hasRemainingAds\",value:function(){return this.vastParser.remainingAds.length>0}},{key:\"getNextAds\",value:function(e){return this.vastParser.getRemainingAds(e)}},{key:\"get\",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Date.now();return(r=Object.assign({},this.defaultOptions,r)).hasOwnProperty(\"resolveAll\")||(r.resolveAll=!1),this.totalCallsTimeout<i?(this.totalCalls=1,this.totalCallsTimeout=i+36e5):this.totalCalls++,new Promise((function(n,a){if(t.cappingFreeLunch>=t.totalCalls)return a(new Error(\"VAST call canceled – FreeLunch capping not reached yet \".concat(t.totalCalls,\"/\").concat(t.cappingFreeLunch)));var o=i-t.lastSuccessfulAd;if(o<0)t.lastSuccessfulAd=0;else if(o<t.cappingMinimumTimeInterval)return a(new Error(\"VAST call canceled – (\".concat(t.cappingMinimumTimeInterval,\")ms minimum interval reached\")));t.vastParser.getAndParseVAST(e,r).then((function(e){return n(e)})).catch((function(e){return a(e)}))}))}}]),e}(),pe=function(e){l(i,e);var t=p(i);function i(e,r,a){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;for(var l in n(this,i),(o=t.call(this)).ad=r,o.creative=a,o.variation=s,o.muted=!1,o.impressed=!1,o.skippable=!1,o.trackingEvents={},o.lastPercentage=0,o._alreadyTriggeredQuartiles={},o.emitAlwaysEvents=[\"creativeView\",\"start\",\"firstQuartile\",\"midpoint\",\"thirdQuartile\",\"complete\",\"resume\",\"pause\",\"rewind\",\"skip\",\"closeLinear\",\"close\"],o.creative.trackingEvents){var u=o.creative.trackingEvents[l];o.trackingEvents[l]=u.slice(0)}return I(o.creative)?o._initLinearTracking():o._initVariationTracking(),e&&o.on(\"start\",(function(){e.lastSuccessfulAd=Date.now()})),o}return o(i,[{key:\"_initLinearTracking\",value:function(){this.linear=!0,this.skipDelay=this.creative.skipDelay,this.setDuration(this.creative.duration),this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates}},{key:\"_initVariationTracking\",value:function(){if(this.linear=!1,this.skipDelay=-1,this.variation){for(var e in this.variation.trackingEvents){var t=this.variation.trackingEvents[e];this.trackingEvents[e]?this.trackingEvents[e]=this.trackingEvents[e].concat(t.slice(0)):this.trackingEvents[e]=t.slice(0)}\"nonLinearAd\"===this.variation.adType?(this.clickThroughURLTemplate=this.variation.nonlinearClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.nonlinearClickTrackingURLTemplates,this.setDuration(this.variation.minSuggestedDuration)):function(e){return\"companionAd\"===e.adType}(this.variation)&&(this.clickThroughURLTemplate=this.variation.companionClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.companionClickTrackingURLTemplates)}}},{key:\"setDuration\",value:function(e){this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}}},{key:\"setProgress\",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.skipDelay||-1;if(-1===i||this.skippable||(i>e?this.emit(\"skip-countdown\",i-e):(this.skippable=!0,this.emit(\"skip-countdown\",0))),this.assetDuration>0){var n=Math.round(e/this.assetDuration*100),a=[];if(e>0){a.push(\"start\");for(var o=this.lastPercentage;o<n;o++)a.push(\"progress-\".concat(o+1,\"%\"));for(var s in a.push(\"progress-\".concat(Math.round(e))),this.quartiles)this.isQuartileReached(s,this.quartiles[s],e)&&(a.push(s),this._alreadyTriggeredQuartiles[s]=!0);this.lastPercentage=n}a.forEach((function(e){t.track(e,{macros:r,once:!0})})),e<this.progress&&this.track(\"rewind\",{macros:r})}this.progress=e}},{key:\"isQuartileReached\",value:function(e,t,r){var i=!1;return t<=r&&!this._alreadyTriggeredQuartiles[e]&&(i=!0),i}},{key:\"setMuted\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.muted!==e&&this.track(e?\"mute\":\"unmute\",{macros:t}),this.muted=e}},{key:\"setPaused\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.paused!==e&&this.track(e?\"pause\":\"resume\",{macros:t}),this.paused=e}},{key:\"setFullscreen\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fullscreen!==e&&this.track(e?\"fullscreen\":\"exitFullscreen\",{macros:t}),this.fullscreen=e}},{key:\"setExpand\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.expanded!==e&&(this.track(e?\"expand\":\"collapse\",{macros:t}),this.track(e?\"playerExpand\":\"playerCollapse\",{macros:t})),this.expanded=e}},{key:\"setSkipDelay\",value:function(e){\"number\"==typeof e&&(this.skipDelay=e)}},{key:\"trackImpression\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.impressed||(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates,e),this.track(\"creativeView\",{macros:e}))}},{key:\"error\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.trackURLs(this.ad.errorURLTemplates,e,{isCustomCode:t})}},{key:\"errorWithCode\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.error({ERRORCODE:e},t),console.log(\"The method errorWithCode is deprecated, please use vast tracker error method instead\")}},{key:\"complete\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(\"complete\",{macros:e})}},{key:\"notUsed\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(\"notUsed\",{macros:e}),this.trackingEvents=[]}},{key:\"otherAdInteraction\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(\"otherAdInteraction\",{macros:e})}},{key:\"acceptInvitation\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(\"acceptInvitation\",{macros:e})}},{key:\"adExpand\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(\"adExpand\",{macros:e})}},{key:\"adCollapse\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(\"adCollapse\",{macros:e})}},{key:\"minimize\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(\"minimize\",{macros:e})}},{key:\"verificationNotExecuted\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.ad||!this.ad.adVerifications||!this.ad.adVerifications.length)throw new Error(\"No adVerifications provided\");if(!e)throw new Error(\"No vendor provided, unable to find associated verificationNotExecuted\");var r=this.ad.adVerifications.find((function(t){return t.vendor===e}));if(!r)throw new Error(\"No associated verification element found for vendor: \".concat(e));var i=r.trackingEvents;if(i&&i.verificationNotExecuted){var n=i.verificationNotExecuted;this.trackURLs(n,t),this.emit(\"verificationNotExecuted\",{trackingURLTemplates:n})}}},{key:\"overlayViewDuration\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.ADPLAYHEAD=e,this.track(\"overlayViewDuration\",{macros:t})}},{key:\"close\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(this.linear?\"closeLinear\":\"close\",{macros:e})}},{key:\"skip\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(\"skip\",{macros:e})}},{key:\"load\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(\"loaded\",{macros:e})}},{key:\"click\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.clickTrackingURLTemplates&&this.clickTrackingURLTemplates.length&&this.trackURLs(this.clickTrackingURLTemplates,t);var i=this.clickThroughURLTemplate||e,n=r({},t);if(i){this.progress&&(n.ADPLAYHEAD=this.progressFormatted());var a=L.resolveURLTemplates([i],n)[0];this.emit(\"clickthrough\",a)}}},{key:\"track\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.macros,i=void 0===r?{}:r,n=t.once,a=void 0!==n&&n;\"closeLinear\"===e&&!this.trackingEvents[e]&&this.trackingEvents.close&&(e=\"close\");var o=this.trackingEvents[e],s=this.emitAlwaysEvents.indexOf(e)>-1;o?(this.emit(e,{trackingURLTemplates:o}),this.trackURLs(o,i)):s&&this.emit(e,null),a&&(delete this.trackingEvents[e],s&&this.emitAlwaysEvents.splice(this.emitAlwaysEvents.indexOf(e),1))}},{key:\"trackURLs\",value:function(e){var t,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r({},n);this.linear&&(this.creative&&this.creative.mediaFiles&&this.creative.mediaFiles[0]&&this.creative.mediaFiles[0].fileURL&&(o.ASSETURI=this.creative.mediaFiles[0].fileURL),this.progress&&(o.ADPLAYHEAD=this.progressFormatted())),null!==(t=this.creative)&&void 0!==t&&null!==(i=t.universalAdIds)&&void 0!==i&&i.length&&(o.UNIVERSALADID=this.creative.universalAdIds.map((function(e){return e.idRegistry.concat(\" \",e.value)})).join(\",\")),this.ad&&(this.ad.sequence&&(o.PODSEQUENCE=this.ad.sequence),this.ad.adType&&(o.ADTYPE=this.ad.adType),this.ad.adServingId&&(o.ADSERVINGID=this.ad.adServingId),this.ad.categories&&this.ad.categories.length&&(o.ADCATEGORIES=this.ad.categories.map((function(e){return e.value})).join(\",\")),this.ad.blockedAdCategories&&this.ad.blockedAdCategories.length&&(o.BLOCKEDADCATEGORIES=this.ad.blockedAdCategories)),L.track(e,o,a)}},{key:\"convertToTimecode\",value:function(e){var t=1e3*e,r=Math.floor(t/36e5),i=Math.floor(t/6e4%60),n=Math.floor(t/1e3%60),a=Math.floor(t%1e3);return\"\".concat(L.leftpad(r,2),\":\").concat(L.leftpad(i,2),\":\").concat(L.leftpad(n,2),\".\").concat(L.leftpad(a,3))}},{key:\"progressFormatted\",value:function(){return this.convertToTimecode(this.progress)}}]),i}(Q);e.VASTClient=de,e.VASTParser=se,e.VASTTracker=pe,Object.defineProperty(e,\"__esModule\",{value:!0})}));\n\n\n//# sourceURL=webpack://adserve/./node_modules/@dailymotion/vast-client/dist/vast-client.min.js?");

/***/ }),

/***/ "./src/ad-error.js":
/*!*************************!*\
  !*** ./src/ad-error.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ \"./src/utils.js\");\n\n\nconst AdError = function(message, errorCode, innerError) {\n  this.message = message;\n  this.errorCode = errorCode;\n  this.innerError = innerError;\n};\nAdError.prototype.getMessage = function() {\n  return this.message;\n};\nAdError.prototype.getErrorCode = function() {\n  return this.errorCode;\n};\nAdError.prototype.getInnerError = function() {\n  return this.innerError instanceof Object ? this.innerError : null;\n};\nAdError.prototype.formatMessage = function(...values) {\n  this.message = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.format)(this.message, values);\n  return this;\n};\nAdError.prototype.toString = function() {\n  return 'AdError ' + this.getErrorCode() + ': ' + this.getMessage() + (null != this.getInnerError() ? ' Caused by: ' + this.getInnerError() : '');\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AdError);\n\n\n//# sourceURL=webpack://adserve/./src/ad-error.js?");

/***/ }),

/***/ "./src/ads-manager.js":
/*!****************************!*\
  !*** ./src/ads-manager.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"AdsManager\": () => (/* binding */ AdsManager)\n/* harmony export */ });\n/* harmony import */ var _dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dailymotion/vast-client */ \"./node_modules/@dailymotion/vast-client/dist/vast-client.min.js\");\n/* harmony import */ var _dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _ad_error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ad-error */ \"./src/ad-error.js\");\n\n\n\nconst AdsManager = function(adContainer) {\n\n  if(!(adContainer instanceof Element || adContainer instanceof HTMLDocument)) {\n    throw new Error('ad container is not defined');\n  }\n\n  // Ad Container\n  this._adContainer = adContainer;\n\n  // Slot\n  this._slot = null;\n  // Video Slot\n  this._videoSlot = null;\n\n  // Create Slot\n  this.createSlot();\n\n  // Events\n  this.EVENTS = {\n    AdsManagerLoaded: 'AdsManagerLoaded', // After success ad request, when vast xml is parsed and ready\n    AdStarted: 'AdStarted',\n    AdStopped: 'AdStopped',\n    AdSkipped: 'AdSkipped',\n    AdLoaded: 'AdLoaded',\n    AdLinearChange: 'AdLinearChange',\n    AdSizeChange: 'AdSizeChange',\n    AdExpandedChange: 'AdExpandedChange',\n    AdSkippableStateChange: 'AdSkippableStateChange',\n    AdDurationChange: 'AdDurationChange',\n    AdRemainingTimeChange: 'AdRemainingTimeChange',\n    AdVolumeChange: 'AdVolumeChange',\n    AdImpression: 'AdImpression',\n    AdClickThru: 'AdClickThru',\n    AdInteraction: 'AdInteraction',\n    AdVideoStart: 'AdVideoStart',\n    AdVideoFirstQuartile: 'AdVideoFirstQuartile',\n    AdVideoMidpoint: 'AdVideoMidpoint',\n    AdVideoThirdQuartile: 'AdVideoThirdQuartile',\n    AdVideoComplete: 'AdVideoComplete',\n    AdUserAcceptInvitation: 'AdUserAcceptInvitation',\n    AdUserMinimize: 'AdUserMinimize',\n    AdUserClose: 'AdUserClose',\n    AdPaused: 'AdPaused',\n    AdPlaying: 'AdPlaying',\n    AdError: 'AdError',\n    AdLog: 'AdLog',\n    AllAdsCompleted: 'AllAdsCompleted' // After all ads completed, vast, vpaid, vmap\n  };\n  this._eventCallbacks = {};\n  this._creativeEventCallbacks = {};\n\n  // Attributes\n  this._attributes = {\n    width: 300,\n    height: 154,\n    viewMode: 'normal',\n    desiredBitrate: -1, // 268,\n    duration: 10,\n    remainingTime: 10,\n    currentTime: 0,\n    volume: 0,\n    version: '1.1.6'\n  };\n\n  // Quartile Events\n  this._quartileEvents = [\n    { event: 'AdImpression', value: 0 },\n    { event: 'AdVideoStart', value: 0 },\n    { event: 'AdVideoFirstQuartile', value: 25 },\n    { event: 'AdVideoMidpoint', value: 50 },\n    { event: 'AdVideoThirdQuartile', value: 75 },\n    { event: 'AdVideoComplete', value: 100 }\n  ];\n  this._nextQuartileIndex = 0;\n  this._defaultEventCallbacks = {\n    'AdImpression': this.onAdImpression.bind(this),\n    'AdVideoStart': this.onAdVideoStart.bind(this),\n    'AdVideoFirstQuartile': this.onAdVideoFirstQuartile.bind(this),\n    'AdVideoMidpoint': this.onAdVideoMidpoint.bind(this),\n    'AdVideoThirdQuartile': this.onAdVideoThirdQuartile.bind(this),\n    'AdVideoComplete': this.onAdVideoComplete.bind(this)\n  };\n\n  // Options\n  this._options = {\n    autoplay: true,\n    muted: true,\n    vastLoadTimeout: 23000,\n    loadVideoTimeout: 8000,\n    withCredentials: false,\n    wrapperLimit: 10,\n    resolveAll: true\n  };\n  // Error codes\n  this.ERROR_CODES = {\n    VAST_MALFORMED_RESPONSE:100,\n    ADS_REQUEST_NETWORK_ERROR: 1012,\n    FAILED_TO_REQUEST_ADS: 1005,\n    UNKNOWN_AD_RESPONSE: 1010,\n    VAST_ASSET_NOT_FOUND: 1007,\n    VAST_EMPTY_RESPONSE: 1009,\n    VAST_LINEAR_ASSET_MISMATCH: 403,\n    VAST_LOAD_TIMEOUT: 301,\n    VAST_MEDIA_LOAD_TIMEOUT: 402,\n    VIDEO_PLAY_ERROR: 400,\n    VPAID_ERROR: 901,\n  };\n  // Error messages\n  this.ERROR_MESSAGES = {\n    VAST_MALFORMED_RESPONSE: 'VAST response was malformed and could not be parsed.', // 100\n    ADS_REQUEST_ERROR: 'Unable to request ads from server. Cause: {0}.', // 1005\n    ADS_REQUEST_NETWORK_ERROR: 'Unable to request ads from server due to network error.', // 1012\n    FAILED_TO_REQUEST_ADS: 'The was a problem requesting ads from the server.', // 1005\n    NO_ADS_FOUND: 'The response does not contain any valid ads.', // 1009\n    UNKNOWN_AD_RESPONSE: 'The ad response was not understood and cannot be parsed.', // 1010\n    VAST_ASSET_NOT_FOUND: 'No assets were found in the VAST ad response.', // 1007\n    VAST_EMPTY_RESPONSE: 'The VAST response document is empty.', // 1009\n    VAST_LINEAR_ASSET_MISMATCH: 'Linear assets were found in the VAST ad response, but none of them matched the player\\'s capabilities.', // 403\n    VAST_LOAD_TIMEOUT: 'Ad request reached a timeout.', // 301\n    VAST_MEDIA_LOAD_TIMEOUT: 'VAST media file loading reached a timeout of {0} seconds.', // 402\n    VIDEO_PLAY_ERROR: 'There was an error playing the video ad.', // 400\n    VPAID_CREATIVE_ERROR: 'An unexpected error occurred within the VPAID creative. Refer to the inner error for more info.' // 901\n  };\n  // Errors\n  this.ERRORS = {\n    VAST_MALFORMED_RESPONSE: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_MALFORMED_RESPONSE, this.ERROR_CODES.VAST_MALFORMED_RESPONSE),\n    VAST_EMPTY_RESPONSE: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_EMPTY_RESPONSE, this.ERROR_CODES.VAST_EMPTY_RESPONSE),\n    VAST_ASSET_NOT_FOUND: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_ASSET_NOT_FOUND, this.ERROR_CODES.VAST_ASSET_NOT_FOUND),\n    VAST_LINEAR_ASSET_MISMATCH: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_LINEAR_ASSET_MISMATCH, this.ERROR_CODES.VAST_LINEAR_ASSET_MISMATCH),\n    VAST_LOAD_TIMEOUT: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_LOAD_TIMEOUT, this.ERROR_CODES.VAST_LOAD_TIMEOUT),\n    VAST_MEDIA_LOAD_TIMEOUT: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VAST_MEDIA_LOAD_TIMEOUT, this.ERROR_CODES.VAST_MEDIA_LOAD_TIMEOUT),\n    VIDEO_PLAY_ERROR: new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.ERROR_MESSAGES.VIDEO_PLAY_ERROR, this.ERROR_CODES.VIDEO_PLAY_ERROR)\n  };\n\n  this._vastClient = null;\n  this._vastParser = null;\n  this._vastTracker = null;\n\n  this._ad = null;\n  this._adPod = null;\n  this._creative = null;\n  this._mediaFiles = null;\n  this._mediaFileIndex = 0;\n  this._mediaFile = null;\n\n  this._isVPAID = false;\n  this._vpaidIframe = null;\n  this._vpaidCreative = null;\n\n  // Timers, Intervals\n  this._vastMediaLoadTimer = null;\n  this._vpaidProgressTimer = null;\n\n  // Handlers\n  this._handleLoadCreativeMessage = this.handleLoadCreativeMessage.bind(this);\n\n  this.SUPPORTED_CREATIVE_VPAID_VERSION_MIN = 2;\n\n  this._hasLoaded = false;\n  this._hasError = false;\n  this._hasImpression = false;\n  this._hasStarted = false;\n\n  this._isDestroyed = false;\n}\nAdsManager.prototype.createSlot = function() {\n  this._slot = document.createElement('div');\n  this._slot.style.position = 'absolute';\n  this._slot.style.display = 'none';\n  this._adContainer.appendChild(this._slot);\n  this.createVideoSlot();\n}\nAdsManager.prototype.removeSlot = function() {\n  this._slot.parentNode && this._slot.parentNode.removeChild(this._slot);\n  //this.createSlot();\n}\nAdsManager.prototype.showSlot = function() {\n  // Check if video slot has src, if no then hide video slot\n  if(this._videoSlot.src === '') {\n    this.hideVideoSlot();\n  }\n  // Show slot\n  this._slot.style.display = 'block';\n}\nAdsManager.prototype.resizeSlot = function(width, height) {\n  this._slot.style.width = width + 'px';\n  this._slot.style.height = height + 'px';\n}\nAdsManager.prototype.createVideoSlot = function() {\n  this._videoSlot = document.createElement('video');\n  this._videoSlot.setAttribute('webkit-playsinline', true);\n  this._videoSlot.setAttribute('playsinline', true);\n  //this._videoSlot.setAttribute('preload', 'none');\n  this._videoSlot.style.width = '100%';\n  this._videoSlot.style.height = '100%';\n  this._videoSlot.style.backgroundColor = 'rgb(0, 0, 0)';\n  //this._adContainer.appendChild(this._videoSlot);\n  this._slot.appendChild(this._videoSlot);\n}\nAdsManager.prototype.hideVideoSlot = function() {\n  this._videoSlot.style.display = 'none';\n}\nAdsManager.prototype.stopVASTMediaLoadTimeout = function() {\n  if(this._vastMediaLoadTimer) {\n    clearTimeout(this._vastMediaLoadTimer);\n    this._vastMediaLoadTimer = null;\n  }\n}\nAdsManager.prototype.startVASTMediaLoadTimeout = function() {\n  this.stopVASTMediaLoadTimeout();\n  this._vastMediaLoadTimer = setTimeout(() => {\n    this.onAdError(this.ERRORS.VAST_MEDIA_LOAD_TIMEOUT.formatMessage(Math.floor((this._options.loadVideoTimeout / 1000) % 60)));\n  }, this._options.loadVideoTimeout);\n}\nAdsManager.prototype.updateVPAIDProgress = function() {\n  // Check remaining time\n  this._attributes.remainingTime = this._isCreativeFunctionInvokable('getAdRemainingTime') ? this._vpaidCreative.getAdRemainingTime() : -1;\n  if(!isNaN(this._attributes.remainingTime) && this._attributes.remainingTime !== 1) {\n    this._attributes.currentTime = this._attributes.duration - this._attributes.remainingTime;\n    // Track progress\n    this._vastTracker.setProgress(this._attributes.currentTime);\n  }\n}\nAdsManager.prototype.startVPAIDProgress = function() {\n  this.stopVPAIDProgress();\n  this._vpaidProgressTimer = setInterval(() => {\n    if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\n      this.updateVPAIDProgress();\n    } else {\n      this.stopVPAIDProgress();\n    }\n  }, 1000);\n}\nAdsManager.prototype.stopVPAIDProgress = function() {\n  if(this._vpaidProgressTimer) {\n    clearInterval(this._vpaidProgressTimer);\n    this._vpaidProgressTimer = null;\n  }\n}\nAdsManager.prototype.addEventListener = function(eventName, callback, context) {\n  const givenCallback = callback.bind(context);\n  this._eventCallbacks[eventName] = givenCallback;\n}\nAdsManager.prototype.removeEventListener = function(eventName) {\n  this._eventCallbacks[eventName] = null;\n}\nAdsManager.prototype.removeEventListeners = function(eventCallbacks) {\n  for (const eventName in eventCallbacks) {\n    eventCallbacks.hasOwnProperty(eventName) && this.removeEventListener(eventName);\n  }\n}\nAdsManager.prototype.onAdsManagerLoaded = function() {\n  if (this.EVENTS.AdsManagerLoaded in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdsManagerLoaded] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdsManagerLoaded]();\n    }\n  }\n}\nAdsManager.prototype.onAdLoaded = function() {\n  this.stopVASTMediaLoadTimeout();\n  if (this.EVENTS.AdLoaded in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdLoaded] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdLoaded](this._creative);\n    }\n  }\n}\nAdsManager.prototype.onAdDurationChange = function() {\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\n    this._attributes.duration = this._isCreativeFunctionInvokable('getAdDuration') ? this._vpaidCreative.getAdDuration() : -1;\n    if(this._attributes.duration !== -1) {\n      this._vastTracker.setDuration(this._attributes.duration);\n    }\n  }\n  if (this.EVENTS.AdDurationChange in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdDurationChange] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdDurationChange]();\n    }\n  }\n}\nAdsManager.prototype.onAdSizeChange = function() {\n  if (this.EVENTS.AdSizeChange in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdSizeChange] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdSizeChange]();\n    }\n  }\n}\nAdsManager.prototype.onAdStarted = function() {\n  // Show ad slot\n  this.showSlot();\n\n  if (this.EVENTS.AdStarted in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdStarted] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdStarted]();\n    }\n  }\n}\nAdsManager.prototype.onAdVideoStart = function() {\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\n    this.updateVPAIDProgress();\n  }\n  if (this.EVENTS.AdVideoStart in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdVideoStart] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdVideoStart]();\n    }\n  }\n}\nAdsManager.prototype.onAdStopped = function() {\n  if (this.EVENTS.AdStopped in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdStopped] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdStopped]();\n    }\n  }\n  // abort the ad, unsubscribe and reset to a default state\n  this._abort();\n}\nAdsManager.prototype.onAdSkipped = function() {\n  if (this.EVENTS.AdSkipped in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdSkipped] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdSkipped]();\n    }\n  }\n  // abort the ad, unsubscribe and reset to a default state\n  this._abort();\n}\nAdsManager.prototype.onAdVolumeChange = function() {\n  if (this.EVENTS.AdVolumeChange in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdVolumeChange] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdVolumeChange]();\n    }\n  }\n}\nAdsManager.prototype.onAdImpression = function() {\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\n    if (!this._hasImpression) {\n      // Check duration\n      this._attributes.duration = this._isCreativeFunctionInvokable('getAdDuration') ? this._vpaidCreative.getAdDuration() : -1;\n      if(this._attributes.duration !== -1) {\n        this._vastTracker.setDuration(this._attributes.duration);\n      }\n      /*\n      // Check remaining time\n      this._attributes.remainingTime = this._isCreativeFunctionInvokable(\"getAdRemainingTime\") ? this._vpaidCreative.getAdRemainingTime() : -1;\n      console.log('update tracker with new remainingTime', this._attributes.remainingTime);\n      console.log('update tracker with new duration', this._attributes.duration);\n       */\n      // Track impression\n      this._vastTracker.trackImpression();\n\n      // Start VPAID process\n      this.startVPAIDProgress();\n\n      this._hasImpression = true;\n    }\n  }\n  if (this.EVENTS.AdImpression in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdImpression] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdImpression]();\n    }\n  }\n}\nAdsManager.prototype.onAdClickThru = function(url, id, playerHandles) {\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\n    this._vastTracker.click();\n  }\n  if (this.EVENTS.AdClickThru in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdClickThru] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdClickThru](url, id, playerHandles);\n    }\n  }\n}\nAdsManager.prototype.onAdVideoFirstQuartile = function() {\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\n    this.updateVPAIDProgress();\n  }\n  if (this.EVENTS.AdVideoFirstQuartile in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdVideoFirstQuartile] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdVideoFirstQuartile]();\n    }\n  }\n};\nAdsManager.prototype.onAdVideoMidpoint = function() {\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\n    this.updateVPAIDProgress();\n  }\n  if (this.EVENTS.AdVideoMidpoint in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdVideoMidpoint] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdVideoMidpoint]();\n    }\n  }\n};\nAdsManager.prototype.onAdVideoThirdQuartile = function() {\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\n    this.updateVPAIDProgress();\n  }\n  if (this.EVENTS.AdVideoThirdQuartile in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdVideoThirdQuartile] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdVideoThirdQuartile]();\n    }\n  }\n};\nAdsManager.prototype.onAdPaused = function() {\n  if(this._vastTracker) {\n    this._vastTracker.setPaused(true);\n  }\n  if (this.EVENTS.AdPaused in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdPaused] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdPaused]();\n    }\n  }\n};\nAdsManager.prototype.onAdPlaying = function() {\n  if(this._vastTracker) {\n    this._vastTracker.setPaused(false);\n  }\n  if (this.EVENTS.AdPlaying in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdPlaying] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdPlaying]();\n    }\n  }\n};\nAdsManager.prototype.onAdVideoComplete = function() {\n  if(this._isVPAID && this._vpaidCreative && this._vastTracker) {\n    this._vastTracker.complete();\n  }\n  if (this.EVENTS.AdVideoComplete in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdVideoComplete] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdVideoComplete]();\n    }\n  }\n}\nAdsManager.prototype.onAllAdsCompleted = function() {\n  if (this.EVENTS.AllAdsCompleted in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AllAdsCompleted] === 'function') {\n      this._eventCallbacks[this.EVENTS.AllAdsCompleted]();\n    }\n  }\n}\nAdsManager.prototype.onAdError = function(message) {\n\n  this._hasError = true;\n  /*\n  // Stop and clear timeouts, intervals\n  this.stopVASTMediaLoadTimeout();\n  this.stopVPAIDProgress();\n   */\n  this.abort();\n\n  if (this.EVENTS.AdError in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdError] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdError](typeof message !== 'object' ? new _ad_error__WEBPACK_IMPORTED_MODULE_1__[\"default\"](message) : message);\n    }\n  }\n\n}\nAdsManager.prototype.onAdLog = function(message) {\n  if (this.EVENTS.AdLog in this._eventCallbacks) {\n    if(typeof this._eventCallbacks[this.EVENTS.AdLog] === 'function') {\n      this._eventCallbacks[this.EVENTS.AdLog](message);\n    }\n  }\n}\nAdsManager.prototype.processVASTResponse = function(res) {\n\n  const ads = res.ads;\n  if(ads.length != 0) {\n\n    if(ads.length > 1) {\n      // Ad pod\n      // Filter by sequence\n      this._adPod = ads.sort(function(a, b) {\n        let aSequence = a.sequence;\n        let bSequence = b.sequence;\n        if (aSequence === bSequence) {\n          return 0;\n        } else if (aSequence === null) {\n          return 1;\n        } else if (bSequence === null) {\n          return -1;\n        }\n        return (aSequence < bSequence) ? -1 : (aSequence > bSequence) ? 1 : 0;\n      });\n\n      this._ad = ads[0];\n    } else {\n      // Ad\n      this._ad = ads[0];\n    }\n\n    if(this._ad) {\n\n      // Filter linear creatives, get first\n      this._creative = ads[0].creatives.filter(creative => creative.type === 'linear')[0];\n      // Check if creative has media files\n      if(this._creative) {\n\n        if(this._creative.mediaFiles.length != 0) {\n          // Filter and check media files for mime type canPlay and if VPAID or not\n          this._mediaFiles = this._creative.mediaFiles.filter(mediaFile => {\n            // mime types -> mp4, webm, ogg, 3gp\n            if(this.canPlayVideoType(mediaFile.mimeType)) {\n              return mediaFile;\n            } else if(mediaFile.mimeType === 'application/javascript') {\n              // apiFramework -> mime type -> application/javascript\n              return mediaFile;\n            }\n          });//[0]; // take the first one\n\n          // Sort media files by size\n          this._mediaFiles.sort(function(a, b) {\n            let aHeight = a.height;\n            let bHeight = b.height;\n            return (aHeight < bHeight) ? -1 : (aHeight > bHeight) ? 1 : 0;\n          });\n\n          if(this._mediaFiles && this._mediaFiles.length != 0) {\n            // TODO: move after adLoaded\n            // Init VAST Tracker for tracking events\n            this._vastTracker = new _dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0__.VASTTracker(null, this._ad, this._creative);\n            this._vastTracker.load();\n\n            // If not VPAID dispatch AdsManagerLoaded event -> ad is ready for init\n            this.onAdsManagerLoaded();\n          } else {\n            // Linear assets were found in the VASt ad response, but none of them match the video player's capabilities.\n            this.onAdError(this.ERRORS.VAST_LINEAR_ASSET_MISMATCH);\n          }\n\n        } else {\n          // No assets were found in the VAST ad response.\n          this.onAdError(this.ERRORS.VAST_ASSET_NOT_FOUND);\n        }\n      } else {\n        // TODO:\n        // Non Linear\n        console.log('non linear');\n      }\n\n    }\n\n  } else {\n    // The VAST response document is empty.\n    this.onAdError(this.ERRORS.VAST_EMPTY_RESPONSE);\n  }\n}\nAdsManager.prototype.requestAds = function(vastUrl, options = {}) {\n\n  if(this._isDestroyed) {\n    return;\n  }\n\n  // Assign options\n  Object.assign(this._options, options);\n\n  // VAST options\n  // timeout: Number - A custom timeout for the requests (default 120000 ms)\n  // withCredentials: Boolean - A boolean to enable the withCredentials options for the XHR URLHandler (default false)\n  // wrapperLimit: Number - A number of Wrapper responses that can be received with no InLine response (default 10)\n  // resolveAll: Boolean - Allows you to parse all the ads contained in the VAST or to parse them ad by ad or adPod by adPod (default true)\n  // allowMultipleAds: Boolean - A Boolean value that identifies whether multiple ads are allowed in the requested VAST response. This will override any value of allowMultipleAds attribute set in the VAST\n  // followAdditionalWrappers: Boolean - a Boolean value that identifies whether subsequent Wrappers after a requested VAST response is allowed. This will override any value of followAdditionalWrappers attribute set in the VAST\n  const vastOptions = {\n    timeout: this._options.vastLoadTimeout,\n    withCredentials: this._options.withCredentials,\n    wrapperLimit: this._options.wrapperLimit,\n    resolveAll: this._options.resolveAll\n  };\n\n  // Abort\n  this.abort();\n\n  // Check if vastUrl exists\n  if(vastUrl && typeof vastUrl === 'string') {\n\n    let isURL = false;\n    try {\n      new URL(vastUrl);\n      isURL = true;\n    } catch (e) {\n    }\n\n    if (isURL) {\n      // use VAST URL\n      this._vastClient = new _dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0__.VASTClient();\n      this._vastClient\n        .get(vastUrl, vastOptions)\n        .then(res => {\n          this.processVASTResponse(res);\n        })\n        .catch(err => {\n          this.onAdError(err.message);\n        });\n    } else {\n      // use VAST XML\n      const vastXml = (new window.DOMParser()).parseFromString(vastUrl, 'text/xml');\n      this._vastParser = new _dailymotion_vast_client__WEBPACK_IMPORTED_MODULE_0__.VASTParser();\n      this._vastParser\n        .parseVAST(vastXml, vastOptions)\n        .then(res => {\n          this.processVASTResponse(res);\n        })\n        .catch(err => {\n          this.onAdError(err.message);\n        });\n    }\n  } else {\n    this.onAdError('VAST URL/XML is empty');\n  }\n}\nAdsManager.prototype.canPlayVideoType = function(mimeType) {\n  if(mimeType === 'video/3gpp' && this.supportsThreeGPVideo()) {\n    return true;\n  } else if(mimeType === 'video/webm' && this.supportsWebmVideo()) {\n    return true;\n  } else if(mimeType === 'video/ogg' && this.supportsOggTheoraVideo()) {\n    return true;\n  } else if(mimeType === 'video/mp4' && this.supportsH264BaselineVideo()) {\n    return true;\n  }\n  return false;\n}\nAdsManager.prototype.supportsVideo = function() {\n  return !!document.createElement('video').canPlayType;\n}\nAdsManager.prototype.supportsH264BaselineVideo = function() {\n  if(!this.supportsVideo()) return false;\n  return document.createElement('video').canPlayType('video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"');\n}\nAdsManager.prototype.supportsOggTheoraVideo = function() {\n  if(!this.supportsVideo()) return false;\n  return document.createElement('video').canPlayType('video/ogg; codecs=\"theora, vorbis\"');\n}\nAdsManager.prototype.supportsWebmVideo = function() {\n  if(!this.supportsVideo()) return false;\n  return document.createElement('video').canPlayType('video/webm; codecs=\"vp8, vorbis\"');\n}\nAdsManager.prototype.supportsThreeGPVideo = function() {\n  if(!this.supportsVideo()) return false;\n  return document.createElement('video').canPlayType('video/3gpp; codecs=\"mp4v.20.8, samr\"');\n}\nAdsManager.prototype.handshakeVersion = function(version) {\n  return this._vpaidCreative.handshakeVersion(version);\n}\nAdsManager.prototype._isCreativeFunctionInvokable = function(a) {\n  return this._vpaidCreative ? (a = this._vpaidCreative[a]) && typeof a === 'function' : false;\n}\nAdsManager.prototype.checkVPAIDInterface = function(a) {\n  const b = { passed: true, missingInterfaces: ''};\n  for (let d = a.length - 1; 0 <= d; d--)\n    this._isCreativeFunctionInvokable(a[d]) || (b.passed = false, b.missingInterfaces += a[d] + ' ');\n  return b;\n}\nAdsManager.prototype.setCallbacksForCreative = function(eventCallbacks, context) {\n  for (const event in eventCallbacks) eventCallbacks.hasOwnProperty(event) && this._vpaidCreative.subscribe(eventCallbacks[event], event, context)\n}\nAdsManager.prototype.removeCallbacksForCreative = function(eventCallbacks) {\n  if(this._vpaidCreative !== null) {\n    for (const event in eventCallbacks) {\n      eventCallbacks.hasOwnProperty(event) && this._vpaidCreative.unsubscribe(event); // && this._vpaidCreative.unsubscribe(eventCallbacks[event], event);\n    }\n  }\n}\nAdsManager.prototype.creativeAssetLoaded = function() {\n  const checkVPAIDMinVersion = () => {\n    const c = this.handshakeVersion(this.SUPPORTED_CREATIVE_VPAID_VERSION_MIN.toFixed(1));\n    return c ? parseFloat(c) < this.SUPPORTED_CREATIVE_VPAID_VERSION_MIN ? (this.onAdError('Only support creatives with VPAID version >= ' + this.SUPPORTED_CREATIVE_VPAID_VERSION_MIN.toFixed(1)), !1) : !0 : (this.onAdError('Cannot get VPAID version from the creative'), !1)\n  };\n  if (function(that) {\n    const c = that.checkVPAIDInterface('handshakeVersion initAd startAd stopAd subscribe unsubscribe getAdLinear'.split(' '));\n    c.passed || that.onAdError('Missing interfaces in the VPAID creative: ' + c.missingInterfaces);\n    return c.passed\n  }(this) && checkVPAIDMinVersion()) {\n\n    // VPAID events\n    this._creativeEventCallbacks = {\n      AdStarted: this.onAdStarted,\n      AdStopped: this.onAdStopped,\n      AdSkipped: this.onAdSkipped,\n      AdLoaded: this.onAdLoaded,\n      //AdLinearChange: this.onAdLinearChange,\n      AdSizeChange: this.onAdSizeChange,\n      //AdExpandedChange: this.onAdExpandedChange,\n      AdDurationChange: this.onAdDurationChange,\n      AdVolumeChange: this.onAdVolumeChange,\n      AdImpression: this.onAdImpression,\n      AdClickThru: this.onAdClickThru,\n      //AdInteraction: this.onAdInteraction,\n      AdVideoStart: this.onAdVideoStart,\n      AdVideoFirstQuartile: this.onAdVideoFirstQuartile,\n      AdVideoMidpoint: this.onAdVideoMidpoint,\n      AdVideoThirdQuartile: this.onAdVideoThirdQuartile,\n      AdVideoComplete: this.onAdVideoComplete,\n      //AdUserAcceptInvitation: this.onAdUserAcceptInvitation,\n      //AdUserMinimize: this.onAdUserMinimize,\n      //AdUserClose: this.onAdUserClose,\n      AdPaused: this.onAdPaused,\n      AdPlaying: this.onAdPlaying, // onAdResumed\n      AdError: this.onAdError,\n      AdLog: this.onAdLog\n    }\n\n    // Subscribe for VPAID events\n    this.setCallbacksForCreative(this._creativeEventCallbacks, this);\n\n    // Prepare for iniAd\n    const width = this._attributes.width;\n    const height = this._attributes.height;\n    const creativeData = {\n      AdParameters: this._creative.adParameters\n    };\n    const environmentVars = {\n      slot: this._slot,\n      videoSlot: this._videoSlot,\n      videoSlotCanAutoPlay: true\n    };\n    // iniAd(width, height, viewMode, desiredBitrate, creativeData, environmentVars)\n    // Start loadVideoTimeout\n    this.startVASTMediaLoadTimeout();\n    this._vpaidCreative.initAd(width, height, this._attributes.viewMode, this._attributes.desiredBitrate, creativeData, environmentVars);\n\n  }\n}\nAdsManager.prototype.handleLoadCreativeMessage = function(msg) {\n  if (msg && msg.data) {\n    const match = String(msg.data).match(new RegExp('adm://(.*)'));\n    if (match) {\n      const value = JSON.parse(match[1]);\n      if(value == 'load') {\n        console.log('vpaid loaded -> msg');\n        try {\n          let VPAIDAd = this._vpaidIframe.contentWindow.getVPAIDAd;\n          if (VPAIDAd && typeof VPAIDAd === 'function') {\n            VPAIDAd = VPAIDAd();\n            console.log('vpaid', typeof VPAIDAd);\n            typeof VPAIDAd === 'undefined'\n              ? this.onAdError('getVPAIDAd() returns undefined value')\n              : VPAIDAd == null\n                ? this.onAdError('getVPAIDAd() returns null')\n                : ((this._vpaidCreative = VPAIDAd),\n                  this.creativeAssetLoaded());\n          } else {\n            this.onAdError('getVPAIDAd() is undefined');\n          }\n        } catch (e) {\n          this.onAdError(e);\n        }\n      } else if (value == 'error') {\n        this.onAdError('Error load VPAID');\n      }\n    }\n  }\n}\nAdsManager.prototype.loadCreativeAsset = function(fileURL) {\n\n  // TODO:\n  window.addEventListener('message', this._handleLoadCreativeMessage);\n\n  // Create iframe\n  this._vpaidIframe = document.createElement('iframe');\n  this._vpaidIframe.style.display = 'none';\n  this._vpaidIframe.style.width = '0px';\n  this._vpaidIframe.style.height = '0px';\n\n  // Append iframe\n  this._adContainer.appendChild(this._vpaidIframe);\n\n  // Open iframe, write and close\n  this._vpaidIframe.contentWindow.document.open();\n  this._vpaidIframe.contentWindow.document.write(`\n    <script>function sendMessage(msg) {\n    var post = 'adm://' + JSON.stringify(msg);\n    window.parent.postMessage(post, '*'); }\n     \\x3c/script>\n    <script type=\"text/javascript\" onload=\"sendMessage('load')\" onerror=\"sendMessage('error')\" src=\"${fileURL}\"> \\x3c/script>\n  `);\n  this._vpaidIframe.contentWindow.document.close();\n}\nAdsManager.prototype.removeCreativeAsset = function() {\n  // Remove VPAID iframe\n  if(this._vpaidIframe) {\n    this._vpaidIframe.parentNode.removeChild(this._vpaidIframe);\n  }\n}\nAdsManager.prototype._abort = function() {\n  // Abort\n  this.abort();\n\n  // Dispatch AllAdsCompleted\n  this.onAllAdsCompleted();\n}\nAdsManager.prototype.isCreativeExists = function() {\n  return this._creative && this._creative.mediaFiles.length != 0;\n}\nAdsManager.prototype.init = function(width, height, viewMode) {\n\n  if(this._isDestroyed) {\n    return;\n  }\n\n  if(this.isCreativeExists()) {\n\n    // Find the best resolution for mediaFile\n    this._mediaFileIndex = this._mediaFiles.findIndex(function(item) {\n      return item.height >= height\n    });\n\n    if(this._mediaFileIndex != -1) {\n      this._mediaFile = this._mediaFiles[this._mediaFileIndex];\n    } else {\n      // Get the last from array\n      this._mediaFile = this._mediaFiles[this._mediaFiles.length - 1];\n    }\n\n    if(this._mediaFile) {\n      // Check if VPAID\n      if (this._mediaFile.mimeType === 'application/javascript') {\n        this._isVPAID = true;\n      }\n\n      this._attributes.width = width;\n      this._attributes.height = height;\n      this._attributes.viewMode = viewMode;\n\n      // Resize slot\n      this.resizeSlot(this._attributes.width, this._attributes.height);\n\n      this._videoSlot.addEventListener('error', () => {\n        this.onAdError(this.ERRORS.VIDEO_PLAY_ERROR);\n      }, false);\n\n      if(this._isVPAID) {\n        // VPAID\n        this.loadCreativeAsset(this._mediaFile.fileURL);\n      } else {\n\n        // VAST\n        // Events\n        this._slot.addEventListener('click', () => {\n          if(!this._isVPAID && this._vastTracker) {\n            this._vastTracker.click();\n          }\n        });\n\n        this._videoSlot.addEventListener('canplay', () => {\n\n        });\n\n        this._videoSlot.addEventListener('play', () => {\n\n        });\n\n        this._videoSlot.addEventListener('volumechange', (event) => {\n          this._vastTracker && this._vastTracker.setMuted(event.target.muted);\n        });\n\n        this._videoSlot.addEventListener('timeupdate', (event) => {\n          if(this.isCreativeExists()) {\n\n            if (this._nextQuartileIndex >= this._quartileEvents.length) {\n              return;\n            }\n\n            const percentPlayed = event.target.currentTime * 100.0 / event.target.duration;\n            if (percentPlayed >= this._quartileEvents[this._nextQuartileIndex].value) {\n              const lastQuartileEvent = this._quartileEvents[this._nextQuartileIndex].event;\n              this._defaultEventCallbacks[lastQuartileEvent]();\n              this._nextQuartileIndex += 1;\n            }\n\n            if (percentPlayed >= 0) {\n              if (!this._hasImpression) {\n                this._vastTracker && this._vastTracker.trackImpression();\n                this._hasImpression = true;\n              }\n            }\n            this._vastTracker && this._vastTracker.setProgress(event.target.currentTime);\n            if (event.target.duration > 0) {\n              this._attributes.remainingTime = event.target.duration - event.target.currentTime;\n            }\n          }\n        }, true);\n\n        this._videoSlot.addEventListener('loadedmetadata', (event) => {\n          this._attributes.duration = event.target.duration;\n          // Update tracking duration with real media meta data\n          this._vastTracker && this._vastTracker.setDuration(event.target.duration);\n          //if(!this._isVPAID) {\n            this.onAdDurationChange();\n          //}\n        });\n\n        this._videoSlot.addEventListener('ended', () => {\n          // Complete\n          this._vastTracker && this._vastTracker.complete();\n\n          //setTimeout(() => {\n            this.onAdStopped();\n          //}, 75);\n\n        });\n\n        this._videoSlot.setAttribute('src', this._mediaFile.fileURL);\n\n        // Ad Loaded\n        this.onAdLoaded();\n      }\n\n      // Tracking\n      if(this._vastTracker) {\n\n        this._vastTracker.on('clickthrough', (url) => {\n          if (!this._isVPAID) {\n            this.onAdClickThru(url);\n          }\n\n          // Open the resolved clickThrough url\n          const opener = window.open(url, '_blank');\n          void 0 !== opener ? opener.focus() : window.location.href = url;\n        });\n\n      }\n\n    } else {\n      // console.log('media file not found');\n    }\n\n  } /* else {\n    this.onAdError('');\n  }*/\n}\nAdsManager.prototype.start = function() {\n  if(this.isCreativeExists()) {\n\n    if(this._options.muted) {\n      this._videoSlot.muted = true;\n      this._videoSlot.volume = 0;\n    }\n\n    if (this._isVPAID) {\n      this._isCreativeFunctionInvokable('startAd') && this._vpaidCreative.startAd();\n    } else {\n\n      //this._videoSlot.autoplay = true;\n      this._videoSlot.load();\n      this._videoSlot.play();\n\n      this.onAdStarted();\n\n    }\n  }\n}\nAdsManager.prototype.getDuration = function() {\n  return this.isCreativeExists() && this._attributes.duration;\n}\nAdsManager.prototype.pause = function() {\n  if(this.isCreativeExists()) {\n    if (this._isVPAID) {\n      this._isCreativeFunctionInvokable('pauseAd') && this._vpaidCreative.pauseAd();\n    } else {\n      this._videoSlot.pause();\n      this.onAdPaused();\n    }\n  }\n}\nAdsManager.prototype.resume = function() {\n  if(this.isCreativeExists()) {\n    if (this._isVPAID) {\n      this._isCreativeFunctionInvokable('resumeAd') && this._vpaidCreative.resumeAd();\n    } else {\n      this._videoSlot.play();\n      this.onAdPlaying();\n    }\n  }\n}\nAdsManager.prototype.stop = function() {\n  if(this.isCreativeExists()) {\n    if (this._isVPAID) {\n      this._isCreativeFunctionInvokable('stopAd') && this._vpaidCreative.stopAd();\n    } else {\n      this.onAdStopped();\n    }\n  }\n}\nAdsManager.prototype.skip = function() {\n  if(this.isCreativeExists()) {\n    if (this._isVPAID) {\n      this._isCreativeFunctionInvokable('skipAd') && this._vpaidCreative.skipAd();\n    } else {\n      this.onAdSkipped();\n    }\n  }\n}\nAdsManager.prototype.resize = function(width, height, viewMode) {\n  if(this.isCreativeExists()) {\n\n    this._attributes.width = width;\n    this._attributes.height = height;\n    this._attributes.viewMode = viewMode;\n\n    // Resize slot\n    this.resizeSlot(this._attributes.width, this._attributes.height);\n\n    if (this._isVPAID) {\n      this._isCreativeFunctionInvokable('resizeAd') && this._vpaidCreative.resizeAd(width, height, viewMode);\n    } else {\n      this.onAdSizeChange();\n    }\n  }\n}\nAdsManager.prototype.getVolume = function() {\n  if(this.isCreativeExists()) {\n    if (this._isVPAID) {\n      return this._isCreativeFunctionInvokable('getAdVolume') ? this._vpaidCreative.getAdVolume() : -1;\n    }\n    return this._videoSlot.volume;\n  }\n}\nAdsManager.prototype.setVolume = function(value) {\n  if(this.isCreativeExists()) {\n    if (this._isVPAID) {\n      this._isCreativeFunctionInvokable('setAdVolume') && this._vpaidCreative.setAdVolume(value);\n    } else {\n      const isVolumeChanged = value !== this._videoSlot.volume;\n      if(isVolumeChanged) {\n        this._attributes.volume = value;\n        this._videoSlot.volume = value;\n        this.onAdVolumeChange();\n      }\n    }\n  }\n}\nAdsManager.prototype.getRemainingTime = function() {\n  if(this.isCreativeExists()) {\n    if (this._isVPAID) {\n      return this._isCreativeFunctionInvokable('getAdRemainingTime') ? this._vpaidCreative.getAdRemainingTime() : -1\n    }\n    return this._attributes.remainingTime;\n  }\n}\nAdsManager.prototype.collapse = function() {\n  if(this.isCreativeExists()) {\n    if(this._isVPAID) {\n      this._isCreativeFunctionInvokable('collapseAd') && this._vpaidCreative.collapseAd();\n    }\n  }\n}\nAdsManager.prototype.expand = function() {\n  if(this.isCreativeExists()) {\n    if(this._isVPAID) {\n      this._isCreativeFunctionInvokable('expandAd') && this._vpaidCreative.expandAd();\n    }\n  }\n}\nAdsManager.prototype.abort = function(reCreateSlot = true) {\n\n  if(this._isDestroyed) {\n    return;\n  }\n\n  // Removes ad assets loaded at runtime that need to be properly removed at the time of ad completion\n  // and stops the ad and all tracking.\n  // TODO:\n  window.removeEventListener('message', this._handleLoadCreativeMessage);\n\n  // Stop and clear timeouts, intervals\n  this.stopVASTMediaLoadTimeout();\n  this.stopVPAIDProgress();\n\n  if(this._isVPAID) {\n    // Unsubscribe for VPAID events\n    this.removeCallbacksForCreative(this._creativeEventCallbacks);\n    this.removeCreativeAsset();\n  }\n\n  // Reset global variables to default values\n  this._nextQuartileIndex = 0;\n\n  this._isVPAID = false;\n\n  this._hasLoaded = false;\n  this._hasError = false;\n  this._hasImpression = false;\n  this._hasStarted = false;\n\n  this._ad = null;\n  this._creative = null;\n  this._mediaFile = null;\n  this._vpaidCreative = null;\n  this._vastTracker = null;\n\n  // Remove slot\n  this.removeSlot();\n\n  if(reCreateSlot) {\n    // Re-create slot\n    this.createSlot();\n  }\n\n}\nAdsManager.prototype.destroy = function() {\n\n  if(this._isDestroyed) {\n    return;\n  }\n\n  // Cleans up the internal state, abort anything that is currently doing on with the AdsManager\n  // and reset to a default state.\n\n  // Reset the internal state of AdsManager\n  this.abort(false);\n  // Remove event listeners\n  this.removeEventListeners(this._eventCallbacks);\n  // Remove slot element from the DOM\n  this.removeSlot();\n\n  this._adContainer = null;\n  this._slot = null;\n  this._videoSlot = null;\n\n  this._isDestroyed = true;\n\n}\nAdsManager.prototype.isDestroyed = function() {\n  return this._isDestroyed;\n}\nAdsManager.prototype.getVersion = function() {\n  return this._attributes.version;\n}\n\n\n\n\n//# sourceURL=webpack://adserve/./src/ads-manager.js?");

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"tv\": () => (/* binding */ tv)\n/* harmony export */ });\n/* harmony import */ var _ads_manager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ads-manager.js */ \"./src/ads-manager.js\");\n\n\nconst tv = {\n  AdsManager : _ads_manager_js__WEBPACK_IMPORTED_MODULE_0__.AdsManager\n}\n\n\n\n\n\n//# sourceURL=webpack://adserve/./src/index.js?");

/***/ }),

/***/ "./src/utils.js":
/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"format\": () => (/* binding */ format)\n/* harmony export */ });\nfunction format(message, ...values) {\n  try {\n    values.forEach((value, key) => {\n      message = message.replace(\n        new RegExp('\\\\{' + key + '}', 'g'),\n        value\n      )\n    });\n  } catch (e) {}\n  return message\n}\n\n\n\n\n//# sourceURL=webpack://adserve/./src/utils.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.js");
/******/ 	adserve = __webpack_exports__;
/******/ 	
/******/ })()
;